{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.141374359848679, "policy_loss": -0.006420641498620152, "vf_loss": 6.1459421270637105, "vf_explained_var": 7.349060427758002e-05, "kl": 0.009264497305326018, "entropy": 4.273060981688961, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -1.0789495265511162, "episode_reward_min": -178.81122051549065, "episode_reward_mean": -89.94508502102089, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162], "episode_lengths": [23, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6856396794319153, "mean_inference_ms": 1.7589330673217773, "mean_action_processing_ms": 0.302731990814209, "mean_env_wait_ms": 2.3096948862075806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06734132766723633, "StateBufferConnector_ms": 0.03943443298339844, "ViewRequirementAgentConnector_ms": 0.26519298553466797}}, "episode_reward_max": -1.0789495265511162, "episode_reward_min": -178.81122051549065, "episode_reward_mean": -89.94508502102089, "episode_len_mean": 16.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162], "episode_lengths": [23, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6856396794319153, "mean_inference_ms": 1.7589330673217773, "mean_action_processing_ms": 0.302731990814209, "mean_env_wait_ms": 2.3096948862075806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06734132766723633, "StateBufferConnector_ms": 0.03943443298339844, "ViewRequirementAgentConnector_ms": 0.26519298553466797}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.10011794836, "num_env_steps_trained_throughput_per_sec": 337.10011794836, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11865.855, "sample_time_ms": 757.395, "load_time_ms": 1.487, "load_throughput": 2689087.354, "learn_time_ms": 10989.675, "learn_throughput": 363.978, "synch_weights_time_ms": 115.986}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "default", "date": "2024-08-30_11-32-30", "timestamp": 1724988750, "time_this_iter_s": 12.450997829437256, "time_total_s": 12.450997829437256, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 12.450997829437256, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.552941176470586, "ram_util_percent": 15.123529411764707, "gpu_util_percent0": 0.1888235294117647, "vram_util_percent0": 0.175381529564951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6601643659735235, "policy_loss": -0.007825475314291574, "vf_loss": 5.666270377302682, "vf_explained_var": 2.3059178424137895e-05, "kl": 0.008597433332088454, "entropy": 4.303105577858545, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -1.0789495265511162, "episode_reward_min": -194.14205925509734, "episode_reward_mean": -170.2772589184932, "episode_len_mean": 43.666666666666664, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7072540305594287, "mean_inference_ms": 1.923582279250347, "mean_action_processing_ms": 0.3103834829730235, "mean_env_wait_ms": 2.8211848876269596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061555703481038414, "StateBufferConnector_ms": 0.016325712203979492, "ViewRequirementAgentConnector_ms": 0.2526680628458659}}, "episode_reward_max": -1.0789495265511162, "episode_reward_min": -194.14205925509734, "episode_reward_mean": -170.2772589184932, "episode_len_mean": 43.666666666666664, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7072540305594287, "mean_inference_ms": 1.923582279250347, "mean_action_processing_ms": 0.3103834829730235, "mean_env_wait_ms": 2.8211848876269596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061555703481038414, "StateBufferConnector_ms": 0.016325712203979492, "ViewRequirementAgentConnector_ms": 0.2526680628458659}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.9449327494273, "num_env_steps_trained_throughput_per_sec": 351.9449327494273, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11615.591, "sample_time_ms": 568.314, "load_time_ms": 4.405, "load_throughput": 908054.557, "learn_time_ms": 10932.349, "learn_throughput": 365.887, "synch_weights_time_ms": 109.401}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 12, "training_iteration": 2, "trial_id": "default", "date": "2024-08-30_11-32-42", "timestamp": 1724988762, "time_this_iter_s": 11.965833187103271, "time_total_s": 24.416831016540527, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 24.416831016540527, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.973333333333334, "ram_util_percent": 15.180000000000001, "gpu_util_percent0": 0.192, "vram_util_percent0": 0.18230523003472224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.358535242849781, "policy_loss": -0.009021247727095439, "vf_loss": 5.3659564554050405, "vf_explained_var": -2.056296153735089e-06, "kl": 0.0080002162206207, "entropy": 4.29775515987027, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -1.0789495265511162, "episode_reward_min": -201.18284809232003, "episode_reward_mean": -176.96275939187953, "episode_len_mean": 61.71875, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979147046264994, "mean_inference_ms": 1.9725027584739285, "mean_action_processing_ms": 0.3202338394558713, "mean_env_wait_ms": 2.964314931111769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05764663219451904, "StateBufferConnector_ms": 0.013534724712371826, "ViewRequirementAgentConnector_ms": 0.25419071316719055}}, "episode_reward_max": -1.0789495265511162, "episode_reward_min": -201.18284809232003, "episode_reward_mean": -176.96275939187953, "episode_len_mean": 61.71875, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979147046264994, "mean_inference_ms": 1.9725027584739285, "mean_action_processing_ms": 0.3202338394558713, "mean_env_wait_ms": 2.964314931111769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05764663219451904, "StateBufferConnector_ms": 0.013534724712371826, "ViewRequirementAgentConnector_ms": 0.25419071316719055}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.98415683255234, "num_env_steps_trained_throughput_per_sec": 361.98415683255234, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11427.105, "sample_time_ms": 545.792, "load_time_ms": 5.573, "load_throughput": 717772.568, "learn_time_ms": 10749.14, "learn_throughput": 372.123, "synch_weights_time_ms": 125.547}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 32, "training_iteration": 3, "trial_id": "default", "date": "2024-08-30_11-32-53", "timestamp": 1724988773, "time_this_iter_s": 11.59597659111023, "time_total_s": 36.01280760765076, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 36.01280760765076, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.4, "ram_util_percent": 15.240000000000002, "gpu_util_percent0": 0.16, "vram_util_percent0": 0.19052734375000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.171291404898449, "policy_loss": -0.009005177477675099, "vf_loss": 5.178052528186511, "vf_explained_var": -8.155581771686513e-07, "kl": 0.011220287084041203, "entropy": 4.288555801555675, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -207.5977760100675, "episode_reward_mean": -176.01126189685488, "episode_len_mean": 65.775, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979008078143587, "mean_inference_ms": 1.9778409404522386, "mean_action_processing_ms": 0.3198407313852537, "mean_env_wait_ms": 3.0027098127025256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05877375602722168, "StateBufferConnector_ms": 0.01405477523803711, "ViewRequirementAgentConnector_ms": 0.24877429008483887}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -207.5977760100675, "episode_reward_mean": -176.01126189685488, "episode_len_mean": 65.775, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979008078143587, "mean_inference_ms": 1.9778409404522386, "mean_action_processing_ms": 0.3198407313852537, "mean_env_wait_ms": 3.0027098127025256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05877375602722168, "StateBufferConnector_ms": 0.01405477523803711, "ViewRequirementAgentConnector_ms": 0.24877429008483887}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.1400681958912, "num_env_steps_trained_throughput_per_sec": 372.1400681958912, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11257.474, "sample_time_ms": 501.162, "load_time_ms": 6.41, "load_throughput": 624024.697, "learn_time_ms": 10633.375, "learn_throughput": 376.174, "synch_weights_time_ms": 115.478}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "default", "date": "2024-08-30_11-33-05", "timestamp": 1724988785, "time_this_iter_s": 11.368351936340332, "time_total_s": 47.38115954399109, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 47.38115954399109, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.193333333333333, "ram_util_percent": 15.266666666666671, "gpu_util_percent0": 0.13133333333333336, "vram_util_percent0": 0.19090711805555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.036363889068686, "policy_loss": -0.010776631886600167, "vf_loss": 5.044620801812859, "vf_explained_var": -2.9756817766415175e-06, "kl": 0.012598525267156963, "entropy": 4.296635046825614, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -211.25690285157862, "episode_reward_mean": -176.12494155909374, "episode_len_mean": 75.35416666666667, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7032230859569766, "mean_inference_ms": 2.0006025808995607, "mean_action_processing_ms": 0.3243443764868232, "mean_env_wait_ms": 3.0645955441878794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0584860642751058, "StateBufferConnector_ms": 0.013588865598042807, "ViewRequirementAgentConnector_ms": 0.2481465538342794}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -211.25690285157862, "episode_reward_mean": -176.12494155909374, "episode_len_mean": 75.35416666666667, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7032230859569766, "mean_inference_ms": 2.0006025808995607, "mean_action_processing_ms": 0.3243443764868232, "mean_env_wait_ms": 3.0645955441878794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0584860642751058, "StateBufferConnector_ms": 0.013588865598042807, "ViewRequirementAgentConnector_ms": 0.2481465538342794}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.1893840934259, "num_env_steps_trained_throughput_per_sec": 367.1893840934259, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11184.675, "sample_time_ms": 481.282, "load_time_ms": 6.797, "load_throughput": 588459.51, "learn_time_ms": 10581.506, "learn_throughput": 378.018, "synch_weights_time_ms": 114.045}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 48, "training_iteration": 5, "trial_id": "default", "date": "2024-08-30_11-33-16", "timestamp": 1724988796, "time_this_iter_s": 11.467756271362305, "time_total_s": 58.848915815353394, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 58.848915815353394, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.753333333333334, "ram_util_percent": 15.34666666666667, "gpu_util_percent0": 0.20800000000000002, "vram_util_percent0": 0.19168294270833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0439042827134495, "policy_loss": -0.01428605836405549, "vf_loss": 5.055396561212437, "vf_explained_var": -8.659657611641832e-06, "kl": 0.013968886048482952, "entropy": 4.377911474371469, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -242.312393805297, "episode_reward_mean": -178.99646704543127, "episode_len_mean": 80.94444444444444, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7002918658783776, "mean_inference_ms": 2.0033226723167377, "mean_action_processing_ms": 0.32444097335211913, "mean_env_wait_ms": 3.07336271357247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05807744132147895, "StateBufferConnector_ms": 0.01331170399983724, "ViewRequirementAgentConnector_ms": 0.24616629989058883}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -242.312393805297, "episode_reward_mean": -178.99646704543127, "episode_len_mean": 80.94444444444444, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7002918658783776, "mean_inference_ms": 2.0033226723167377, "mean_action_processing_ms": 0.32444097335211913, "mean_env_wait_ms": 3.07336271357247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05807744132147895, "StateBufferConnector_ms": 0.01331170399983724, "ViewRequirementAgentConnector_ms": 0.24616629989058883}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.12084542838977, "num_env_steps_trained_throughput_per_sec": 352.12084542838977, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11213.842, "sample_time_ms": 463.107, "load_time_ms": 7.212, "load_throughput": 554655.382, "learn_time_ms": 10628.408, "learn_throughput": 376.35, "synch_weights_time_ms": 114.075}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 54, "training_iteration": 6, "trial_id": "default", "date": "2024-08-30_11-33-28", "timestamp": 1724988808, "time_this_iter_s": 11.95403528213501, "time_total_s": 70.8029510974884, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 70.8029510974884, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.600000000000001, "ram_util_percent": 15.3625, "gpu_util_percent0": 0.208125, "vram_util_percent0": 0.19244893391927084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.957455233861041, "policy_loss": -0.01769363074212946, "vf_loss": 4.972343605308122, "vf_explained_var": -5.579443388087775e-06, "kl": 0.014026254903110776, "entropy": 4.392597395886657, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -243.62419546838555, "episode_reward_mean": -181.8330734623011, "episode_len_mean": 95.13846153846154, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6969147876857907, "mean_inference_ms": 2.010181269555815, "mean_action_processing_ms": 0.32469214339313024, "mean_env_wait_ms": 3.1177427695338706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06293773651123047, "StateBufferConnector_ms": 0.014361968407264123, "ViewRequirementAgentConnector_ms": 0.24671041048490083}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -243.62419546838555, "episode_reward_mean": -181.8330734623011, "episode_len_mean": 95.13846153846154, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6969147876857907, "mean_inference_ms": 2.010181269555815, "mean_action_processing_ms": 0.32469214339313024, "mean_env_wait_ms": 3.1177427695338706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06293773651123047, "StateBufferConnector_ms": 0.014361968407264123, "ViewRequirementAgentConnector_ms": 0.24671041048490083}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.29722604216676, "num_env_steps_trained_throughput_per_sec": 341.29722604216676, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11286.14, "sample_time_ms": 516.479, "load_time_ms": 7.531, "load_throughput": 531145.467, "learn_time_ms": 10646.725, "learn_throughput": 375.702, "synch_weights_time_ms": 114.379}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 65, "training_iteration": 7, "trial_id": "default", "date": "2024-08-30_11-33-41", "timestamp": 1724988821, "time_this_iter_s": 12.30684232711792, "time_total_s": 83.10979342460632, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 83.10979342460632, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.8625, "ram_util_percent": 15.425, "gpu_util_percent0": 0.198125, "vram_util_percent0": 0.19087982177734375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.597694819460633, "policy_loss": -0.018024695460354127, "vf_loss": 4.6135176440720915, "vf_explained_var": -4.137267348586872e-06, "kl": 0.01100930049877754, "entropy": 4.305727288543537, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -267.9411487366694, "episode_reward_mean": -182.41935360800073, "episode_len_mean": 105.52857142857142, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6965178942840323, "mean_inference_ms": 2.0737820095536654, "mean_action_processing_ms": 0.32567656361320235, "mean_env_wait_ms": 3.153387496832286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06184748240879604, "StateBufferConnector_ms": 0.01399789537702288, "ViewRequirementAgentConnector_ms": 0.2429168564932687}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -267.9411487366694, "episode_reward_mean": -182.41935360800073, "episode_len_mean": 105.52857142857142, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6965178942840323, "mean_inference_ms": 2.0737820095536654, "mean_action_processing_ms": 0.32567656361320235, "mean_env_wait_ms": 3.153387496832286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06184748240879604, "StateBufferConnector_ms": 0.01399789537702288, "ViewRequirementAgentConnector_ms": 0.2429168564932687}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.1267023048008, "num_env_steps_trained_throughput_per_sec": 344.1267023048008, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11328.315, "sample_time_ms": 535.8, "load_time_ms": 7.772, "load_throughput": 514640.501, "learn_time_ms": 10663.295, "learn_throughput": 375.119, "synch_weights_time_ms": 120.426}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 70, "training_iteration": 8, "trial_id": "default", "date": "2024-08-30_11-33-53", "timestamp": 1724988833, "time_this_iter_s": 12.187530755996704, "time_total_s": 95.29732418060303, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 95.29732418060303, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.346666666666666, "ram_util_percent": 15.493333333333332, "gpu_util_percent0": 0.238, "vram_util_percent0": 0.18779839409722224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.342938937166686, "policy_loss": -0.01323497028600785, "vf_loss": 4.353804738162666, "vf_explained_var": -2.982539515341482e-06, "kl": 0.01184584559464041, "entropy": 4.321704114124339, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -267.9411487366694, "episode_reward_mean": -184.79451548882435, "episode_len_mean": 116.48717948717949, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6949322748240429, "mean_inference_ms": 2.077409141282677, "mean_action_processing_ms": 0.32695921200966377, "mean_env_wait_ms": 3.1783357373269423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06160308153201372, "StateBufferConnector_ms": 0.01380749237843049, "ViewRequirementAgentConnector_ms": 0.2446428323403383}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -267.9411487366694, "episode_reward_mean": -184.79451548882435, "episode_len_mean": 116.48717948717949, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6949322748240429, "mean_inference_ms": 2.077409141282677, "mean_action_processing_ms": 0.32695921200966377, "mean_env_wait_ms": 3.1783357373269423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06160308153201372, "StateBufferConnector_ms": 0.01380749237843049, "ViewRequirementAgentConnector_ms": 0.2446428323403383}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.5975755764531, "num_env_steps_trained_throughput_per_sec": 358.5975755764531, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11309.002, "sample_time_ms": 522.504, "load_time_ms": 7.829, "load_throughput": 510939.7, "learn_time_ms": 10658.13, "learn_throughput": 375.3, "synch_weights_time_ms": 119.526}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 78, "training_iteration": 9, "trial_id": "default", "date": "2024-08-30_11-34-05", "timestamp": 1724988845, "time_this_iter_s": 11.74495530128479, "time_total_s": 107.04227948188782, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 107.04227948188782, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.55, "ram_util_percent": 15.55, "gpu_util_percent0": 0.1325, "vram_util_percent0": 0.18333180745442706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.094332375449519, "policy_loss": -0.01281861878370726, "vf_loss": 4.1045174633303, "vf_explained_var": -2.798982845839634e-06, "kl": 0.013167659889672563, "entropy": 4.40620056941945, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -187.03951352310295, "episode_len_mean": 126.36781609195403, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236579581738182, "mean_inference_ms": 2.1272845245772944, "mean_action_processing_ms": 0.3288707947813679, "mean_env_wait_ms": 3.2201926445935865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06187976091757588, "StateBufferConnector_ms": 0.013873220860272989, "ViewRequirementAgentConnector_ms": 0.24908520709509138}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -187.03951352310295, "episode_len_mean": 126.36781609195403, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.81122051549065, -1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277], "episode_lengths": [23, 9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236579581738182, "mean_inference_ms": 2.1272845245772944, "mean_action_processing_ms": 0.3288707947813679, "mean_env_wait_ms": 3.2201926445935865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06187976091757588, "StateBufferConnector_ms": 0.013873220860272989, "ViewRequirementAgentConnector_ms": 0.24908520709509138}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.21474237682287, "num_env_steps_trained_throughput_per_sec": 352.21474237682287, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11313.767, "sample_time_ms": 539.932, "load_time_ms": 7.959, "load_throughput": 502570.665, "learn_time_ms": 10645.039, "learn_throughput": 375.762, "synch_weights_time_ms": 119.821}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 87, "training_iteration": 10, "trial_id": "default", "date": "2024-08-30_11-34-17", "timestamp": 1724988857, "time_this_iter_s": 11.939516067504883, "time_total_s": 118.9817955493927, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 118.9817955493927, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.693333333333333, "ram_util_percent": 15.599999999999998, "gpu_util_percent0": 0.18333333333333332, "vram_util_percent0": 0.1842746310763889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.181325468709392, "policy_loss": -0.015285494178533554, "vf_loss": 4.192745772228446, "vf_explained_var": -6.653096086235457e-06, "kl": 0.019325889239209124, "entropy": 4.4483292871905915, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -190.727455618372, "episode_len_mean": 148.44, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552], "episode_lengths": [9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7327349846704511, "mean_inference_ms": 2.1495726572104483, "mean_action_processing_ms": 0.33025566257469846, "mean_env_wait_ms": 3.329830648420556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06039857864379883, "StateBufferConnector_ms": 0.013479471206665039, "ViewRequirementAgentConnector_ms": 0.2465043067932129}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -190.727455618372, "episode_len_mean": 148.44, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0789495265511162, -190.4590889946531, -183.54658616213442, -194.14205925509734, -187.31945322951066, -178.67474593443364, -181.42433982002774, -189.9503068876344, -182.69848965887638, -190.07272326010187, -185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552], "episode_lengths": [9, 60, 52, 63, 34, 38, 38, 50, 53, 60, 44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7327349846704511, "mean_inference_ms": 2.1495726572104483, "mean_action_processing_ms": 0.33025566257469846, "mean_env_wait_ms": 3.329830648420556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06039857864379883, "StateBufferConnector_ms": 0.013479471206665039, "ViewRequirementAgentConnector_ms": 0.2465043067932129}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.95075638777274, "num_env_steps_trained_throughput_per_sec": 350.95075638777274, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11266.936, "sample_time_ms": 509.423, "load_time_ms": 8.692, "load_throughput": 460169.177, "learn_time_ms": 10627.778, "learn_throughput": 376.372, "synch_weights_time_ms": 120.067}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 101, "training_iteration": 11, "trial_id": "default", "date": "2024-08-30_11-34-29", "timestamp": 1724988869, "time_this_iter_s": 11.97946834564209, "time_total_s": 130.9612638950348, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 130.9612638950348, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.756250000000001, "ram_util_percent": 15.65625, "gpu_util_percent0": 0.195625, "vram_util_percent0": 0.18063100179036456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.676840534517842, "policy_loss": -0.018641721349089375, "vf_loss": 3.6931699347752396, "vf_explained_var": -1.9137577344012518e-07, "kl": 0.01156159982833791, "entropy": 4.456975612845472, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -193.44070827734689, "episode_len_mean": 174.77, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228], "episode_lengths": [44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7291156628923341, "mean_inference_ms": 2.195485954657968, "mean_action_processing_ms": 0.33311805950376727, "mean_env_wait_ms": 3.4550548005549384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058969974517822266, "StateBufferConnector_ms": 0.012837648391723633, "ViewRequirementAgentConnector_ms": 0.24453973770141602}}, "episode_reward_max": -0.875937699052818, "episode_reward_min": -269.3301210375264, "episode_reward_mean": -193.44070827734689, "episode_len_mean": 174.77, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.1491437774074, -201.18284809232003, -187.07754194808402, -179.73790282238843, -195.0077777732348, -190.0697912014007, -184.55993789032428, -200.2459560975448, -177.2960015766248, -20.419356512767738, -195.92488369842474, -187.3524203563318, -190.87996497197784, -174.057928222929, -195.52986094477117, -196.68109651009524, -183.23368081792043, -192.6808285580153, -195.57320360472977, -184.8438450326697, -187.1263668856714, -191.45468338760543, -199.57487022387667, -0.875937699052818, -185.40492649254708, -200.9713952899168, -207.064035419966, -207.5977760100675, -184.69855081101778, -206.68320133252772, -194.97158199054866, -185.9835100184584, -211.25690285157862, -202.3409045628472, -203.357326996955, -25.578737674168234, -183.3745535352222, -195.5953582656315, -217.6238622389754, -194.50821431735721, -174.90750013530675, -242.312393805297, -186.86469685422173, -220.89267792080514, -226.02438622083767, -181.7091707908666, -230.7995680285024, -192.95522920885148, -185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228], "episode_lengths": [44, 93, 84, 71, 69, 80, 63, 76, 45, 79, 73, 70, 70, 78, 66, 80, 66, 64, 63, 92, 69, 98, 98, 9, 69, 117, 101, 123, 41, 133, 160, 78, 134, 125, 147, 135, 74, 94, 168, 82, 64, 181, 165, 212, 195, 203, 209, 130, 34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7291156628923341, "mean_inference_ms": 2.195485954657968, "mean_action_processing_ms": 0.33311805950376727, "mean_env_wait_ms": 3.4550548005549384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058969974517822266, "StateBufferConnector_ms": 0.012837648391723633, "ViewRequirementAgentConnector_ms": 0.24453973770141602}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.3019999903534, "num_env_steps_trained_throughput_per_sec": 347.3019999903534, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11282.132, "sample_time_ms": 508.232, "load_time_ms": 8.796, "load_throughput": 454736.112, "learn_time_ms": 10643.019, "learn_throughput": 375.833, "synch_weights_time_ms": 121.109}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 111, "training_iteration": 12, "trial_id": "default", "date": "2024-08-30_11-34-41", "timestamp": 1724988881, "time_this_iter_s": 12.095577001571655, "time_total_s": 143.05684089660645, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 143.05684089660645, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.79375, "ram_util_percent": 15.71875, "gpu_util_percent0": 0.21687499999999998, "vram_util_percent0": 0.18178812662760419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.683834059520434, "policy_loss": -0.023584545750211003, "vf_loss": 4.704738796398204, "vf_explained_var": -3.1487916105537007e-07, "kl": 0.013399057799915192, "entropy": 4.349931827924585, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -27.130581948242188, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -196.6577869837608, "episode_len_mean": 309.74, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915], "episode_lengths": [34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7554558623041663, "mean_inference_ms": 2.3853943580137322, "mean_action_processing_ms": 0.3415164987561009, "mean_env_wait_ms": 3.8504340521537586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062300682067871094, "StateBufferConnector_ms": 0.012069940567016602, "ViewRequirementAgentConnector_ms": 0.23308587074279785}}, "episode_reward_max": -27.130581948242188, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -196.6577869837608, "episode_len_mean": 309.74, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.37923726876824, -189.07263337941697, -27.130581948242188, -243.62419546838555, -220.7830606286172, -234.96981373298664, -191.94699100256224, -234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915], "episode_lengths": [34, 87, 122, 198, 208, 215, 243, 245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7554558623041663, "mean_inference_ms": 2.3853943580137322, "mean_action_processing_ms": 0.3415164987561009, "mean_env_wait_ms": 3.8504340521537586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062300682067871094, "StateBufferConnector_ms": 0.012069940567016602, "ViewRequirementAgentConnector_ms": 0.23308587074279785}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.9435914335389, "num_env_steps_trained_throughput_per_sec": 350.9435914335389, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11316.895, "sample_time_ms": 515.182, "load_time_ms": 9.011, "load_throughput": 443913.33, "learn_time_ms": 10674.912, "learn_throughput": 374.71, "synch_weights_time_ms": 116.805}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 159, "training_iteration": 13, "trial_id": "default", "date": "2024-08-30_11-34-53", "timestamp": 1724988893, "time_this_iter_s": 11.97159481048584, "time_total_s": 155.02843570709229, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 155.02843570709229, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.666666666666666, "ram_util_percent": 15.746666666666668, "gpu_util_percent0": 0.24333333333333332, "vram_util_percent0": 0.1819146050347222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.298072733545816, "policy_loss": -0.012468507216982944, "vf_loss": 3.3076063221500767, "vf_explained_var": -8.274150151078419e-08, "kl": 0.014674585279088558, "entropy": 4.300442429511778, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -66.16406654439639, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -197.18922740764893, "episode_len_mean": 319.56, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886], "episode_lengths": [245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7543227451916298, "mean_inference_ms": 2.386259296828537, "mean_action_processing_ms": 0.34185384325579804, "mean_env_wait_ms": 3.885069346689964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059728384017944336, "StateBufferConnector_ms": 0.01103520393371582, "ViewRequirementAgentConnector_ms": 0.23016595840454102}}, "episode_reward_max": -66.16406654439639, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -197.18922740764893, "episode_len_mean": 319.56, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.31143203544735, -267.9411487366694, -66.16406654439639, -189.841339191408, -190.2932989076495, -219.83385535829746, -176.23379672337524, -266.1814228622835, -192.14985109776472, -232.03863054248913, -187.47469852979725, -180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886], "episode_lengths": [245, 234, 246, 235, 251, 255, 83, 250, 255, 273, 64, 268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7543227451916298, "mean_inference_ms": 2.386259296828537, "mean_action_processing_ms": 0.34185384325579804, "mean_env_wait_ms": 3.885069346689964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059728384017944336, "StateBufferConnector_ms": 0.01103520393371582, "ViewRequirementAgentConnector_ms": 0.23016595840454102}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.0525271414649, "num_env_steps_trained_throughput_per_sec": 349.0525271414649, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11387.991, "sample_time_ms": 532.963, "load_time_ms": 9.063, "load_throughput": 441354.694, "learn_time_ms": 10726.909, "learn_throughput": 372.894, "synch_weights_time_ms": 118.089}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 166, "training_iteration": 14, "trial_id": "default", "date": "2024-08-30_11-35-05", "timestamp": 1724988905, "time_this_iter_s": 12.043117761611938, "time_total_s": 167.07155346870422, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 167.07155346870422, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.68125, "ram_util_percent": 15.71875, "gpu_util_percent0": 0.194375, "vram_util_percent0": 0.18150838216145834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.217791765159176, "policy_loss": -0.017524966255571414, "vf_loss": 3.2309267869239213, "vf_explained_var": -1.422820552702873e-07, "kl": 0.021949730101898962, "entropy": 4.201583962286672, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -195.00965009543268, "episode_len_mean": 331.81, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793], "episode_lengths": [268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7680895069558923, "mean_inference_ms": 2.415553491756815, "mean_action_processing_ms": 0.3426748215952077, "mean_env_wait_ms": 3.9036415108426494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0590360164642334, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.22985100746154785}}, "episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -195.00965009543268, "episode_len_mean": 331.81, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180.41190154658713, -190.3238923478289, -199.850913850753, -251.15420891965675, -192.95547198624203, -242.3567016681718, -198.53521400364758, -78.43646153117452, -269.3301210375264, -235.52248303665277, -206.8410198586618, -161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793], "episode_lengths": [268, 128, 72, 314, 71, 284, 170, 285, 296, 288, 231, 330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7680895069558923, "mean_inference_ms": 2.415553491756815, "mean_action_processing_ms": 0.3426748215952077, "mean_env_wait_ms": 3.9036415108426494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0590360164642334, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.22985100746154785}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.9638158198024, "num_env_steps_trained_throughput_per_sec": 363.9638158198024, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11397.646, "sample_time_ms": 529.036, "load_time_ms": 9.051, "load_throughput": 441962.767, "learn_time_ms": 10741.449, "learn_throughput": 372.389, "synch_weights_time_ms": 117.151}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 177, "training_iteration": 15, "trial_id": "default", "date": "2024-08-30_11-35-17", "timestamp": 1724988917, "time_this_iter_s": 11.575035095214844, "time_total_s": 178.64658856391907, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 178.64658856391907, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.326666666666666, "ram_util_percent": 15.926666666666666, "gpu_util_percent0": 0.17466666666666666, "vram_util_percent0": 0.18108181423611114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.942465710303476, "policy_loss": -0.015943065948624123, "vf_loss": 2.9544341359087216, "vf_explained_var": 2.1130807938114288e-07, "kl": 0.01324886702394153, "entropy": 4.276504152820956, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -192.3483175212228, "episode_len_mean": 347.03, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616], "episode_lengths": [330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7529944041879153, "mean_inference_ms": 2.422060510863875, "mean_action_processing_ms": 0.34265173117837583, "mean_env_wait_ms": 3.9174703204019323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05955362319946289, "StateBufferConnector_ms": 0.010793209075927734, "ViewRequirementAgentConnector_ms": 0.2270340919494629}}, "episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -192.3483175212228, "episode_len_mean": 347.03, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-161.02998418304887, -179.76587708875567, -222.36242100558252, -248.64675021656421, -234.0699374738566, -188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616], "episode_lengths": [330, 37, 335, 292, 274, 61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7529944041879153, "mean_inference_ms": 2.422060510863875, "mean_action_processing_ms": 0.34265173117837583, "mean_env_wait_ms": 3.9174703204019323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05955362319946289, "StateBufferConnector_ms": 0.010793209075927734, "ViewRequirementAgentConnector_ms": 0.2270340919494629}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.6818139118449, "num_env_steps_trained_throughput_per_sec": 348.6818139118449, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11408.85, "sample_time_ms": 543.075, "load_time_ms": 8.985, "load_throughput": 445167.775, "learn_time_ms": 10738.196, "learn_throughput": 372.502, "synch_weights_time_ms": 117.593}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 188, "training_iteration": 16, "trial_id": "default", "date": "2024-08-30_11-35-29", "timestamp": 1724988929, "time_this_iter_s": 12.072984457015991, "time_total_s": 190.71957302093506, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 190.71957302093506, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.243749999999999, "ram_util_percent": 16.06875, "gpu_util_percent0": 0.243125, "vram_util_percent0": 0.18257395426432294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1221857656714738, "policy_loss": -0.012482475424285537, "vf_loss": 3.1310180725589873, "vf_explained_var": 4.871558117610152e-07, "kl": 0.012167255522248895, "entropy": 4.380284012517621, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -191.91516016540993, "episode_len_mean": 350.9, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424], "episode_lengths": [61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7396533726879154, "mean_inference_ms": 2.4164061411121573, "mean_action_processing_ms": 0.3431046881136976, "mean_env_wait_ms": 3.9366717840570336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05943441390991211, "StateBufferConnector_ms": 0.010706186294555664, "ViewRequirementAgentConnector_ms": 0.22507286071777344}}, "episode_reward_max": -57.20602551576618, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -191.91516016540993, "episode_len_mean": 350.9, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188.52341729522186, -247.5792324535957, -250.08393932522745, -209.09560412818234, -243.17418930151308, -214.30583716985558, -189.65151883808417, -183.98937750458552, -199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424], "episode_lengths": [61, 334, 322, 318, 324, 339, 341, 335, 300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7396533726879154, "mean_inference_ms": 2.4164061411121573, "mean_action_processing_ms": 0.3431046881136976, "mean_env_wait_ms": 3.9366717840570336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05943441390991211, "StateBufferConnector_ms": 0.010706186294555664, "ViewRequirementAgentConnector_ms": 0.22507286071777344}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.1544697062088, "num_env_steps_trained_throughput_per_sec": 345.1544697062088, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 11395.748, "sample_time_ms": 495.974, "load_time_ms": 9.625, "load_throughput": 415577.992, "learn_time_ms": 10770.026, "learn_throughput": 371.401, "synch_weights_time_ms": 119.096}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 193, "training_iteration": 17, "trial_id": "default", "date": "2024-08-30_11-35-41", "timestamp": 1724988941, "time_this_iter_s": 12.138552904129028, "time_total_s": 202.8581259250641, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 202.8581259250641, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.686666666666667, "ram_util_percent": 16.139999999999997, "gpu_util_percent0": 0.2833333333333333, "vram_util_percent0": 0.18310275607638887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1264378493191094, "policy_loss": -0.01530761267809618, "vf_loss": 3.139139801263809, "vf_explained_var": 2.6181179990050614e-07, "kl": 0.008685515651301611, "entropy": 4.359971545332222, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -30.274980719451662, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -189.54032008935857, "episode_len_mean": 351.49, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587], "episode_lengths": [300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.748416036822531, "mean_inference_ms": 2.428096856441039, "mean_action_processing_ms": 0.34405325111974716, "mean_env_wait_ms": 3.9172161036075033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066155433654785, "StateBufferConnector_ms": 0.010966062545776367, "ViewRequirementAgentConnector_ms": 0.23111510276794434}}, "episode_reward_max": -30.274980719451662, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -189.54032008935857, "episode_len_mean": 351.49, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-199.17206638425898, -172.71152130888842, -193.5968707211279, -155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587], "episode_lengths": [300, 350, 101, 366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.748416036822531, "mean_inference_ms": 2.428096856441039, "mean_action_processing_ms": 0.34405325111974716, "mean_env_wait_ms": 3.9172161036075033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066155433654785, "StateBufferConnector_ms": 0.010966062545776367, "ViewRequirementAgentConnector_ms": 0.23111510276794434}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.288226801462, "num_env_steps_trained_throughput_per_sec": 355.288226801462, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11359.234, "sample_time_ms": 465.037, "load_time_ms": 9.503, "load_throughput": 420932.075, "learn_time_ms": 10770.218, "learn_throughput": 371.395, "synch_weights_time_ms": 113.448}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 201, "training_iteration": 18, "trial_id": "default", "date": "2024-08-30_11-35-53", "timestamp": 1724988953, "time_this_iter_s": 11.857421398162842, "time_total_s": 214.71554732322693, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 214.71554732322693, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.28125, "ram_util_percent": 16.175, "gpu_util_percent0": 0.21, "vram_util_percent0": 0.18143208821614584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.068054218494123, "policy_loss": -0.018793919835720332, "vf_loss": 3.0820275257992487, "vf_explained_var": 0.00032877076056695754, "kl": 0.01606871983717366, "entropy": 4.349723350104465, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -30.274980719451662, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -189.59560000976487, "episode_len_mean": 355.52, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169], "episode_lengths": [366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7517237016025152, "mean_inference_ms": 2.4229995380907785, "mean_action_processing_ms": 0.3441554781294982, "mean_env_wait_ms": 3.910808548800221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06078648567199707, "StateBufferConnector_ms": 0.010993242263793945, "ViewRequirementAgentConnector_ms": 0.23089337348937988}}, "episode_reward_max": -30.274980719451662, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -189.59560000976487, "episode_len_mean": 355.52, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155.98721061090245, -212.42046333949486, -211.9326763466331, -173.52848264244537, -225.61966228881863, -191.22279775759975, -214.50025722634228, -122.68131801239474, -226.36906021030885, -166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169], "episode_lengths": [366, 211, 345, 364, 343, 346, 364, 399, 399, 399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7517237016025152, "mean_inference_ms": 2.4229995380907785, "mean_action_processing_ms": 0.3441554781294982, "mean_env_wait_ms": 3.910808548800221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06078648567199707, "StateBufferConnector_ms": 0.010993242263793945, "ViewRequirementAgentConnector_ms": 0.23089337348937988}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.9824577952133, "num_env_steps_trained_throughput_per_sec": 360.9824577952133, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11351.864, "sample_time_ms": 459.06, "load_time_ms": 9.645, "load_throughput": 414715.089, "learn_time_ms": 10767.775, "learn_throughput": 371.479, "synch_weights_time_ms": 114.364}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 204, "training_iteration": 19, "trial_id": "default", "date": "2024-08-30_11-36-05", "timestamp": 1724988965, "time_this_iter_s": 11.64941668510437, "time_total_s": 226.3649640083313, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 226.3649640083313, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.139999999999997, "ram_util_percent": 15.713333333333333, "gpu_util_percent0": 0.19133333333333333, "vram_util_percent0": 0.18121744791666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0406745718371484, "policy_loss": -0.02399631974597772, "vf_loss": 3.060540569854039, "vf_explained_var": 0.013105271388125676, "kl": 0.013767735356989478, "entropy": 4.392547997095251, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -27.10622814414619, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -190.34932538676873, "episode_len_mean": 353.89, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562], "episode_lengths": [399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7596399062191521, "mean_inference_ms": 2.4099915589534318, "mean_action_processing_ms": 0.3440009859483874, "mean_env_wait_ms": 3.8742057830721484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06278276443481445, "StateBufferConnector_ms": 0.011234283447265625, "ViewRequirementAgentConnector_ms": 0.23548197746276855}}, "episode_reward_max": -27.10622814414619, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -190.34932538676873, "episode_len_mean": 353.89, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-166.48837907134057, -157.90442452339266, -217.2929494314611, -152.0392176661633, -160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562], "episode_lengths": [399, 399, 399, 399, 399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7596399062191521, "mean_inference_ms": 2.4099915589534318, "mean_action_processing_ms": 0.3440009859483874, "mean_env_wait_ms": 3.8742057830721484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06278276443481445, "StateBufferConnector_ms": 0.011234283447265625, "ViewRequirementAgentConnector_ms": 0.23548197746276855}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.7432867903803, "num_env_steps_trained_throughput_per_sec": 359.7432867903803, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11328.096, "sample_time_ms": 424.6, "load_time_ms": 9.67, "load_throughput": 413644.547, "learn_time_ms": 10778.812, "learn_throughput": 371.098, "synch_weights_time_ms": 114.007}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 213, "training_iteration": 20, "trial_id": "default", "date": "2024-08-30_11-36-16", "timestamp": 1724988976, "time_this_iter_s": 11.708102703094482, "time_total_s": 238.07306671142578, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 238.07306671142578, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.62666666666667, "ram_util_percent": 14.159999999999997, "gpu_util_percent0": 0.15333333333333332, "vram_util_percent0": 0.18050401475694444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3916332385232373, "policy_loss": -0.012938023227897864, "vf_loss": 3.400326935962964, "vf_explained_var": 2.5053178110430317e-07, "kl": 0.014147778271518457, "entropy": 4.441171809422072, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -27.10622814414619, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -190.5870055927059, "episode_len_mean": 352.21, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707], "episode_lengths": [399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7568696815645964, "mean_inference_ms": 2.358030812962181, "mean_action_processing_ms": 0.3429660061296091, "mean_env_wait_ms": 3.9040653980186044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06256866455078125, "StateBufferConnector_ms": 0.011065483093261719, "ViewRequirementAgentConnector_ms": 0.23443293571472168}}, "episode_reward_max": -27.10622814414619, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -190.5870055927059, "episode_len_mean": 352.21, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160.33669626456924, -146.68601024160162, -185.34063638890848, -269.68707562259084, -208.84834277688486, -134.1245313473981, -180.33412570370533, -148.03514674114246, -140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707], "episode_lengths": [399, 399, 389, 399, 399, 399, 399, 399, 399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7568696815645964, "mean_inference_ms": 2.358030812962181, "mean_action_processing_ms": 0.3429660061296091, "mean_env_wait_ms": 3.9040653980186044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06256866455078125, "StateBufferConnector_ms": 0.011065483093261719, "ViewRequirementAgentConnector_ms": 0.23443293571472168}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.3151197419299, "num_env_steps_trained_throughput_per_sec": 366.3151197419299, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11280.293, "sample_time_ms": 416.818, "load_time_ms": 9.756, "load_throughput": 410015.421, "learn_time_ms": 10739.827, "learn_throughput": 372.445, "synch_weights_time_ms": 112.883}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 217, "training_iteration": 21, "trial_id": "default", "date": "2024-08-30_11-36-28", "timestamp": 1724988988, "time_this_iter_s": 11.516016483306885, "time_total_s": 249.58908319473267, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 249.58908319473267, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.813333333333333, "ram_util_percent": 14.166666666666666, "gpu_util_percent0": 0.18533333333333335, "vram_util_percent0": 0.1799343532986111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.62366500413546, "policy_loss": -0.017568845427044295, "vf_loss": 3.637432550999426, "vf_explained_var": 8.08828620500462e-08, "kl": 0.012671010158718214, "entropy": 4.553078937274154, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -191.6602183551241, "episode_len_mean": 344.33, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926], "episode_lengths": [399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7352329719027704, "mean_inference_ms": 2.3429935429651625, "mean_action_processing_ms": 0.34397431272095985, "mean_env_wait_ms": 3.934627947100425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06207537651062012, "StateBufferConnector_ms": 0.011481523513793945, "ViewRequirementAgentConnector_ms": 0.2332477569580078}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -279.9334321443319, "episode_reward_mean": -191.6602183551241, "episode_len_mean": 344.33, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-140.96725923415121, -148.61644619608253, -174.41524589854495, -125.404741202455, -160.07140968693804, -224.3822128513598, -168.01713352250317, -192.2632391346356, -206.31417733982735, -237.47343850295957, -152.66414225631752, -224.533962495157, -208.66094856239508, -199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926], "episode_lengths": [399, 399, 399, 399, 392, 399, 399, 399, 94, 399, 399, 377, 399, 399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7352329719027704, "mean_inference_ms": 2.3429935429651625, "mean_action_processing_ms": 0.34397431272095985, "mean_env_wait_ms": 3.934627947100425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06207537651062012, "StateBufferConnector_ms": 0.011481523513793945, "ViewRequirementAgentConnector_ms": 0.2332477569580078}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.66571998549364, "num_env_steps_trained_throughput_per_sec": 358.66571998549364, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 11243.802, "sample_time_ms": 417.142, "load_time_ms": 9.812, "load_throughput": 407670.136, "learn_time_ms": 10703.945, "learn_throughput": 373.694, "synch_weights_time_ms": 111.887}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 225, "training_iteration": 22, "trial_id": "default", "date": "2024-08-30_11-36-40", "timestamp": 1724989000, "time_this_iter_s": 11.7514169216156, "time_total_s": 261.34050011634827, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 261.34050011634827, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.893333333333336, "ram_util_percent": 14.22, "gpu_util_percent0": 0.19866666666666669, "vram_util_percent0": 0.17988009982638886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6844566664388103, "policy_loss": -0.03455854864485602, "vf_loss": 3.7152757974722053, "vf_explained_var": 3.593749897454374e-05, "kl": 0.012464716431487012, "entropy": 4.504090160451909, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -193.58986106594216, "episode_len_mean": 343.71, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143], "episode_lengths": [399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7566823785922537, "mean_inference_ms": 2.355754874499389, "mean_action_processing_ms": 0.34424411749830947, "mean_env_wait_ms": 3.852298316828169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061423540115356445, "StateBufferConnector_ms": 0.011547088623046875, "ViewRequirementAgentConnector_ms": 0.23598933219909668}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -193.58986106594216, "episode_len_mean": 343.71, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-199.10558256538027, -183.37448023494906, -198.7556929952004, -216.1899191745265, -194.1757560516209, -174.80718246789155, -279.9334321443319, -242.20940785748385, -225.30733648934643, -171.00734367952745, -166.97218563392312, -204.8531571534741, -126.9324060133509, -224.374071358614, -153.3459628453743, -232.56838030202448, -257.38183880129355, -249.56905751340452, -231.79685604337286, -181.5060488471025, -227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143], "episode_lengths": [399, 399, 399, 295, 377, 399, 287, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 166, 399, 399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7566823785922537, "mean_inference_ms": 2.355754874499389, "mean_action_processing_ms": 0.34424411749830947, "mean_env_wait_ms": 3.852298316828169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061423540115356445, "StateBufferConnector_ms": 0.011547088623046875, "ViewRequirementAgentConnector_ms": 0.23598933219909668}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.6396616664429, "num_env_steps_trained_throughput_per_sec": 360.6396616664429, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11213.161, "sample_time_ms": 403.084, "load_time_ms": 9.996, "load_throughput": 400173.071, "learn_time_ms": 10683.786, "learn_throughput": 374.399, "synch_weights_time_ms": 115.283}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 238, "training_iteration": 23, "trial_id": "default", "date": "2024-08-30_11-36-51", "timestamp": 1724989011, "time_this_iter_s": 11.67549991607666, "time_total_s": 273.0160000324249, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 273.0160000324249, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.359999999999998, "ram_util_percent": 14.28666666666667, "gpu_util_percent0": 0.18333333333333332, "vram_util_percent0": 0.1800455729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5722924243378382, "policy_loss": -0.018967617216009286, "vf_loss": 3.5875081976895693, "vf_explained_var": -2.1896695577970114e-06, "kl": 0.012506106153370873, "entropy": 4.382091129723416, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -191.58293768331984, "episode_len_mean": 340.55, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547], "episode_lengths": [399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7710331350420907, "mean_inference_ms": 2.370078710021438, "mean_action_processing_ms": 0.3449293510239466, "mean_env_wait_ms": 3.785255024594514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05737614631652832, "StateBufferConnector_ms": 0.011892557144165039, "ViewRequirementAgentConnector_ms": 0.24438071250915527}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -191.58293768331984, "episode_len_mean": 340.55, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-227.60179096264915, -180.98016091293536, -251.94218079672441, -195.96221975851157, -144.6545876564836, -197.0436842850348, -192.26538956004563, -183.20233284805886, -185.85512701936963, -186.87146948997747, -212.4816077164291, -189.51345445772762, -263.3860687426376, -57.20602551576618, -164.98012083129848, -178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547], "episode_lengths": [399, 384, 337, 399, 399, 361, 174, 35, 399, 78, 399, 399, 252, 187, 399, 399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7710331350420907, "mean_inference_ms": 2.370078710021438, "mean_action_processing_ms": 0.3449293510239466, "mean_env_wait_ms": 3.785255024594514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05737614631652832, "StateBufferConnector_ms": 0.011892557144165039, "ViewRequirementAgentConnector_ms": 0.24438071250915527}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.91605637861585, "num_env_steps_trained_throughput_per_sec": 357.91605637861585, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11184.78, "sample_time_ms": 390.642, "load_time_ms": 9.946, "load_throughput": 402154.834, "learn_time_ms": 10665.738, "learn_throughput": 375.033, "synch_weights_time_ms": 117.399}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 258, "training_iteration": 24, "trial_id": "default", "date": "2024-08-30_11-37-03", "timestamp": 1724989023, "time_this_iter_s": 11.773420333862305, "time_total_s": 284.78942036628723, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 284.78942036628723, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.8875, "ram_util_percent": 14.337500000000002, "gpu_util_percent0": 0.19375, "vram_util_percent0": 0.18068440755208334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.112781209714951, "policy_loss": -0.016351296732662828, "vf_loss": 3.1243559026910415, "vf_explained_var": 3.1334097667406963e-07, "kl": 0.015921999540890977, "entropy": 4.1812107575837, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -191.64020049254566, "episode_len_mean": 351.22, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204], "episode_lengths": [399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7695609598527235, "mean_inference_ms": 2.3597681647869075, "mean_action_processing_ms": 0.34462681715719967, "mean_env_wait_ms": 3.7493003975839447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056806325912475586, "StateBufferConnector_ms": 0.012009382247924805, "ViewRequirementAgentConnector_ms": 0.24438834190368652}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -191.64020049254566, "episode_len_mean": 351.22, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178.9564537302686, -255.47388554622825, -156.29445651627307, -153.48713974197793, -182.34344110879653, -170.9194479293041, -263.5119800569446, -115.15253495883243, -116.87777708361675, -220.3093145767495, -174.48179114454302, -190.90125871176252, -190.0132476378985, -158.06315752685717, -197.011181630616, -229.77728656381015, -197.09417779023426, -200.4438749607996, -129.38934415141264, -245.85455092026424, -233.31591413572167, -228.0984905486769, -192.90741043411396, -229.34912558001312, -198.37154698543657, -184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204], "episode_lengths": [399, 306, 399, 399, 370, 306, 399, 399, 399, 399, 378, 399, 82, 399, 399, 399, 335, 123, 399, 399, 399, 399, 399, 267, 265, 166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7695609598527235, "mean_inference_ms": 2.3597681647869075, "mean_action_processing_ms": 0.34462681715719967, "mean_env_wait_ms": 3.7493003975839447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056806325912475586, "StateBufferConnector_ms": 0.012009382247924805, "ViewRequirementAgentConnector_ms": 0.24438834190368652}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.31218890672756, "num_env_steps_trained_throughput_per_sec": 359.31218890672756, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11199.008, "sample_time_ms": 391.318, "load_time_ms": 10.023, "load_throughput": 399082.197, "learn_time_ms": 10678.671, "learn_throughput": 374.578, "synch_weights_time_ms": 117.928}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 273, "training_iteration": 25, "trial_id": "default", "date": "2024-08-30_11-37-15", "timestamp": 1724989035, "time_this_iter_s": 11.721148252487183, "time_total_s": 296.5105686187744, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 296.5105686187744, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.22, "ram_util_percent": 14.340000000000003, "gpu_util_percent0": 0.17466666666666664, "vram_util_percent0": 0.18348524305555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1611418252991093, "policy_loss": -0.013230933108797638, "vf_loss": 3.1707985413651314, "vf_explained_var": 6.171964829967868e-07, "kl": 0.011914059488723676, "entropy": 4.0836864456053705, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -186.56914232906715, "episode_len_mean": 362.43, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248], "episode_lengths": [166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7476740923851449, "mean_inference_ms": 2.2962414218551213, "mean_action_processing_ms": 0.3448538263491109, "mean_env_wait_ms": 3.777026614944077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05373072624206543, "StateBufferConnector_ms": 0.011793851852416992, "ViewRequirementAgentConnector_ms": 0.23821258544921875}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -186.56914232906715, "episode_len_mean": 362.43, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184.27118502577466, -30.274980719451662, -192.33045498193587, -248.61101737588416, -144.01866721630716, -178.3787658627169, -224.46573541435987, -268.46698783837127, -210.60771089300135, -181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248], "episode_lengths": [166, 139, 399, 356, 399, 399, 228, 294, 399, 399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7476740923851449, "mean_inference_ms": 2.2962414218551213, "mean_action_processing_ms": 0.3448538263491109, "mean_env_wait_ms": 3.777026614944077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05373072624206543, "StateBufferConnector_ms": 0.011793851852416992, "ViewRequirementAgentConnector_ms": 0.23821258544921875}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.71184984082913, "num_env_steps_trained_throughput_per_sec": 341.71184984082913, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11222.406, "sample_time_ms": 382.478, "load_time_ms": 10.722, "load_throughput": 373069.932, "learn_time_ms": 10709.829, "learn_throughput": 373.489, "synch_weights_time_ms": 118.342}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 298, "training_iteration": 26, "trial_id": "default", "date": "2024-08-30_11-37-27", "timestamp": 1724989047, "time_this_iter_s": 12.283096551895142, "time_total_s": 308.79366517066956, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 308.79366517066956, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 13.118750000000002, "ram_util_percent": 14.3625, "gpu_util_percent0": 0.23249999999999998, "vram_util_percent0": 0.18547821044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.575017204528214, "policy_loss": -0.012696934372727429, "vf_loss": 2.5842001866909765, "vf_explained_var": 5.122153989730343e-07, "kl": 0.011713157237384728, "entropy": 4.178285279581623, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -187.88025836649666, "episode_len_mean": 367.34, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674], "episode_lengths": [399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7387875545104398, "mean_inference_ms": 2.2978508082680738, "mean_action_processing_ms": 0.34451806828408577, "mean_env_wait_ms": 3.775588401582736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05243420600891113, "StateBufferConnector_ms": 0.011449575424194336, "ViewRequirementAgentConnector_ms": 0.23343968391418457}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -187.88025836649666, "episode_len_mean": 367.34, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181.29451560034275, -187.9004126834701, -27.10622814414619, -241.68275163211564, -259.00098393349356, -209.10913999602562, -182.9510678767658, -165.4112890104707, -156.46260419015286, -212.66803020868707, -228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674], "episode_lengths": [399, 399, 121, 399, 336, 399, 399, 399, 399, 231, 302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7387875545104398, "mean_inference_ms": 2.2978508082680738, "mean_action_processing_ms": 0.34451806828408577, "mean_env_wait_ms": 3.775588401582736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05243420600891113, "StateBufferConnector_ms": 0.011449575424194336, "ViewRequirementAgentConnector_ms": 0.23343968391418457}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.00595538352206, "num_env_steps_trained_throughput_per_sec": 346.00595538352206, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11219.559, "sample_time_ms": 381.975, "load_time_ms": 10.029, "load_throughput": 398836.478, "learn_time_ms": 10710.771, "learn_throughput": 373.456, "synch_weights_time_ms": 115.774}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 307, "training_iteration": 27, "trial_id": "default", "date": "2024-08-30_11-37-40", "timestamp": 1724989060, "time_this_iter_s": 12.159184455871582, "time_total_s": 320.95284962654114, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 320.95284962654114, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.15, "ram_util_percent": 14.425, "gpu_util_percent0": 0.199375, "vram_util_percent0": 0.18097432454427084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5381424409727895, "policy_loss": -0.011655114416373513, "vf_loss": 2.545719140928279, "vf_explained_var": 5.3400634437479e-07, "kl": 0.013594732710356845, "entropy": 4.090358333690192, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -188.23468076223568, "episode_len_mean": 369.17, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377], "episode_lengths": [302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7384950761540756, "mean_inference_ms": 2.318196607589198, "mean_action_processing_ms": 0.34518492969494136, "mean_env_wait_ms": 3.749933700102295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051093101501464844, "StateBufferConnector_ms": 0.011501550674438477, "ViewRequirementAgentConnector_ms": 0.23235774040222168}}, "episode_reward_max": -1.6346468897485407, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -188.23468076223568, "episode_len_mean": 369.17, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-228.5614891445046, -234.7129691623506, -226.39439875989595, -217.62907792861282, -165.44859043967955, -1.6346468897485407, -211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377], "episode_lengths": [302, 294, 274, 399, 399, 9, 318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7384950761540756, "mean_inference_ms": 2.318196607589198, "mean_action_processing_ms": 0.34518492969494136, "mean_env_wait_ms": 3.749933700102295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051093101501464844, "StateBufferConnector_ms": 0.011501550674438477, "ViewRequirementAgentConnector_ms": 0.23235774040222168}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.9387127326793, "num_env_steps_trained_throughput_per_sec": 359.9387127326793, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11205.012, "sample_time_ms": 383.981, "load_time_ms": 10.077, "load_throughput": 396950.122, "learn_time_ms": 10692.399, "learn_throughput": 374.098, "synch_weights_time_ms": 117.547}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 317, "training_iteration": 28, "trial_id": "default", "date": "2024-08-30_11-37-51", "timestamp": 1724989071, "time_this_iter_s": 11.699455499649048, "time_total_s": 332.6523051261902, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 332.6523051261902, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.566666666666666, "ram_util_percent": 14.44, "gpu_util_percent0": 0.12466666666666665, "vram_util_percent0": 0.18174913194444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.536562159208841, "policy_loss": -0.010459867494195819, "vf_loss": 2.5425332692361646, "vf_explained_var": 5.709868605418872e-07, "kl": 0.014962520674234056, "entropy": 4.273379271517518, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -67.53188071743837, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -187.76796432578863, "episode_len_mean": 373.38, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756], "episode_lengths": [318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7354383518040436, "mean_inference_ms": 2.321268576755167, "mean_action_processing_ms": 0.3445786215268508, "mean_env_wait_ms": 3.7355820683788035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051638126373291016, "StateBufferConnector_ms": 0.011025428771972656, "ViewRequirementAgentConnector_ms": 0.23419713973999023}}, "episode_reward_max": -67.53188071743837, "episode_reward_min": -284.71382620726723, "episode_reward_mean": -187.76796432578863, "episode_len_mean": 373.38, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-211.40035021039813, -254.93231879341926, -284.71382620726723, -142.76418153937823, -198.21780850002995, -235.06560852656997, -219.770870521099, -185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756], "episode_lengths": [318, 399, 399, 399, 399, 320, 318, 399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7354383518040436, "mean_inference_ms": 2.321268576755167, "mean_action_processing_ms": 0.3445786215268508, "mean_env_wait_ms": 3.7355820683788035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051638126373291016, "StateBufferConnector_ms": 0.011025428771972656, "ViewRequirementAgentConnector_ms": 0.23419713973999023}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.59555337000035, "num_env_steps_trained_throughput_per_sec": 356.59555337000035, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11218.639, "sample_time_ms": 386.167, "load_time_ms": 13.526, "load_throughput": 295722.349, "learn_time_ms": 10699.591, "learn_throughput": 373.846, "synch_weights_time_ms": 118.297}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 323, "training_iteration": 29, "trial_id": "default", "date": "2024-08-30_11-38-03", "timestamp": 1724989083, "time_this_iter_s": 11.787065029144287, "time_total_s": 344.4393701553345, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 344.4393701553345, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.793333333333331, "ram_util_percent": 14.473333333333333, "gpu_util_percent0": 0.11666666666666668, "vram_util_percent0": 0.18183593750000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5888782537752584, "policy_loss": -0.014031670260573587, "vf_loss": 2.5984848865257795, "vf_explained_var": 4.823489855694514e-07, "kl": 0.01475008719009898, "entropy": 4.217673888001391, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -67.53188071743837, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -186.52869925334926, "episode_len_mean": 372.29, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998], "episode_lengths": [399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7310216094963309, "mean_inference_ms": 2.3033211087854784, "mean_action_processing_ms": 0.3445034215435894, "mean_env_wait_ms": 3.7576444749229387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05118918418884277, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.2342982292175293}}, "episode_reward_max": -67.53188071743837, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -186.52869925334926, "episode_len_mean": 372.29, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.93325951525026, -188.276585415641, -165.4300397234225, -212.28558326033584, -157.01764308606923, -178.60717701256334, -162.61132733546205, -226.05471732205143, -183.03755038452914, -229.8544643278058, -257.54122421720956, -253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998], "episode_lengths": [399, 326, 399, 293, 399, 399, 399, 342, 399, 358, 399, 251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7310216094963309, "mean_inference_ms": 2.3033211087854784, "mean_action_processing_ms": 0.3445034215435894, "mean_env_wait_ms": 3.7576444749229387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05118918418884277, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.2342982292175293}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.33974447050224, "num_env_steps_trained_throughput_per_sec": 356.33974447050224, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11229.261, "sample_time_ms": 387.757, "load_time_ms": 13.42, "load_throughput": 298057.084, "learn_time_ms": 10708.823, "learn_throughput": 373.524, "synch_weights_time_ms": 118.196}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 330, "training_iteration": 30, "trial_id": "default", "date": "2024-08-30_11-38-15", "timestamp": 1724989095, "time_this_iter_s": 11.813225984573364, "time_total_s": 356.25259613990784, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 356.25259613990784, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.20625, "ram_util_percent": 14.53125, "gpu_util_percent0": 0.17812499999999998, "vram_util_percent0": 0.18206278483072916}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6887437134981154, "policy_loss": -0.017350961470235418, "vf_loss": 2.700085313730342, "vf_explained_var": 6.480883526545699e-07, "kl": 0.020031176098955356, "entropy": 4.123013386162379, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -15.962436064171072, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -179.78830178751932, "episode_len_mean": 369.08, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856], "episode_lengths": [251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7199477568271988, "mean_inference_ms": 2.307060574218214, "mean_action_processing_ms": 0.3451148769225292, "mean_env_wait_ms": 3.7678988211710744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053373098373413086, "StateBufferConnector_ms": 0.01128387451171875, "ViewRequirementAgentConnector_ms": 0.23923540115356445}}, "episode_reward_max": -15.962436064171072, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -179.78830178751932, "episode_len_mean": 369.08, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.02775849312454, -160.66603366348556, -247.20768219510822, -130.45490190155462, -67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856], "episode_lengths": [251, 399, 399, 399, 194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7199477568271988, "mean_inference_ms": 2.307060574218214, "mean_action_processing_ms": 0.3451148769225292, "mean_env_wait_ms": 3.7678988211710744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053373098373413086, "StateBufferConnector_ms": 0.01128387451171875, "ViewRequirementAgentConnector_ms": 0.23923540115356445}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.1269055997217, "num_env_steps_trained_throughput_per_sec": 352.1269055997217, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11273.257, "sample_time_ms": 387.236, "load_time_ms": 13.328, "load_throughput": 300115.129, "learn_time_ms": 10752.229, "learn_throughput": 372.016, "synch_weights_time_ms": 119.379}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 341, "training_iteration": 31, "trial_id": "default", "date": "2024-08-30_11-38-27", "timestamp": 1724989107, "time_this_iter_s": 11.948654413223267, "time_total_s": 368.2012505531311, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 368.2012505531311, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 12.139999999999999, "ram_util_percent": 14.553333333333331, "gpu_util_percent0": 0.20533333333333337, "vram_util_percent0": 0.18142361111111108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.649786448014039, "policy_loss": -0.006044757833844551, "vf_loss": 2.6508288044121957, "vf_explained_var": 8.302991108227801e-07, "kl": 0.011116433662414972, "entropy": 4.158079556495912, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -15.962436064171072, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -179.82332556127147, "episode_len_mean": 369.2, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395], "episode_lengths": [194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7128595200210032, "mean_inference_ms": 2.3179090322484184, "mean_action_processing_ms": 0.34498131682707656, "mean_env_wait_ms": 3.7559287532187358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053529977798461914, "StateBufferConnector_ms": 0.011316537857055664, "ViewRequirementAgentConnector_ms": 0.23974990844726562}}, "episode_reward_max": -15.962436064171072, "episode_reward_min": -276.45323500191023, "episode_reward_mean": -179.82332556127147, "episode_len_mean": 369.2, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.53188071743837, -229.4210689589059, -116.92883883667585, -224.5028551181581, -195.68281701483843, -221.71147253338378, -250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395], "episode_lengths": [194, 399, 399, 240, 395, 399, 399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7128595200210032, "mean_inference_ms": 2.3179090322484184, "mean_action_processing_ms": 0.34498131682707656, "mean_env_wait_ms": 3.7559287532187358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053529977798461914, "StateBufferConnector_ms": 0.011316537857055664, "ViewRequirementAgentConnector_ms": 0.23974990844726562}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.99784753128085, "num_env_steps_trained_throughput_per_sec": 347.99784753128085, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11307.445, "sample_time_ms": 385.409, "load_time_ms": 13.291, "load_throughput": 300958.743, "learn_time_ms": 10788.849, "learn_throughput": 370.753, "synch_weights_time_ms": 118.815}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 345, "training_iteration": 32, "trial_id": "default", "date": "2024-08-30_11-38-39", "timestamp": 1724989119, "time_this_iter_s": 12.091784238815308, "time_total_s": 380.2930347919464, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 380.2930347919464, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 11.58125, "ram_util_percent": 14.618749999999999, "gpu_util_percent0": 0.213125, "vram_util_percent0": 0.18131001790364584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8428710452651464, "policy_loss": 0.0025500333767824917, "vf_loss": 2.8358118181587546, "vf_explained_var": 2.024186554775443e-06, "kl": 0.01002044203141654, "entropy": 4.168750619888305, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -15.962436064171072, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -179.87819077536915, "episode_len_mean": 369.37, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142], "episode_lengths": [399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7170587989034601, "mean_inference_ms": 2.31525571808204, "mean_action_processing_ms": 0.3447804655174036, "mean_env_wait_ms": 3.7423965646829873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05430340766906738, "StateBufferConnector_ms": 0.011344194412231445, "ViewRequirementAgentConnector_ms": 0.2397453784942627}}, "episode_reward_max": -15.962436064171072, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -179.87819077536915, "episode_len_mean": 369.37, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-250.76990673747932, -176.06958615339803, -224.99057760746078, -232.09934408188704, -150.29495496443977, -148.03249399912656, -213.6483480039547, -153.2380674026497, -198.38962974100298, -145.51708755068077, -230.21844413141065, -223.6789666440439, -154.85524992280557, -236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142], "episode_lengths": [399, 399, 323, 327, 399, 399, 317, 399, 399, 399, 399, 317, 399, 399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7170587989034601, "mean_inference_ms": 2.31525571808204, "mean_action_processing_ms": 0.3447804655174036, "mean_env_wait_ms": 3.7423965646829873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05430340766906738, "StateBufferConnector_ms": 0.011344194412231445, "ViewRequirementAgentConnector_ms": 0.2397453784942627}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.37911919291173, "num_env_steps_trained_throughput_per_sec": 357.37911919291173, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11317.563, "sample_time_ms": 380.498, "load_time_ms": 12.959, "load_throughput": 308660.599, "learn_time_ms": 10805.955, "learn_throughput": 370.166, "synch_weights_time_ms": 117.061}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 351, "training_iteration": 33, "trial_id": "default", "date": "2024-08-30_11-38-51", "timestamp": 1724989131, "time_this_iter_s": 11.755239009857178, "time_total_s": 392.0482738018036, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 392.0482738018036, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 13.113333333333335, "ram_util_percent": 14.680000000000001, "gpu_util_percent0": 0.21, "vram_util_percent0": 0.18149956597222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.746956633239664, "policy_loss": -0.018980513658795144, "vf_loss": 2.76020921231598, "vf_explained_var": 0.001057823819498862, "kl": 0.012728759278768613, "entropy": 4.2886148137430995, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.7979475968923, "episode_len_mean": 361.18, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472], "episode_lengths": [399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7175228147379943, "mean_inference_ms": 2.3082643253537203, "mean_action_processing_ms": 0.3449385900425016, "mean_env_wait_ms": 3.7339337192951696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05425691604614258, "StateBufferConnector_ms": 0.011330366134643555, "ViewRequirementAgentConnector_ms": 0.23864054679870605}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.7979475968923, "episode_len_mean": 361.18, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-236.83727916825896, -170.61904198133553, -210.73429526538135, -256.18601015468823, -171.54487735977813, -135.3858261440265, -211.73998441113173, -121.3674855844297, -219.36025601460204, -239.75880857731917, -128.4894858396637, -226.2652240196031, -144.15731997718353, -208.36856681779648, -166.88517645034955, -170.04646647232886, -208.55492391832203, -150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472], "episode_lengths": [399, 399, 399, 293, 399, 399, 270, 399, 399, 399, 399, 399, 399, 399, 399, 373, 396, 399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7175228147379943, "mean_inference_ms": 2.3082643253537203, "mean_action_processing_ms": 0.3449385900425016, "mean_env_wait_ms": 3.7339337192951696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05425691604614258, "StateBufferConnector_ms": 0.011330366134643555, "ViewRequirementAgentConnector_ms": 0.23864054679870605}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.9662674104383, "num_env_steps_trained_throughput_per_sec": 357.9662674104383, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11317.407, "sample_time_ms": 376.128, "load_time_ms": 12.963, "load_throughput": 308581.119, "learn_time_ms": 10807.62, "learn_throughput": 370.109, "synch_weights_time_ms": 119.633}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 364, "training_iteration": 34, "trial_id": "default", "date": "2024-08-30_11-39-03", "timestamp": 1724989143, "time_this_iter_s": 11.772103309631348, "time_total_s": 403.82037711143494, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 403.82037711143494, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.813333333333333, "ram_util_percent": 14.733333333333333, "gpu_util_percent0": 0.14933333333333332, "vram_util_percent0": 0.18109809027777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.925647282472221, "policy_loss": -0.015607540813144498, "vf_loss": 2.9341566430625097, "vf_explained_var": 0.004701151130019977, "kl": 0.015773713059838542, "entropy": 4.224258184432983, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -175.99051038048657, "episode_len_mean": 348.76, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7265716316672376, "mean_inference_ms": 2.3171437382697406, "mean_action_processing_ms": 0.34534597137654527, "mean_env_wait_ms": 3.7130381284317933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05560922622680664, "StateBufferConnector_ms": 0.011452436447143555, "ViewRequirementAgentConnector_ms": 0.24068450927734375}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -175.99051038048657, "episode_len_mean": 348.76, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150.35290668063334, -141.8823309040857, -138.0605998365737, -149.69513090788462, -154.1662055734377, -181.10365452661327, -202.8273333340818, -140.6692759789811, -213.71115311448338, -171.687862736651, -157.58670368850824, -182.38940634014637, -129.05644792085099, -185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 390, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7265716316672376, "mean_inference_ms": 2.3171437382697406, "mean_action_processing_ms": 0.34534597137654527, "mean_env_wait_ms": 3.7130381284317933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05560922622680664, "StateBufferConnector_ms": 0.011452436447143555, "ViewRequirementAgentConnector_ms": 0.24068450927734375}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.0017270351389, "num_env_steps_trained_throughput_per_sec": 351.0017270351389, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11343.764, "sample_time_ms": 379.541, "load_time_ms": 12.925, "load_throughput": 309488.484, "learn_time_ms": 10829.318, "learn_throughput": 369.368, "synch_weights_time_ms": 120.922}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 381, "training_iteration": 35, "trial_id": "default", "date": "2024-08-30_11-39-15", "timestamp": 1724989155, "time_this_iter_s": 11.977991342544556, "time_total_s": 415.7983684539795, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 415.7983684539795, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 10.387500000000001, "ram_util_percent": 14.76875, "gpu_util_percent0": 0.133125, "vram_util_percent0": 0.18151092529296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9233294686643028, "policy_loss": -0.015439983845878674, "vf_loss": 2.9331995899638823, "vf_explained_var": 0.014469527044603902, "kl": 0.012377478504867633, "entropy": 4.325171838780885, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.7961585603686, "episode_len_mean": 344.56, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424], "episode_lengths": [399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7372362863487458, "mean_inference_ms": 2.3225438831653684, "mean_action_processing_ms": 0.345352781586535, "mean_env_wait_ms": 3.6878716026847083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05580472946166992, "StateBufferConnector_ms": 0.011427164077758789, "ViewRequirementAgentConnector_ms": 0.24224114418029785}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.7961585603686, "episode_len_mean": 344.56, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.0568556343148, -202.74160668484518, -163.53221324442325, -144.2473144442248, -230.5478333349374, -228.44492510079039, -143.4693512875119, -193.10939223053504, -222.43657502402613, -178.34994285245685, -214.91748307155723, -217.809929053604, -183.45167711533674, -188.4580925378001, -219.3658128983083, -163.3740643874314, -187.28704268407807, -172.75905143714047, -162.89735021126648, -186.24340058693184, -187.1278114231633, -217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424], "episode_lengths": [399, 399, 399, 399, 399, 213, 399, 399, 399, 399, 364, 299, 399, 73, 399, 399, 399, 399, 399, 399, 399, 399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7372362863487458, "mean_inference_ms": 2.3225438831653684, "mean_action_processing_ms": 0.345352781586535, "mean_env_wait_ms": 3.6878716026847083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05580472946166992, "StateBufferConnector_ms": 0.011427164077758789, "ViewRequirementAgentConnector_ms": 0.24224114418029785}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.3171679958348, "num_env_steps_trained_throughput_per_sec": 351.3171679958348, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11311.76, "sample_time_ms": 377.401, "load_time_ms": 12.612, "load_throughput": 317150.24, "learn_time_ms": 10801.019, "learn_throughput": 370.335, "synch_weights_time_ms": 119.665}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 394, "training_iteration": 36, "trial_id": "default", "date": "2024-08-30_11-39-27", "timestamp": 1724989167, "time_this_iter_s": 12.011696100234985, "time_total_s": 427.8100645542145, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 427.8100645542145, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.51875, "ram_util_percent": 14.837500000000002, "gpu_util_percent0": 0.20187500000000003, "vram_util_percent0": 0.18131256103515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.807065714366974, "policy_loss": -0.0150527951227481, "vf_loss": 2.816483415551083, "vf_explained_var": 0.009466960225054014, "kl": 0.012522432991486263, "entropy": 4.2152514629466555, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -177.24375820819566, "episode_len_mean": 339.34, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409], "episode_lengths": [399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.735202555775605, "mean_inference_ms": 2.294662375678974, "mean_action_processing_ms": 0.345250601101177, "mean_env_wait_ms": 3.700301589875941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0550084114074707, "StateBufferConnector_ms": 0.011317253112792969, "ViewRequirementAgentConnector_ms": 0.24363946914672852}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -177.24375820819566, "episode_len_mean": 339.34, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-217.46653164865228, -174.05010503479377, -276.45323500191023, -189.7665194132325, -178.03356554414918, -129.55401563632515, -157.3257067630534, -96.57648632141756, -218.02735315088782, -236.93862757166295, -242.23191008559442, -146.67408588968246, -208.52551268614428, -159.05574632136572, -211.48522134888998, -131.01121464347816, -122.77191097189329, -203.386261258545, -130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409], "episode_lengths": [399, 399, 304, 198, 399, 399, 399, 399, 399, 399, 399, 399, 117, 399, 331, 399, 368, 329, 399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.735202555775605, "mean_inference_ms": 2.294662375678974, "mean_action_processing_ms": 0.345250601101177, "mean_env_wait_ms": 3.700301589875941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0550084114074707, "StateBufferConnector_ms": 0.011317253112792969, "ViewRequirementAgentConnector_ms": 0.24363946914672852}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.29374037816854, "num_env_steps_trained_throughput_per_sec": 357.29374037816854, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11275.235, "sample_time_ms": 378.979, "load_time_ms": 12.565, "load_throughput": 318350.828, "learn_time_ms": 10761.557, "learn_throughput": 371.693, "synch_weights_time_ms": 121.055}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 415, "training_iteration": 37, "trial_id": "default", "date": "2024-08-30_11-39-39", "timestamp": 1724989179, "time_this_iter_s": 11.777456998825073, "time_total_s": 439.58752155303955, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 439.58752155303955, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.26666666666667, "ram_util_percent": 14.873333333333335, "gpu_util_percent0": 0.17666666666666667, "vram_util_percent0": 0.18142632378472223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.533782523838423, "policy_loss": -0.056771837013663465, "vf_loss": 2.5859083517264296, "vf_explained_var": 0.018999515489865376, "kl": 0.010324465042550957, "entropy": 4.126928522253549, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.92920634928592, "episode_len_mean": 332.75, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822], "episode_lengths": [399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7334378910408665, "mean_inference_ms": 2.29222050427261, "mean_action_processing_ms": 0.3450114912475911, "mean_env_wait_ms": 3.7017969224328495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055075645446777344, "StateBufferConnector_ms": 0.011491060256958008, "ViewRequirementAgentConnector_ms": 0.24531126022338867}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -279.94367100759763, "episode_reward_mean": -178.92920634928592, "episode_len_mean": 332.75, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-130.61877110022513, -181.05950431209976, -166.75244211518356, -144.9633213208545, -15.962436064171072, -56.83925221281976, -183.78243139498338, -135.4622796230856, -152.8498203545528, -194.51146116713056, -251.33340799865255, -196.16406410815395, -279.94367100759763, -151.02395087039577, -137.1199030228368, -233.22279071522047, -179.20552167078867, -80.74961730233142, -218.95380966543692, -225.27586624383898, -202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822], "episode_lengths": [399, 389, 399, 399, 85, 226, 399, 399, 399, 282, 380, 399, 258, 399, 399, 289, 399, 299, 219, 360, 364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7334378910408665, "mean_inference_ms": 2.29222050427261, "mean_action_processing_ms": 0.3450114912475911, "mean_env_wait_ms": 3.7017969224328495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055075645446777344, "StateBufferConnector_ms": 0.011491060256958008, "ViewRequirementAgentConnector_ms": 0.24531126022338867}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.7286544038019, "num_env_steps_trained_throughput_per_sec": 359.7286544038019, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11275.885, "sample_time_ms": 379.043, "load_time_ms": 12.527, "load_throughput": 319302.67, "learn_time_ms": 10764.718, "learn_throughput": 371.584, "synch_weights_time_ms": 118.521}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 433, "training_iteration": 38, "trial_id": "default", "date": "2024-08-30_11-39-51", "timestamp": 1724989191, "time_this_iter_s": 11.704752683639526, "time_total_s": 451.2922742366791, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 451.2922742366791, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 12.613333333333333, "ram_util_percent": 14.913333333333334, "gpu_util_percent0": 0.17333333333333334, "vram_util_percent0": 0.18147786458333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.044118905323808, "policy_loss": -0.016003160443036787, "vf_loss": 3.0533656889712937, "vf_explained_var": 0.004480391099888791, "kl": 0.015014156802108021, "entropy": 4.010641583063269, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -2.068542423321433, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -179.9501455680222, "episode_len_mean": 335.71, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315], "episode_lengths": [364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221683781551217, "mean_inference_ms": 2.2697266777127187, "mean_action_processing_ms": 0.34497891450552665, "mean_env_wait_ms": 3.727693646960031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05109524726867676, "StateBufferConnector_ms": 0.011281490325927734, "ViewRequirementAgentConnector_ms": 0.24018287658691406}}, "episode_reward_max": -2.068542423321433, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -179.9501455680222, "episode_len_mean": 335.71, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-202.1261722266016, -203.61142487659922, -2.068542423321433, -211.07321731515725, -189.12551101526293, -177.550417991288, -135.91499077866257, -222.92858782513258, -205.61596709163905, -213.59574247017767, -185.93808916953472, -203.98199277709205, -142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315], "episode_lengths": [364, 262, 11, 297, 399, 399, 399, 273, 329, 345, 399, 399, 399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221683781551217, "mean_inference_ms": 2.2697266777127187, "mean_action_processing_ms": 0.34497891450552665, "mean_env_wait_ms": 3.727693646960031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05109524726867676, "StateBufferConnector_ms": 0.011281490325927734, "ViewRequirementAgentConnector_ms": 0.24018287658691406}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.84804887932216, "num_env_steps_trained_throughput_per_sec": 355.84804887932216, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11278.246, "sample_time_ms": 377.752, "load_time_ms": 9.051, "load_throughput": 441954.617, "learn_time_ms": 10773.317, "learn_throughput": 371.288, "synch_weights_time_ms": 117.079}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 453, "training_iteration": 39, "trial_id": "default", "date": "2024-08-30_11-40-02", "timestamp": 1724989202, "time_this_iter_s": 11.839501857757568, "time_total_s": 463.13177609443665, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 463.13177609443665, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.45625, "ram_util_percent": 14.86875, "gpu_util_percent0": 0.18375, "vram_util_percent0": 0.18170674641927084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.818624822875505, "policy_loss": -0.012069310320501205, "vf_loss": 2.8243602496321483, "vf_explained_var": 0.03660728784017665, "kl": 0.014075284474529326, "entropy": 3.9435612411909204, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -2.6601346880587586, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -176.58801330996917, "episode_len_mean": 334.49, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038], "episode_lengths": [399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236217898478624, "mean_inference_ms": 2.267441323707297, "mean_action_processing_ms": 0.34484732126758777, "mean_env_wait_ms": 3.729956062487084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0511021614074707, "StateBufferConnector_ms": 0.011383771896362305, "ViewRequirementAgentConnector_ms": 0.24248456954956055}}, "episode_reward_max": -2.6601346880587586, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -176.58801330996917, "episode_len_mean": 334.49, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142.09704140235246, -131.42852528437638, -200.4452953384693, -204.21647932191988, -2.6601346880587586, -186.70769628269278, -153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038], "episode_lengths": [399, 399, 399, 399, 13, 90, 399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236217898478624, "mean_inference_ms": 2.267441323707297, "mean_action_processing_ms": 0.34484732126758777, "mean_env_wait_ms": 3.729956062487084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0511021614074707, "StateBufferConnector_ms": 0.011383771896362305, "ViewRequirementAgentConnector_ms": 0.24248456954956055}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.33602081755475, "num_env_steps_trained_throughput_per_sec": 356.33602081755475, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11278.257, "sample_time_ms": 379.508, "load_time_ms": 9.083, "load_throughput": 440376.929, "learn_time_ms": 10774.106, "learn_throughput": 371.26, "synch_weights_time_ms": 114.504}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 465, "training_iteration": 40, "trial_id": "default", "date": "2024-08-30_11-40-14", "timestamp": 1724989214, "time_this_iter_s": 11.813007354736328, "time_total_s": 474.944783449173, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 474.944783449173, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 12.273333333333335, "ram_util_percent": 14.926666666666668, "gpu_util_percent0": 0.1633333333333333, "vram_util_percent0": 0.18126627604166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4790064321730725, "policy_loss": -0.010625723627976752, "vf_loss": 2.4833439607453602, "vf_explained_var": 0.08020054499308268, "kl": 0.01397379275301211, "entropy": 3.8553188718775266, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.9234884447439, "episode_len_mean": 339.01, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472], "episode_lengths": [399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7185664714051473, "mean_inference_ms": 2.2715556793819776, "mean_action_processing_ms": 0.3447468219194406, "mean_env_wait_ms": 3.723797156605761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05073857307434082, "StateBufferConnector_ms": 0.011426687240600586, "ViewRequirementAgentConnector_ms": 0.24392986297607422}}, "episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.9234884447439, "episode_len_mean": 339.01, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153.94155921152284, -172.85131740927528, -247.1867382797396, -236.3304024363674, -186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472], "episode_lengths": [399, 371, 223, 249, 126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7185664714051473, "mean_inference_ms": 2.2715556793819776, "mean_action_processing_ms": 0.3447468219194406, "mean_env_wait_ms": 3.723797156605761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05073857307434082, "StateBufferConnector_ms": 0.011426687240600586, "ViewRequirementAgentConnector_ms": 0.24392986297607422}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.33775544798675, "num_env_steps_trained_throughput_per_sec": 378.33775544798675, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11199.559, "sample_time_ms": 384.951, "load_time_ms": 9.537, "load_throughput": 419408.381, "learn_time_ms": 10685.536, "learn_throughput": 374.338, "synch_weights_time_ms": 118.481}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 471, "training_iteration": 41, "trial_id": "default", "date": "2024-08-30_11-40-26", "timestamp": 1724989226, "time_this_iter_s": 11.138840675354004, "time_total_s": 486.083624124527, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 486.083624124527, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 11.328571428571431, "ram_util_percent": 14.942857142857141, "gpu_util_percent0": 0.16071428571428573, "vram_util_percent0": 0.1811959402901786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4620707395897115, "policy_loss": -0.006955933111209062, "vf_loss": 2.463330794181875, "vf_explained_var": 0.11686881396078294, "kl": 0.012657533242224505, "entropy": 3.884714106590517, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.90968656103087, "episode_len_mean": 341.03, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942], "episode_lengths": [126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7181245262827567, "mean_inference_ms": 2.2696669861622554, "mean_action_processing_ms": 0.34482041734224, "mean_env_wait_ms": 3.7150255224750284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05098223686218262, "StateBufferConnector_ms": 0.011490583419799805, "ViewRequirementAgentConnector_ms": 0.24523687362670898}}, "episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.90968656103087, "episode_len_mean": 341.03, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186.09578802400625, -172.8935737058867, -149.3262633620028, -180.48958731996274, -197.1515426192409, -177.75336905265925, -206.70372334521414, -158.00197939556364, -177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942], "episode_lengths": [126, 399, 399, 399, 268, 346, 312, 399, 399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7181245262827567, "mean_inference_ms": 2.2696669861622554, "mean_action_processing_ms": 0.34482041734224, "mean_env_wait_ms": 3.7150255224750284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05098223686218262, "StateBufferConnector_ms": 0.011490583419799805, "ViewRequirementAgentConnector_ms": 0.24523687362670898}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.9422183178908, "num_env_steps_trained_throughput_per_sec": 362.9422183178908, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 11152.229, "sample_time_ms": 386.627, "load_time_ms": 9.517, "load_throughput": 420281.47, "learn_time_ms": 10635.202, "learn_throughput": 376.109, "synch_weights_time_ms": 119.831}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 475, "training_iteration": 42, "trial_id": "default", "date": "2024-08-30_11-40-37", "timestamp": 1724989237, "time_this_iter_s": 11.619591236114502, "time_total_s": 497.7032153606415, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 497.7032153606415, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 11.5625, "ram_util_percent": 14.9625, "gpu_util_percent0": 0.18875, "vram_util_percent0": 0.18181101481119794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.702792436653568, "policy_loss": -0.01599366169983661, "vf_loss": 2.712129060747803, "vf_explained_var": 0.08361832448231277, "kl": 0.01479341254547058, "entropy": 3.916928196466097, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -178.9301841285044, "episode_len_mean": 334.08, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542], "episode_lengths": [399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7163279892306333, "mean_inference_ms": 2.2682703479419626, "mean_action_processing_ms": 0.34416795936359695, "mean_env_wait_ms": 3.700786811562091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05096721649169922, "StateBufferConnector_ms": 0.011487245559692383, "ViewRequirementAgentConnector_ms": 0.24557805061340332}}, "episode_reward_max": -5.552892603533912, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -178.9301841285044, "episode_len_mean": 334.08, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-177.74902728873414, -215.50183450251066, -168.33347831495442, -168.04047790887006, -233.3083334338375, -211.35827075780537, -123.67880430850263, -177.88006616702873, -172.3393099749314, -152.61845354694708, -228.2400705862424, -162.72542623857353, -200.6411189525945, -205.74985045617336, -223.60366455731383, -212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542], "episode_lengths": [399, 399, 378, 355, 399, 289, 399, 399, 399, 399, 232, 399, 399, 308, 211, 399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7163279892306333, "mean_inference_ms": 2.2682703479419626, "mean_action_processing_ms": 0.34416795936359695, "mean_env_wait_ms": 3.700786811562091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05096721649169922, "StateBufferConnector_ms": 0.011487245559692383, "ViewRequirementAgentConnector_ms": 0.24557805061340332}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.074543826489, "num_env_steps_trained_throughput_per_sec": 357.074543826489, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 11153.183, "sample_time_ms": 385.907, "load_time_ms": 9.506, "load_throughput": 420791.661, "learn_time_ms": 10636.719, "learn_throughput": 376.056, "synch_weights_time_ms": 119.999}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 483, "training_iteration": 43, "trial_id": "default", "date": "2024-08-30_11-40-49", "timestamp": 1724989249, "time_this_iter_s": 11.781138896942139, "time_total_s": 509.4843542575836, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 509.4843542575836, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 12.219999999999997, "ram_util_percent": 15.033333333333331, "gpu_util_percent0": 0.19600000000000004, "vram_util_percent0": 0.18130154079861108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8563666859621644, "policy_loss": -0.009920530389713985, "vf_loss": 2.8610205235660717, "vf_explained_var": 0.07941062328636006, "kl": 0.011703760877329236, "entropy": 3.87533259161057, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.5396673778198, "episode_len_mean": 326.25, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879], "episode_lengths": [399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7162903809634149, "mean_inference_ms": 2.267929852856656, "mean_action_processing_ms": 0.34463624654900415, "mean_env_wait_ms": 3.697162026771218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05378317832946777, "StateBufferConnector_ms": 0.01230168342590332, "ViewRequirementAgentConnector_ms": 0.25542235374450684}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -266.62032033772863, "episode_reward_mean": -177.5396673778198, "episode_len_mean": 326.25, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-212.92808669456733, -196.212324337233, -195.0698558726658, -153.88503709866427, -266.62032033772863, -221.6220008494269, -163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879], "episode_lengths": [399, 325, 192, 399, 347, 399, 361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7162903809634149, "mean_inference_ms": 2.267929852856656, "mean_action_processing_ms": 0.34463624654900415, "mean_env_wait_ms": 3.697162026771218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05378317832946777, "StateBufferConnector_ms": 0.01230168342590332, "ViewRequirementAgentConnector_ms": 0.25542235374450684}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.03063333010687, "num_env_steps_trained_throughput_per_sec": 353.03063333010687, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 11168.806, "sample_time_ms": 385.375, "load_time_ms": 9.493, "load_throughput": 421348.589, "learn_time_ms": 10653.884, "learn_throughput": 375.45, "synch_weights_time_ms": 118.995}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 498, "training_iteration": 44, "trial_id": "default", "date": "2024-08-30_11-41-01", "timestamp": 1724989261, "time_this_iter_s": 11.92040205001831, "time_total_s": 521.4047563076019, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 521.4047563076019, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 11.833333333333336, "ram_util_percent": 15.153333333333334, "gpu_util_percent0": 0.20133333333333336, "vram_util_percent0": 0.1725911458333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.823325397955474, "policy_loss": -0.0102104954501634, "vf_loss": 2.827224992295747, "vf_explained_var": 0.16251255889092722, "kl": 0.01402423449745652, "entropy": 3.9510430018107097, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -176.5216710736939, "episode_len_mean": 325.06, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794], "episode_lengths": [361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7157549592479387, "mean_inference_ms": 2.2707981581340095, "mean_action_processing_ms": 0.34463676760880596, "mean_env_wait_ms": 3.6927063508495395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05405926704406738, "StateBufferConnector_ms": 0.012298107147216797, "ViewRequirementAgentConnector_ms": 0.25173521041870117}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -176.5216710736939, "episode_len_mean": 325.06, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-163.8052227075136, -153.48869728458234, -183.39586231115663, -184.9279200943791, -5.552892603533912, -201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794], "episode_lengths": [361, 399, 399, 399, 27, 399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7157549592479387, "mean_inference_ms": 2.2707981581340095, "mean_action_processing_ms": 0.34463676760880596, "mean_env_wait_ms": 3.6927063508495395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05405926704406738, "StateBufferConnector_ms": 0.012298107147216797, "ViewRequirementAgentConnector_ms": 0.25173521041870117}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.4711771955612, "num_env_steps_trained_throughput_per_sec": 363.4711771955612, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11129.708, "sample_time_ms": 386.124, "load_time_ms": 9.544, "load_throughput": 419106.64, "learn_time_ms": 10615.036, "learn_throughput": 376.824, "synch_weights_time_ms": 117.923}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 504, "training_iteration": 45, "trial_id": "default", "date": "2024-08-30_11-41-13", "timestamp": 1724989273, "time_this_iter_s": 11.648661136627197, "time_total_s": 533.0534174442291, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 533.0534174442291, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 10.63125, "ram_util_percent": 15.256250000000001, "gpu_util_percent0": 0.13937500000000003, "vram_util_percent0": 0.17033894856770831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7765613303389602, "policy_loss": -0.025746456958273406, "vf_loss": 2.7973719154634784, "vf_explained_var": 0.1372816922203187, "kl": 0.010968608561977093, "entropy": 3.9550320107449766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -180.61419879132754, "episode_len_mean": 328.12, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706], "episode_lengths": [399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7207965081649007, "mean_inference_ms": 2.2749330242491124, "mean_action_processing_ms": 0.34495095264789977, "mean_env_wait_ms": 3.693242508809068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05752134323120117, "StateBufferConnector_ms": 0.012484550476074219, "ViewRequirementAgentConnector_ms": 0.2557253837585449}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -180.61419879132754, "episode_len_mean": 328.12, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-201.34772780905715, -228.16998377990242, -198.14588502696984, -156.65627758200017, -154.24086380331028, -151.5986716300409, -215.5798979905657, -205.36803978451135, -239.54620874447772, -158.426509681197, -176.845270136238, -186.89880999666786, -153.6406545192225, -260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706], "episode_lengths": [399, 278, 373, 399, 399, 399, 399, 133, 399, 399, 399, 274, 375, 399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7207965081649007, "mean_inference_ms": 2.2749330242491124, "mean_action_processing_ms": 0.34495095264789977, "mean_env_wait_ms": 3.693242508809068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05752134323120117, "StateBufferConnector_ms": 0.012484550476074219, "ViewRequirementAgentConnector_ms": 0.2557253837585449}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.9703689185267, "num_env_steps_trained_throughput_per_sec": 357.9703689185267, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 11108.547, "sample_time_ms": 384.065, "load_time_ms": 9.146, "load_throughput": 437345.151, "learn_time_ms": 10595.595, "learn_throughput": 377.515, "synch_weights_time_ms": 118.676}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 509, "training_iteration": 46, "trial_id": "default", "date": "2024-08-30_11-41-25", "timestamp": 1724989285, "time_this_iter_s": 11.764450311660767, "time_total_s": 544.8178677558899, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 544.8178677558899, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 11.346666666666668, "ram_util_percent": 15.30666666666667, "gpu_util_percent0": 0.166, "vram_util_percent0": 0.167138671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9109469984167364, "policy_loss": -0.014323938464725851, "vf_loss": 2.9194803878184286, "vf_explained_var": 0.10002607716027126, "kl": 0.012867910431833156, "entropy": 3.876835151897964, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -178.63025975827182, "episode_len_mean": 321.87, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226], "episode_lengths": [399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7186649489802502, "mean_inference_ms": 2.2678490120144, "mean_action_processing_ms": 0.34468505296503366, "mean_env_wait_ms": 3.7019286947592853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05930519104003906, "StateBufferConnector_ms": 0.012585878372192383, "ViewRequirementAgentConnector_ms": 0.2579798698425293}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -178.63025975827182, "episode_len_mean": 321.87, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-260.98131205709643, -185.0185521133107, -180.18273639619875, -192.22267705257522, -74.49799937778499, -214.0573327988801, -192.27814235356954, -213.56260182519415, -193.13494705796336, -193.3794487254014, -232.25768278984822, -199.50138259497749, -194.38939063379846, -163.29188911305735, -207.0597311063823, -165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226], "episode_lengths": [399, 399, 399, 372, 205, 353, 351, 291, 380, 77, 172, 300, 399, 318, 295, 399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7186649489802502, "mean_inference_ms": 2.2678490120144, "mean_action_processing_ms": 0.34468505296503366, "mean_env_wait_ms": 3.7019286947592853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05930519104003906, "StateBufferConnector_ms": 0.012585878372192383, "ViewRequirementAgentConnector_ms": 0.2579798698425293}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.9862092865105, "num_env_steps_trained_throughput_per_sec": 360.9862092865105, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 11097.098, "sample_time_ms": 383.636, "load_time_ms": 9.125, "load_throughput": 438369.038, "learn_time_ms": 10584.1, "learn_throughput": 377.925, "synch_weights_time_ms": 119.19}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 522, "training_iteration": 47, "trial_id": "default", "date": "2024-08-30_11-41-36", "timestamp": 1724989296, "time_this_iter_s": 11.657951831817627, "time_total_s": 556.4758195877075, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 556.4758195877075, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.726666666666665, "ram_util_percent": 15.360000000000003, "gpu_util_percent0": 0.12133333333333333, "vram_util_percent0": 0.16632215711805554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7155801030737097, "policy_loss": -0.01416611014514841, "vf_loss": 2.7234339419552076, "vf_explained_var": 0.08462758256543067, "kl": 0.014027245096757167, "entropy": 3.8663394930542156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -177.25499514675903, "episode_len_mean": 331.01, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7225774918143577, "mean_inference_ms": 2.254118010393314, "mean_action_processing_ms": 0.34437322867434367, "mean_env_wait_ms": 3.6952818726494336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05980706214904785, "StateBufferConnector_ms": 0.012670516967773438, "ViewRequirementAgentConnector_ms": 0.259706974029541}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -177.25499514675903, "episode_len_mean": 331.01, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-165.0733343515835, -171.09767531965747, -111.31976639923222, -199.00236948478374, -148.06819204328764, -99.56794001480328, -172.13491780521943, -207.0257337882704, -164.20500599400836, -174.85442857667982, -190.2958725897642, -174.37035369587065, -186.67331740920744, -120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 130, 399, 399, 399, 399, 45, 399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7225774918143577, "mean_inference_ms": 2.254118010393314, "mean_action_processing_ms": 0.34437322867434367, "mean_env_wait_ms": 3.6952818726494336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05980706214904785, "StateBufferConnector_ms": 0.012670516967773438, "ViewRequirementAgentConnector_ms": 0.259706974029541}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.9190818552458, "num_env_steps_trained_throughput_per_sec": 395.9190818552458, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 10995.456, "sample_time_ms": 382.916, "load_time_ms": 9.225, "load_throughput": 433592.619, "learn_time_ms": 10482.549, "learn_throughput": 381.587, "synch_weights_time_ms": 119.714}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 537, "training_iteration": 48, "trial_id": "default", "date": "2024-08-30_11-41-47", "timestamp": 1724989307, "time_this_iter_s": 10.68174433708191, "time_total_s": 567.1575639247894, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 567.1575639247894, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 11.428571428571429, "ram_util_percent": 15.442857142857141, "gpu_util_percent0": 0.16785714285714284, "vram_util_percent0": 0.1672217959449405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.810352389658651, "policy_loss": -0.01480229844249064, "vf_loss": 2.8194813421977463, "vf_explained_var": 0.050698963608793036, "kl": 0.012607449123458136, "entropy": 3.7488748881124683, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -178.6755041841191, "episode_len_mean": 332.71, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552, -199.75900261825055, -136.88397177296287, -225.75751905242655, -229.8849158382205, -205.99072249343598, -199.6177428823189, -200.22358799571802, -218.20894034448082, -186.39197594430638, -104.56926911110928, -156.18592611912925, -93.10811422918722, -149.1581228068303], "episode_lengths": [399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399, 399, 399, 297, 399, 284, 399, 399, 253, 399, 399, 399, 309, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7297762133624583, "mean_inference_ms": 2.2672056488617733, "mean_action_processing_ms": 0.34464260007859865, "mean_env_wait_ms": 3.6756950780324416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06096959114074707, "StateBufferConnector_ms": 0.012741327285766602, "ViewRequirementAgentConnector_ms": 0.26128196716308594}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -178.6755041841191, "episode_len_mean": 332.71, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-120.2747746785308, -209.15191198373518, -160.5302565611315, -206.0151453947865, -170.65012320651226, -173.4980604335337, -28.39520239023011, -176.59042738863883, -196.7557560233223, -150.97649485655245, -191.21558597722168, -45.40011501129648, -189.0539928106439, -104.28828349462079, -184.47824316781038, -186.4768125048625, -197.86516238240986, -122.84143492463807, -124.64964307438234, -217.70614941940045, -151.5634834896472, -209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552, -199.75900261825055, -136.88397177296287, -225.75751905242655, -229.8849158382205, -205.99072249343598, -199.6177428823189, -200.22358799571802, -218.20894034448082, -186.39197594430638, -104.56926911110928, -156.18592611912925, -93.10811422918722, -149.1581228068303], "episode_lengths": [399, 399, 399, 106, 399, 321, 98, 339, 399, 343, 399, 201, 399, 351, 399, 308, 330, 399, 399, 316, 399, 247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399, 399, 399, 297, 399, 284, 399, 399, 253, 399, 399, 399, 309, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7297762133624583, "mean_inference_ms": 2.2672056488617733, "mean_action_processing_ms": 0.34464260007859865, "mean_env_wait_ms": 3.6756950780324416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06096959114074707, "StateBufferConnector_ms": 0.012741327285766602, "ViewRequirementAgentConnector_ms": 0.26128196716308594}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.53685531620005, "num_env_steps_trained_throughput_per_sec": 357.53685531620005, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 10990.143, "sample_time_ms": 387.783, "load_time_ms": 9.25, "load_throughput": 432415.848, "learn_time_ms": 10471.495, "learn_throughput": 381.989, "synch_weights_time_ms": 120.544}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 550, "training_iteration": 49, "trial_id": "default", "date": "2024-08-30_11-41-59", "timestamp": 1724989319, "time_this_iter_s": 11.76543402671814, "time_total_s": 578.9229979515076, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 578.9229979515076, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 14.093333333333332, "ram_util_percent": 15.406666666666668, "gpu_util_percent0": 0.2, "vram_util_percent0": 0.16661512586805555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8490692669345488, "policy_loss": -0.009487582908402528, "vf_loss": 2.8509253316028142, "vf_explained_var": 0.06580447061087495, "kl": 0.01695893213818831, "entropy": 3.708858734561551, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -183.15412684625227, "episode_len_mean": 332.78, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552, -199.75900261825055, -136.88397177296287, -225.75751905242655, -229.8849158382205, -205.99072249343598, -199.6177428823189, -200.22358799571802, -218.20894034448082, -186.39197594430638, -104.56926911110928, -156.18592611912925, -93.10811422918722, -149.1581228068303, -178.78673376030895, -168.782967489374, -186.87775843667035, -219.88705884849534, -205.7063385848352, -190.33715296022712, -188.3552597042037, -179.85327318921435, -156.8581162123359, -191.36393066732623, -185.10955873619773, -184.70589742660783, -143.6291489849301, -210.3023608604384, -196.75735598379742, -188.9089763397417, -152.2521747569469, -151.93675277838943, -179.18821485873926, -148.3048969933234, -148.33539781512172], "episode_lengths": [247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399, 399, 399, 297, 399, 284, 399, 399, 253, 399, 399, 399, 309, 399, 310, 399, 100, 228, 399, 399, 331, 399, 397, 399, 80, 399, 399, 296, 180, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7285245093511012, "mean_inference_ms": 2.255607649694483, "mean_action_processing_ms": 0.34474909702264983, "mean_env_wait_ms": 3.673528212755004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060674190521240234, "StateBufferConnector_ms": 0.012749195098876953, "ViewRequirementAgentConnector_ms": 0.25754380226135254}}, "episode_reward_max": -1.8577890486164117, "episode_reward_min": -261.89309519577773, "episode_reward_mean": -183.15412684625227, "episode_len_mean": 332.78, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-209.98936580668988, -208.71744548544726, -189.06217651339733, -201.16084116006942, -159.2830729282509, -201.4221466130279, -248.3518638230208, -173.98690857941452, -200.58859184513605, -221.92027994110987, -114.8396386312755, -210.0730812106542, -180.941600315173, -188.2588280021991, -173.3745213746844, -211.11663457299596, -261.89309519577773, -240.68627308337597, -135.9228499124908, -136.86637554317437, -186.27091640887892, -119.2887466758898, -1.8577890486164117, -212.60856025699007, -249.82507348688353, -169.71523214473825, -214.0900159046879, -224.9412747313391, -159.3202294897973, -133.7649723077703, -187.92275450175103, -223.01107143311424, -215.57769231392794, -238.21076971246777, -226.769756904942, -201.7835224165988, -198.19695776699544, -235.46235996352706, -204.31873581072213, -155.38126567650377, -214.98459462914403, -187.80192957918834, -96.9993723202318, -205.7124197789917, -16.62961298425314, -225.79588494140745, -182.12126426759792, -180.2485940891848, -173.84421755707177, -172.00020763832532, -212.23279790596226, -156.26052033176978, -148.10326846503878, -151.05211043434718, -230.25891890369823, -202.7893953216929, -226.49082475279505, -188.79655095698317, -219.3287068504764, -215.73671472673522, -125.11226818353562, -119.13350552685718, -228.4603506469254, -173.88434501606085, -180.72490583662892, -192.15697889121552, -199.75900261825055, -136.88397177296287, -225.75751905242655, -229.8849158382205, -205.99072249343598, -199.6177428823189, -200.22358799571802, -218.20894034448082, -186.39197594430638, -104.56926911110928, -156.18592611912925, -93.10811422918722, -149.1581228068303, -178.78673376030895, -168.782967489374, -186.87775843667035, -219.88705884849534, -205.7063385848352, -190.33715296022712, -188.3552597042037, -179.85327318921435, -156.8581162123359, -191.36393066732623, -185.10955873619773, -184.70589742660783, -143.6291489849301, -210.3023608604384, -196.75735598379742, -188.9089763397417, -152.2521747569469, -151.93675277838943, -179.18821485873926, -148.3048969933234, -148.33539781512172], "episode_lengths": [247, 399, 399, 399, 399, 183, 224, 395, 109, 186, 308, 149, 315, 399, 399, 214, 273, 253, 399, 399, 219, 399, 9, 229, 399, 399, 276, 336, 327, 399, 346, 304, 230, 399, 399, 399, 295, 399, 399, 399, 335, 399, 393, 347, 79, 246, 399, 245, 55, 399, 305, 399, 399, 399, 399, 399, 290, 399, 266, 285, 399, 399, 399, 399, 394, 399, 399, 399, 297, 399, 284, 399, 399, 253, 399, 399, 399, 309, 399, 310, 399, 100, 228, 399, 399, 331, 399, 397, 399, 80, 399, 399, 296, 180, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7285245093511012, "mean_inference_ms": 2.255607649694483, "mean_action_processing_ms": 0.34474909702264983, "mean_env_wait_ms": 3.673528212755004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060674190521240234, "StateBufferConnector_ms": 0.012749195098876953, "ViewRequirementAgentConnector_ms": 0.25754380226135254}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.4689293660128, "num_env_steps_trained_throughput_per_sec": 384.4689293660128, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 10908.001, "sample_time_ms": 386.673, "load_time_ms": 9.242, "load_throughput": 432788.414, "learn_time_ms": 10383.55, "learn_throughput": 385.225, "synch_weights_time_ms": 127.445}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 571, "training_iteration": 50, "trial_id": "default", "date": "2024-08-30_11-42-10", "timestamp": 1724989330, "time_this_iter_s": 10.957932233810425, "time_total_s": 589.880930185318, "pid": 10612, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa2f964d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 589.880930185318, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 13.014285714285716, "ram_util_percent": 15.428571428571429, "gpu_util_percent0": 0.19357142857142856, "vram_util_percent0": 0.1667858305431548}}
