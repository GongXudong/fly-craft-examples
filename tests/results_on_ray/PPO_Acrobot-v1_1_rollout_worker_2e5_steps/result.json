{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.973804454393285, "policy_loss": 0.013257881586429893, "vf_loss": 9.958547593188543, "vf_explained_var": 0.020375847880558302, "kl": 0.009994926844240248, "entropy": 1.0883924941862784, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -500.0, "episode_reward_min": -500.0, "episode_reward_mean": -500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20275185090903788, "mean_inference_ms": 0.8024362527379629, "mean_action_processing_ms": 0.0905756412878897, "mean_env_wait_ms": 0.1323737969430677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008362531661987305, "StateBufferConnector_ms": 0.004023313522338867, "ViewRequirementAgentConnector_ms": 0.08119642734527588}}, "episode_reward_max": -500.0, "episode_reward_min": -500.0, "episode_reward_mean": -500.0, "episode_len_mean": 500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20275185090903788, "mean_inference_ms": 0.8024362527379629, "mean_action_processing_ms": 0.0905756412878897, "mean_env_wait_ms": 0.1323737969430677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008362531661987305, "StateBufferConnector_ms": 0.004023313522338867, "ViewRequirementAgentConnector_ms": 0.08119642734527588}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.14918300206574, "num_env_steps_trained_throughput_per_sec": 270.14918300206574, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14806.553, "sample_time_ms": 4960.517, "load_time_ms": 2.796, "load_throughput": 1430526.603, "learn_time_ms": 9811.266, "learn_throughput": 407.695, "synch_weights_time_ms": 30.016}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "default", "date": "2024-08-30_12-36-20", "timestamp": 1724992580, "time_this_iter_s": 14.812894582748413, "time_total_s": 14.812894582748413, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14.812894582748413, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.55, "ram_util_percent": 9.094999999999999, "gpu_util_percent0": 0.17050000000000004, "vram_util_percent0": 0.16368815104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.925621269595238, "policy_loss": 0.010748547069247692, "vf_loss": 9.912827612764092, "vf_explained_var": -0.050040580893075594, "kl": 0.010225428783576499, "entropy": 1.0630814967616913, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -273.0, "episode_reward_min": -500.0, "episode_reward_mean": -465.11764705882354, "episode_len_mean": 465.3529411764706, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20298925042184096, "mean_inference_ms": 0.8052744113183843, "mean_action_processing_ms": 0.0902366982196195, "mean_env_wait_ms": 0.13181502405970666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006957615123075598, "StateBufferConnector_ms": 0.003995614893296186, "ViewRequirementAgentConnector_ms": 0.0817102544447955}}, "episode_reward_max": -273.0, "episode_reward_min": -500.0, "episode_reward_mean": -465.11764705882354, "episode_len_mean": 465.3529411764706, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20298925042184096, "mean_inference_ms": 0.8052744113183843, "mean_action_processing_ms": 0.0902366982196195, "mean_env_wait_ms": 0.13181502405970666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006957615123075598, "StateBufferConnector_ms": 0.003995614893296186, "ViewRequirementAgentConnector_ms": 0.0817102544447955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.79070753193633, "num_env_steps_trained_throughput_per_sec": 269.79070753193633, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14816.409, "sample_time_ms": 4975.351, "load_time_ms": 2.736, "load_throughput": 1462003.05, "learn_time_ms": 9820.722, "learn_throughput": 407.302, "synch_weights_time_ms": 16.228}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 17, "training_iteration": 2, "trial_id": "default", "date": "2024-08-30_12-36-35", "timestamp": 1724992595, "time_this_iter_s": 14.83240294456482, "time_total_s": 29.645297527313232, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 29.645297527313232, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 6.163157894736843, "ram_util_percent": 9.1, "gpu_util_percent0": 0.19631578947368422, "vram_util_percent0": 0.1625462582236842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.920551760478686, "policy_loss": 0.011590456994630956, "vf_loss": 9.90797844343288, "vf_explained_var": 0.03956428830341626, "kl": 0.004914275993839366, "entropy": 1.0514436601310648, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -229.0, "episode_reward_min": -500.0, "episode_reward_mean": -436.14814814814815, "episode_len_mean": 436.5925925925926, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20230650374366432, "mean_inference_ms": 0.8039804303481427, "mean_action_processing_ms": 0.08991251856140156, "mean_env_wait_ms": 0.1314217598926054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005809466044108073, "StateBufferConnector_ms": 0.0039047665066189235, "ViewRequirementAgentConnector_ms": 0.08080976980703848}}, "episode_reward_max": -229.0, "episode_reward_min": -500.0, "episode_reward_mean": -436.14814814814815, "episode_len_mean": 436.5925925925926, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20230650374366432, "mean_inference_ms": 0.8039804303481427, "mean_action_processing_ms": 0.08991251856140156, "mean_env_wait_ms": 0.1314217598926054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005809466044108073, "StateBufferConnector_ms": 0.0039047665066189235, "ViewRequirementAgentConnector_ms": 0.08080976980703848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.67949639929384, "num_env_steps_trained_throughput_per_sec": 272.67949639929384, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14767.332, "sample_time_ms": 4937.801, "load_time_ms": 2.919, "load_throughput": 1370463.65, "learn_time_ms": 9813.927, "learn_throughput": 407.584, "synch_weights_time_ms": 11.51}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 27, "training_iteration": 3, "trial_id": "default", "date": "2024-08-30_12-36-50", "timestamp": 1724992610, "time_this_iter_s": 14.675338983535767, "time_total_s": 44.320636510849, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.320636510849, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.794736842105264, "ram_util_percent": 9.1, "gpu_util_percent0": 0.20842105263157892, "vram_util_percent0": 0.16226356907894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.889358904028452, "policy_loss": 0.004965123479124359, "vf_loss": 9.882801844484062, "vf_explained_var": -0.010532605904404834, "kl": 0.01591952062717083, "entropy": 1.005180948908611, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -229.0, "episode_reward_min": -500.0, "episode_reward_mean": -403.0769230769231, "episode_len_mean": 403.64102564102564, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20182255719966163, "mean_inference_ms": 0.8028321980113896, "mean_action_processing_ms": 0.08968539733447395, "mean_env_wait_ms": 0.1311715266502988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005588164696326623, "StateBufferConnector_ms": 0.0038758302346254005, "ViewRequirementAgentConnector_ms": 0.08072914221347907}}, "episode_reward_max": -229.0, "episode_reward_min": -500.0, "episode_reward_mean": -403.0769230769231, "episode_len_mean": 403.64102564102564, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20182255719966163, "mean_inference_ms": 0.8028321980113896, "mean_action_processing_ms": 0.08968539733447395, "mean_env_wait_ms": 0.1311715266502988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005588164696326623, "StateBufferConnector_ms": 0.0038758302346254005, "ViewRequirementAgentConnector_ms": 0.08072914221347907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.88961265252004, "num_env_steps_trained_throughput_per_sec": 272.88961265252004, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14739.974, "sample_time_ms": 4928.436, "load_time_ms": 2.876, "load_throughput": 1390770.812, "learn_time_ms": 9798.409, "learn_throughput": 408.23, "synch_weights_time_ms": 9.178}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 39, "training_iteration": 4, "trial_id": "default", "date": "2024-08-30_12-37-04", "timestamp": 1724992624, "time_this_iter_s": 14.663981199264526, "time_total_s": 58.984617710113525, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.984617710113525, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 6.705263157894737, "ram_util_percent": 9.1, "gpu_util_percent0": 0.2236842105263158, "vram_util_percent0": 0.16222073739035084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.809042015896049, "policy_loss": 0.006238743021924008, "vf_loss": 9.801689373549594, "vf_explained_var": 0.05574777151948662, "kl": 0.011138950564024828, "entropy": 0.9520225179451768, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -158.0, "episode_reward_min": -500.0, "episode_reward_mean": -354.60714285714283, "episode_len_mean": 355.2857142857143, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2014175637536248, "mean_inference_ms": 0.801521528180538, "mean_action_processing_ms": 0.08947419502140996, "mean_env_wait_ms": 0.1309145381132159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005081721714564732, "StateBufferConnector_ms": 0.0038483313151768278, "ViewRequirementAgentConnector_ms": 0.08049138954707555}}, "episode_reward_max": -158.0, "episode_reward_min": -500.0, "episode_reward_mean": -354.60714285714283, "episode_len_mean": 355.2857142857143, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2014175637536248, "mean_inference_ms": 0.801521528180538, "mean_action_processing_ms": 0.08947419502140996, "mean_env_wait_ms": 0.1309145381132159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005081721714564732, "StateBufferConnector_ms": 0.0038483313151768278, "ViewRequirementAgentConnector_ms": 0.08049138954707555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.2065930745382, "num_env_steps_trained_throughput_per_sec": 272.2065930745382, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14730.903, "sample_time_ms": 4918.417, "load_time_ms": 2.896, "load_throughput": 1381022.686, "learn_time_ms": 9795.006, "learn_throughput": 408.371, "synch_weights_time_ms": 13.451}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 56, "training_iteration": 5, "trial_id": "default", "date": "2024-08-30_12-37-19", "timestamp": 1724992639, "time_this_iter_s": 14.701671838760376, "time_total_s": 73.6862895488739, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 73.6862895488739, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 6.378947368421052, "ram_util_percent": 9.1, "gpu_util_percent0": 0.1931578947368421, "vram_util_percent0": 0.1624134799890351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.752604440463486, "policy_loss": 0.0014903672720475863, "vf_loss": 9.749836916564613, "vf_explained_var": 0.12608763261507916, "kl": 0.012771617799457036, "entropy": 0.8789146153516667, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -104.0, "episode_reward_min": -500.0, "episode_reward_mean": -308.7402597402597, "episode_len_mean": 309.5064935064935, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20082753582495771, "mean_inference_ms": 0.7992324782760815, "mean_action_processing_ms": 0.08914623505030177, "mean_env_wait_ms": 0.13048691970779716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004842993500944856, "StateBufferConnector_ms": 0.0038054082300755885, "ViewRequirementAgentConnector_ms": 0.07925374167306083}}, "episode_reward_max": -104.0, "episode_reward_min": -500.0, "episode_reward_mean": -308.7402597402597, "episode_len_mean": 309.5064935064935, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20082753582495771, "mean_inference_ms": 0.7992324782760815, "mean_action_processing_ms": 0.08914623505030177, "mean_env_wait_ms": 0.13048691970779716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004842993500944856, "StateBufferConnector_ms": 0.0038054082300755885, "ViewRequirementAgentConnector_ms": 0.07925374167306083}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.2469233272006, "num_env_steps_trained_throughput_per_sec": 278.2469233272006, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14671.699, "sample_time_ms": 4884.954, "load_time_ms": 2.87, "load_throughput": 1393687.988, "learn_time_ms": 9771.247, "learn_throughput": 409.364, "synch_weights_time_ms": 11.556}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 77, "training_iteration": 6, "trial_id": "default", "date": "2024-08-30_12-37-34", "timestamp": 1724992654, "time_this_iter_s": 14.382925748825073, "time_total_s": 88.06921529769897, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 88.06921529769897, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 4.73888888888889, "ram_util_percent": 9.1, "gpu_util_percent0": 0.095, "vram_util_percent0": 0.16316279658564817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.689729297802012, "policy_loss": 0.0018122881160227843, "vf_loss": 9.687149122709869, "vf_explained_var": 0.11340633701252681, "kl": 0.007678879992391245, "entropy": 0.8285498272988104, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -102.0, "episode_reward_min": -500.0, "episode_reward_mean": -262.88, "episode_len_mean": 263.73, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20054344018579834, "mean_inference_ms": 0.7990244710527111, "mean_action_processing_ms": 0.08891180449082622, "mean_env_wait_ms": 0.1301532642921555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004575252532958984, "StateBufferConnector_ms": 0.0038378238677978516, "ViewRequirementAgentConnector_ms": 0.07979226112365723}}, "episode_reward_max": -102.0, "episode_reward_min": -500.0, "episode_reward_mean": -262.88, "episode_len_mean": 263.73, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -500.0, -362.0, -329.0, -500.0, -273.0, -443.0, -500.0, -500.0, -500.0, -236.0, -442.0, -255.0, -229.0, -310.0, -443.0, -462.0, -500.0, -492.0, -308.0, -309.0, -281.0, -235.0, -269.0, -238.0, -334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 363, 330, 500, 274, 444, 500, 500, 500, 237, 443, 256, 230, 311, 444, 463, 500, 493, 309, 310, 282, 236, 270, 239, 335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20054344018579834, "mean_inference_ms": 0.7990244710527111, "mean_action_processing_ms": 0.08891180449082622, "mean_env_wait_ms": 0.1301532642921555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004575252532958984, "StateBufferConnector_ms": 0.0038378238677978516, "ViewRequirementAgentConnector_ms": 0.07979226112365723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.77814183414364, "num_env_steps_trained_throughput_per_sec": 270.77814183414364, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 14686.056, "sample_time_ms": 4911.277, "load_time_ms": 2.886, "load_throughput": 1385826.867, "learn_time_ms": 9760.608, "learn_throughput": 409.811, "synch_weights_time_ms": 10.244}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 103, "training_iteration": 7, "trial_id": "default", "date": "2024-08-30_12-37-48", "timestamp": 1724992668, "time_this_iter_s": 14.780384063720703, "time_total_s": 102.84959936141968, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.84959936141968, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 5.973684210526316, "ram_util_percent": 9.1, "gpu_util_percent0": 0.16578947368421054, "vram_util_percent0": 0.16300455729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.641947406850836, "policy_loss": 0.00318288954515611, "vf_loss": 9.637802315783757, "vf_explained_var": 0.11030797214918239, "kl": 0.00962196675648816, "entropy": 0.7652545632854585, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -94.0, "episode_reward_min": -500.0, "episode_reward_mean": -183.78, "episode_len_mean": 184.75, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0], "episode_lengths": [335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034557592354146, "mean_inference_ms": 0.7983424369308488, "mean_action_processing_ms": 0.08860977372754196, "mean_env_wait_ms": 0.1297817130430439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004294395446777344, "StateBufferConnector_ms": 0.003857135772705078, "ViewRequirementAgentConnector_ms": 0.08058524131774902}}, "episode_reward_max": -94.0, "episode_reward_min": -500.0, "episode_reward_mean": -183.78, "episode_len_mean": 184.75, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-334.0, -500.0, -500.0, -316.0, -389.0, -265.0, -297.0, -217.0, -180.0, -500.0, -232.0, -305.0, -215.0, -205.0, -290.0, -242.0, -158.0, -241.0, -276.0, -232.0, -178.0, -204.0, -166.0, -217.0, -104.0, -187.0, -179.0, -176.0, -142.0, -169.0, -350.0, -198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0], "episode_lengths": [335, 500, 500, 317, 390, 266, 298, 218, 181, 500, 233, 306, 216, 206, 291, 243, 159, 242, 277, 233, 179, 205, 167, 218, 105, 188, 180, 177, 143, 170, 351, 199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034557592354146, "mean_inference_ms": 0.7983424369308488, "mean_action_processing_ms": 0.08860977372754196, "mean_env_wait_ms": 0.1297817130430439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004294395446777344, "StateBufferConnector_ms": 0.003857135772705078, "ViewRequirementAgentConnector_ms": 0.08058524131774902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.4657057382614, "num_env_steps_trained_throughput_per_sec": 270.4657057382614, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14698.956, "sample_time_ms": 4929.146, "load_time_ms": 2.873, "load_throughput": 1392256.755, "learn_time_ms": 9756.63, "learn_throughput": 409.978, "synch_weights_time_ms": 9.266}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 133, "training_iteration": 8, "trial_id": "default", "date": "2024-08-30_12-38-03", "timestamp": 1724992683, "time_this_iter_s": 14.796686172485352, "time_total_s": 117.64628553390503, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.64628553390503, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 6.747368421052633, "ram_util_percent": 9.1, "gpu_util_percent0": 0.19894736842105265, "vram_util_percent0": 0.16222073739035087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.61732957388765, "policy_loss": -0.0009115574280581166, "vf_loss": 9.6171830320871, "vf_explained_var": 0.07808500220698696, "kl": 0.01058124068833173, "entropy": 0.7089230928369747, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -94.0, "episode_reward_min": -254.0, "episode_reward_mean": -143.16, "episode_len_mean": 144.16, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0, -112.0, -120.0, -145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0], "episode_lengths": [199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122, 113, 121, 146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20068679840950104, "mean_inference_ms": 0.7991022449908924, "mean_action_processing_ms": 0.08855060385562251, "mean_env_wait_ms": 0.1297043099477638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238128662109375, "StateBufferConnector_ms": 0.00390934944152832, "ViewRequirementAgentConnector_ms": 0.08062577247619629}}, "episode_reward_max": -94.0, "episode_reward_min": -254.0, "episode_reward_mean": -143.16, "episode_len_mean": 144.16, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-198.0, -203.0, -146.0, -172.0, -167.0, -195.0, -208.0, -177.0, -209.0, -221.0, -174.0, -129.0, -192.0, -254.0, -133.0, -174.0, -167.0, -139.0, -102.0, -206.0, -131.0, -151.0, -165.0, -153.0, -133.0, -143.0, -166.0, -175.0, -131.0, -133.0, -124.0, -120.0, -152.0, -126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0, -112.0, -120.0, -145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0], "episode_lengths": [199, 204, 147, 173, 168, 196, 209, 178, 210, 222, 175, 130, 193, 255, 134, 175, 168, 140, 103, 207, 132, 152, 166, 154, 134, 144, 167, 176, 132, 134, 125, 121, 153, 127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122, 113, 121, 146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20068679840950104, "mean_inference_ms": 0.7991022449908924, "mean_action_processing_ms": 0.08855060385562251, "mean_env_wait_ms": 0.1297043099477638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238128662109375, "StateBufferConnector_ms": 0.00390934944152832, "ViewRequirementAgentConnector_ms": 0.08062577247619629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.9066215168217, "num_env_steps_trained_throughput_per_sec": 274.9066215168217, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 14682.442, "sample_time_ms": 4924.082, "load_time_ms": 2.876, "load_throughput": 1390761.205, "learn_time_ms": 9745.989, "learn_throughput": 410.425, "synch_weights_time_ms": 8.48}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 164, "training_iteration": 9, "trial_id": "default", "date": "2024-08-30_12-38-18", "timestamp": 1724992698, "time_this_iter_s": 14.557525396347046, "time_total_s": 132.20381093025208, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 132.20381093025208, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 6.694736842105263, "ram_util_percent": 9.1, "gpu_util_percent0": 0.22263157894736843, "vram_util_percent0": 0.16237064830043857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.5476650381601, "policy_loss": -0.00019364758364615902, "vf_loss": 9.546786592339956, "vf_explained_var": 0.055210968819997645, "kl": 0.010721080649671096, "entropy": 0.6359592623608087, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -84.0, "episode_reward_min": -211.0, "episode_reward_mean": -129.44, "episode_len_mean": 130.44, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0, -112.0, -120.0, -145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0, -165.0, -163.0, -211.0, -103.0, -117.0, -105.0, -131.0, -113.0, -107.0, -96.0, -129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0], "episode_lengths": [127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122, 113, 121, 146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105, 166, 164, 212, 104, 118, 106, 132, 114, 108, 97, 130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2013292904926457, "mean_inference_ms": 0.8001618903459257, "mean_action_processing_ms": 0.08864394858128025, "mean_env_wait_ms": 0.1298796562082947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288911819458008, "StateBufferConnector_ms": 0.003975391387939453, "ViewRequirementAgentConnector_ms": 0.08205509185791016}}, "episode_reward_max": -84.0, "episode_reward_min": -211.0, "episode_reward_mean": -129.44, "episode_len_mean": 130.44, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-126.0, -188.0, -131.0, -133.0, -195.0, -190.0, -146.0, -100.0, -166.0, -102.0, -155.0, -138.0, -143.0, -137.0, -94.0, -123.0, -160.0, -127.0, -132.0, -128.0, -104.0, -119.0, -145.0, -156.0, -130.0, -137.0, -116.0, -175.0, -141.0, -146.0, -119.0, -180.0, -134.0, -129.0, -103.0, -121.0, -112.0, -120.0, -145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0, -165.0, -163.0, -211.0, -103.0, -117.0, -105.0, -131.0, -113.0, -107.0, -96.0, -129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0], "episode_lengths": [127, 189, 132, 134, 196, 191, 147, 101, 167, 103, 156, 139, 144, 138, 95, 124, 161, 128, 133, 129, 105, 120, 146, 157, 131, 138, 117, 176, 142, 147, 120, 181, 135, 130, 104, 122, 113, 121, 146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105, 166, 164, 212, 104, 118, 106, 132, 114, 108, 97, 130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2013292904926457, "mean_inference_ms": 0.8001618903459257, "mean_action_processing_ms": 0.08864394858128025, "mean_env_wait_ms": 0.1298796562082947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288911819458008, "StateBufferConnector_ms": 0.003975391387939453, "ViewRequirementAgentConnector_ms": 0.08205509185791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.61635272777283, "num_env_steps_trained_throughput_per_sec": 272.61635272777283, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 14681.458, "sample_time_ms": 4924.904, "load_time_ms": 2.875, "load_throughput": 1391249.43, "learn_time_ms": 9744.855, "learn_throughput": 410.473, "synch_weights_time_ms": 7.842}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 197, "training_iteration": 10, "trial_id": "default", "date": "2024-08-30_12-38-33", "timestamp": 1724992713, "time_this_iter_s": 14.679707765579224, "time_total_s": 146.8835186958313, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.8835186958313, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 6.110526315789474, "ram_util_percent": 9.14736842105263, "gpu_util_percent0": 0.19999999999999998, "vram_util_percent0": 0.15958230537280702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.494916592874835, "policy_loss": 0.0005943963925043742, "vf_loss": 9.493751655086394, "vf_explained_var": 0.07057575923140331, "kl": 0.005705663333989555, "entropy": 0.6041006321548134, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -76.0, "episode_reward_min": -211.0, "episode_reward_mean": -117.06, "episode_len_mean": 118.06, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0, -165.0, -163.0, -211.0, -103.0, -117.0, -105.0, -131.0, -113.0, -107.0, -96.0, -129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0, -133.0, -116.0, -100.0, -102.0, -147.0, -129.0, -106.0, -108.0, -116.0, -120.0, -89.0, -85.0, -94.0, -102.0, -84.0, -85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0], "episode_lengths": [146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105, 166, 164, 212, 104, 118, 106, 132, 114, 108, 97, 130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165, 134, 117, 101, 103, 148, 130, 107, 109, 117, 121, 90, 86, 95, 103, 85, 86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20165115465032593, "mean_inference_ms": 0.7997685716091886, "mean_action_processing_ms": 0.08865815907033063, "mean_env_wait_ms": 0.12993983350985935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047454833984375, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.08116888999938965}}, "episode_reward_max": -76.0, "episode_reward_min": -211.0, "episode_reward_mean": -117.06, "episode_len_mean": 118.06, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-145.0, -119.0, -102.0, -111.0, -121.0, -144.0, -101.0, -115.0, -96.0, -113.0, -122.0, -125.0, -129.0, -117.0, -124.0, -130.0, -139.0, -165.0, -186.0, -137.0, -126.0, -124.0, -125.0, -103.0, -107.0, -175.0, -108.0, -159.0, -104.0, -165.0, -163.0, -211.0, -103.0, -117.0, -105.0, -131.0, -113.0, -107.0, -96.0, -129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0, -133.0, -116.0, -100.0, -102.0, -147.0, -129.0, -106.0, -108.0, -116.0, -120.0, -89.0, -85.0, -94.0, -102.0, -84.0, -85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0], "episode_lengths": [146, 120, 103, 112, 122, 145, 102, 116, 97, 114, 123, 126, 130, 118, 125, 131, 140, 166, 187, 138, 127, 125, 126, 104, 108, 176, 109, 160, 105, 166, 164, 212, 104, 118, 106, 132, 114, 108, 97, 130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165, 134, 117, 101, 103, 148, 130, 107, 109, 117, 121, 90, 86, 95, 103, 85, 86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20165115465032593, "mean_inference_ms": 0.7997685716091886, "mean_action_processing_ms": 0.08865815907033063, "mean_env_wait_ms": 0.12993983350985935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047454833984375, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.08116888999938965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.32706422155354, "num_env_steps_trained_throughput_per_sec": 275.32706422155354, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14653.617, "sample_time_ms": 4922.622, "load_time_ms": 2.907, "load_throughput": 1375903.425, "learn_time_ms": 9722.161, "learn_throughput": 411.431, "synch_weights_time_ms": 5.06}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 235, "training_iteration": 11, "trial_id": "default", "date": "2024-08-30_12-38-47", "timestamp": 1724992727, "time_this_iter_s": 14.536068439483643, "time_total_s": 161.41958713531494, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 161.41958713531494, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 6.594736842105263, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.16999999999999998, "vram_util_percent0": 0.15581525836074564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.436419294213735, "policy_loss": -0.0005832593006792889, "vf_loss": 9.436265322982624, "vf_explained_var": 0.07117478885958271, "kl": 0.007372385439600605, "entropy": 0.5974430426474541, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -76.0, "episode_reward_min": -164.0, "episode_reward_mean": -106.47, "episode_len_mean": 107.47, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0, -133.0, -116.0, -100.0, -102.0, -147.0, -129.0, -106.0, -108.0, -116.0, -120.0, -89.0, -85.0, -94.0, -102.0, -84.0, -85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0, -106.0, -96.0, -84.0, -83.0, -99.0, -114.0, -103.0, -110.0, -88.0, -97.0, -96.0, -105.0, -123.0, -94.0, -79.0, -92.0, -92.0, -83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0], "episode_lengths": [130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165, 134, 117, 101, 103, 148, 130, 107, 109, 117, 121, 90, 86, 95, 103, 85, 86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129, 107, 97, 85, 84, 100, 115, 104, 111, 89, 98, 97, 106, 124, 95, 80, 93, 93, 84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2020436600032497, "mean_inference_ms": 0.7999870084145438, "mean_action_processing_ms": 0.08870437481206196, "mean_env_wait_ms": 0.13005632478942342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004639625549316406, "StateBufferConnector_ms": 0.003923654556274414, "ViewRequirementAgentConnector_ms": 0.0808866024017334}}, "episode_reward_max": -76.0, "episode_reward_min": -164.0, "episode_reward_mean": -106.47, "episode_len_mean": 107.47, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-129.0, -84.0, -93.0, -126.0, -140.0, -111.0, -118.0, -93.0, -149.0, -149.0, -105.0, -149.0, -90.0, -96.0, -140.0, -123.0, -86.0, -98.0, -111.0, -147.0, -123.0, -136.0, -164.0, -133.0, -116.0, -100.0, -102.0, -147.0, -129.0, -106.0, -108.0, -116.0, -120.0, -89.0, -85.0, -94.0, -102.0, -84.0, -85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0, -106.0, -96.0, -84.0, -83.0, -99.0, -114.0, -103.0, -110.0, -88.0, -97.0, -96.0, -105.0, -123.0, -94.0, -79.0, -92.0, -92.0, -83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0], "episode_lengths": [130, 85, 94, 127, 141, 112, 119, 94, 150, 150, 106, 150, 91, 97, 141, 124, 87, 99, 112, 148, 124, 137, 165, 134, 117, 101, 103, 148, 130, 107, 109, 117, 121, 90, 86, 95, 103, 85, 86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129, 107, 97, 85, 84, 100, 115, 104, 111, 89, 98, 97, 106, 124, 95, 80, 93, 93, 84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2020436600032497, "mean_inference_ms": 0.7999870084145438, "mean_action_processing_ms": 0.08870437481206196, "mean_env_wait_ms": 0.13005632478942342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004639625549316406, "StateBufferConnector_ms": 0.003923654556274414, "ViewRequirementAgentConnector_ms": 0.0808866024017334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.1792444916048, "num_env_steps_trained_throughput_per_sec": 272.1792444916048, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14640.605, "sample_time_ms": 4923.706, "load_time_ms": 2.938, "load_throughput": 1361289.789, "learn_time_ms": 9708.051, "learn_throughput": 412.029, "synch_weights_time_ms": 5.039}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 274, "training_iteration": 12, "trial_id": "default", "date": "2024-08-30_12-39-02", "timestamp": 1724992742, "time_this_iter_s": 14.705322980880737, "time_total_s": 176.12491011619568, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 176.12491011619568, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 6.4526315789473685, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.19, "vram_util_percent0": 0.1559073464912281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.437885343900291, "policy_loss": 1.7108015155279507e-05, "vf_loss": 9.437151464851954, "vf_explained_var": 0.11689866339006731, "kl": 0.00716772253047648, "entropy": 0.5363216445010196, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -76.0, "episode_reward_min": -178.0, "episode_reward_mean": -102.68, "episode_len_mean": 103.68, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0, -106.0, -96.0, -84.0, -83.0, -99.0, -114.0, -103.0, -110.0, -88.0, -97.0, -96.0, -105.0, -123.0, -94.0, -79.0, -92.0, -92.0, -83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0, -93.0, -178.0, -98.0, -80.0, -106.0, -121.0, -89.0, -117.0, -101.0, -97.0, -103.0, -87.0, -104.0, -104.0, -122.0, -102.0, -101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0], "episode_lengths": [86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129, 107, 97, 85, 84, 100, 115, 104, 111, 89, 98, 97, 106, 124, 95, 80, 93, 93, 84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112, 94, 179, 99, 81, 107, 122, 90, 118, 102, 98, 104, 88, 105, 105, 123, 103, 102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026337040156351, "mean_inference_ms": 0.8007678641971561, "mean_action_processing_ms": 0.08879075959988675, "mean_env_wait_ms": 0.13020522481886382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004690408706665039, "StateBufferConnector_ms": 0.004071235656738281, "ViewRequirementAgentConnector_ms": 0.08367252349853516}}, "episode_reward_max": -76.0, "episode_reward_min": -178.0, "episode_reward_mean": -102.68, "episode_len_mean": 103.68, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.0, -91.0, -81.0, -103.0, -140.0, -115.0, -86.0, -86.0, -97.0, -96.0, -110.0, -107.0, -97.0, -76.0, -100.0, -101.0, -93.0, -102.0, -97.0, -97.0, -124.0, -120.0, -128.0, -106.0, -96.0, -84.0, -83.0, -99.0, -114.0, -103.0, -110.0, -88.0, -97.0, -96.0, -105.0, -123.0, -94.0, -79.0, -92.0, -92.0, -83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0, -93.0, -178.0, -98.0, -80.0, -106.0, -121.0, -89.0, -117.0, -101.0, -97.0, -103.0, -87.0, -104.0, -104.0, -122.0, -102.0, -101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0], "episode_lengths": [86, 92, 82, 104, 141, 116, 87, 87, 98, 97, 111, 108, 98, 77, 101, 102, 94, 103, 98, 98, 125, 121, 129, 107, 97, 85, 84, 100, 115, 104, 111, 89, 98, 97, 106, 124, 95, 80, 93, 93, 84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112, 94, 179, 99, 81, 107, 122, 90, 118, 102, 98, 104, 88, 105, 105, 123, 103, 102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2026337040156351, "mean_inference_ms": 0.8007678641971561, "mean_action_processing_ms": 0.08879075959988675, "mean_env_wait_ms": 0.13020522481886382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004690408706665039, "StateBufferConnector_ms": 0.004071235656738281, "ViewRequirementAgentConnector_ms": 0.08367252349853516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.9893939965959, "num_env_steps_trained_throughput_per_sec": 269.9893939965959, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14655.222, "sample_time_ms": 4943.839, "load_time_ms": 2.977, "load_throughput": 1343843.646, "learn_time_ms": 9702.479, "learn_throughput": 412.266, "synch_weights_time_ms": 5.053}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 312, "training_iteration": 13, "trial_id": "default", "date": "2024-08-30_12-39-17", "timestamp": 1724992757, "time_this_iter_s": 14.823035717010498, "time_total_s": 190.94794583320618, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.94794583320618, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 5.7368421052631575, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.14578947368421052, "vram_util_percent0": 0.1557081791392544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.416156712398735, "policy_loss": 0.004327842198632738, "vf_loss": 9.411194687504922, "vf_explained_var": 0.1367643860078627, "kl": 0.006341519015047135, "entropy": 0.5259413744172742, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -178.0, "episode_reward_mean": -102.56, "episode_len_mean": 103.56, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0, -93.0, -178.0, -98.0, -80.0, -106.0, -121.0, -89.0, -117.0, -101.0, -97.0, -103.0, -87.0, -104.0, -104.0, -122.0, -102.0, -101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0, -136.0, -81.0, -110.0, -80.0, -99.0, -99.0, -90.0, -97.0, -116.0, -122.0, -103.0, -78.0, -64.0, -91.0, -110.0, -87.0, -101.0, -77.0, -96.0, -93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0], "episode_lengths": [84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112, 94, 179, 99, 81, 107, 122, 90, 118, 102, 98, 104, 88, 105, 105, 123, 103, 102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107, 137, 82, 111, 81, 100, 100, 91, 98, 117, 123, 104, 79, 65, 92, 111, 88, 102, 78, 97, 94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20318315016236008, "mean_inference_ms": 0.8015643798585316, "mean_action_processing_ms": 0.08884596466521334, "mean_env_wait_ms": 0.1302681908632665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004552364349365234, "StateBufferConnector_ms": 0.004080295562744141, "ViewRequirementAgentConnector_ms": 0.0842738151550293}}, "episode_reward_max": -64.0, "episode_reward_min": -178.0, "episode_reward_mean": -102.56, "episode_len_mean": 103.56, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83.0, -107.0, -136.0, -86.0, -90.0, -85.0, -94.0, -83.0, -155.0, -111.0, -91.0, -92.0, -94.0, -107.0, -102.0, -143.0, -107.0, -82.0, -109.0, -102.0, -93.0, -111.0, -93.0, -178.0, -98.0, -80.0, -106.0, -121.0, -89.0, -117.0, -101.0, -97.0, -103.0, -87.0, -104.0, -104.0, -122.0, -102.0, -101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0, -136.0, -81.0, -110.0, -80.0, -99.0, -99.0, -90.0, -97.0, -116.0, -122.0, -103.0, -78.0, -64.0, -91.0, -110.0, -87.0, -101.0, -77.0, -96.0, -93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0], "episode_lengths": [84, 108, 137, 87, 91, 86, 95, 84, 156, 112, 92, 93, 95, 108, 103, 144, 108, 83, 110, 103, 94, 112, 94, 179, 99, 81, 107, 122, 90, 118, 102, 98, 104, 88, 105, 105, 123, 103, 102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107, 137, 82, 111, 81, 100, 100, 91, 98, 117, 123, 104, 79, 65, 92, 111, 88, 102, 78, 97, 94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20318315016236008, "mean_inference_ms": 0.8015643798585316, "mean_action_processing_ms": 0.08884596466521334, "mean_env_wait_ms": 0.1302681908632665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004552364349365234, "StateBufferConnector_ms": 0.004080295562744141, "ViewRequirementAgentConnector_ms": 0.0842738151550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.6431726703729, "num_env_steps_trained_throughput_per_sec": 269.6431726703729, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14672.87, "sample_time_ms": 4949.492, "load_time_ms": 2.984, "load_throughput": 1340429.36, "learn_time_ms": 9714.472, "learn_throughput": 411.757, "synch_weights_time_ms": 5.041}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 352, "training_iteration": 14, "trial_id": "default", "date": "2024-08-30_12-39-32", "timestamp": 1724992772, "time_this_iter_s": 14.842140674591064, "time_total_s": 205.79008650779724, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.79008650779724, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 5.668421052631579, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.14473684210526316, "vram_util_percent0": 0.15586451480263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.44849020434964, "policy_loss": 0.0010441141843956004, "vf_loss": 9.447029752628778, "vf_explained_var": 0.1531881401615758, "kl": 0.00416330535974868, "entropy": 0.5053081882897243, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -215.0, "episode_reward_mean": -101.82, "episode_len_mean": 102.82, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0, -136.0, -81.0, -110.0, -80.0, -99.0, -99.0, -90.0, -97.0, -116.0, -122.0, -103.0, -78.0, -64.0, -91.0, -110.0, -87.0, -101.0, -77.0, -96.0, -93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0, -105.0, -215.0, -83.0, -105.0, -100.0, -116.0, -90.0, -87.0, -86.0, -94.0, -82.0, -87.0, -94.0, -99.0, -78.0, -86.0, -102.0, -85.0, -124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0], "episode_lengths": [102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107, 137, 82, 111, 81, 100, 100, 91, 98, 117, 123, 104, 79, 65, 92, 111, 88, 102, 78, 97, 94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130, 106, 216, 84, 106, 101, 117, 91, 88, 87, 95, 83, 88, 95, 100, 79, 87, 103, 86, 125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20349083985625718, "mean_inference_ms": 0.8019158784140892, "mean_action_processing_ms": 0.08887154595514986, "mean_env_wait_ms": 0.1302865484874424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004770994186401367, "StateBufferConnector_ms": 0.0039865970611572266, "ViewRequirementAgentConnector_ms": 0.08171772956848145}}, "episode_reward_max": -64.0, "episode_reward_min": -215.0, "episode_reward_mean": -101.82, "episode_len_mean": 102.82, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.0, -87.0, -89.0, -119.0, -100.0, -97.0, -106.0, -95.0, -98.0, -114.0, -133.0, -128.0, -79.0, -103.0, -121.0, -119.0, -109.0, -81.0, -122.0, -106.0, -97.0, -106.0, -136.0, -81.0, -110.0, -80.0, -99.0, -99.0, -90.0, -97.0, -116.0, -122.0, -103.0, -78.0, -64.0, -91.0, -110.0, -87.0, -101.0, -77.0, -96.0, -93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0, -105.0, -215.0, -83.0, -105.0, -100.0, -116.0, -90.0, -87.0, -86.0, -94.0, -82.0, -87.0, -94.0, -99.0, -78.0, -86.0, -102.0, -85.0, -124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0], "episode_lengths": [102, 88, 90, 120, 101, 98, 107, 96, 99, 115, 134, 129, 80, 104, 122, 120, 110, 82, 123, 107, 98, 107, 137, 82, 111, 81, 100, 100, 91, 98, 117, 123, 104, 79, 65, 92, 111, 88, 102, 78, 97, 94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130, 106, 216, 84, 106, 101, 117, 91, 88, 87, 95, 83, 88, 95, 100, 79, 87, 103, 86, 125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20349083985625718, "mean_inference_ms": 0.8019158784140892, "mean_action_processing_ms": 0.08887154595514986, "mean_env_wait_ms": 0.1302865484874424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004770994186401367, "StateBufferConnector_ms": 0.0039865970611572266, "ViewRequirementAgentConnector_ms": 0.08171772956848145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.0404269213915, "num_env_steps_trained_throughput_per_sec": 272.0404269213915, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14673.774, "sample_time_ms": 4956.827, "load_time_ms": 2.979, "load_throughput": 1342553.195, "learn_time_ms": 9710.945, "learn_throughput": 411.906, "synch_weights_time_ms": 2.2}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 390, "training_iteration": 15, "trial_id": "default", "date": "2024-08-30_12-39-47", "timestamp": 1724992787, "time_this_iter_s": 14.711456537246704, "time_total_s": 220.50154304504395, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 220.50154304504395, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.657894736842105, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.20105263157894737, "vram_util_percent0": 0.15559253358004385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.361974000418058, "policy_loss": 4.5028819592409236e-05, "vf_loss": 9.361612054353118, "vf_explained_var": 0.15264266274308647, "kl": 0.006338792424698941, "entropy": 0.465490956588458, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -217.0, "episode_reward_mean": -99.69, "episode_len_mean": 100.69, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0, -105.0, -215.0, -83.0, -105.0, -100.0, -116.0, -90.0, -87.0, -86.0, -94.0, -82.0, -87.0, -94.0, -99.0, -78.0, -86.0, -102.0, -85.0, -124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0, -91.0, -85.0, -91.0, -97.0, -89.0, -83.0, -91.0, -97.0, -102.0, -95.0, -87.0, -78.0, -90.0, -100.0, -105.0, -86.0, -89.0, -101.0, -83.0, -89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0], "episode_lengths": [94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130, 106, 216, 84, 106, 101, 117, 91, 88, 87, 95, 83, 88, 95, 100, 79, 87, 103, 86, 125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96, 92, 86, 92, 98, 90, 84, 92, 98, 103, 96, 88, 79, 91, 101, 106, 87, 90, 102, 84, 90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20364548862132004, "mean_inference_ms": 0.8019157316812937, "mean_action_processing_ms": 0.08888158124740327, "mean_env_wait_ms": 0.13030133556347884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004688739776611328, "StateBufferConnector_ms": 0.003935337066650391, "ViewRequirementAgentConnector_ms": 0.08124303817749023}}, "episode_reward_max": -64.0, "episode_reward_min": -217.0, "episode_reward_mean": -99.69, "episode_len_mean": 100.69, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.0, -92.0, -131.0, -107.0, -91.0, -81.0, -91.0, -122.0, -87.0, -90.0, -89.0, -115.0, -104.0, -106.0, -119.0, -110.0, -96.0, -100.0, -102.0, -89.0, -129.0, -105.0, -215.0, -83.0, -105.0, -100.0, -116.0, -90.0, -87.0, -86.0, -94.0, -82.0, -87.0, -94.0, -99.0, -78.0, -86.0, -102.0, -85.0, -124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0, -91.0, -85.0, -91.0, -97.0, -89.0, -83.0, -91.0, -97.0, -102.0, -95.0, -87.0, -78.0, -90.0, -100.0, -105.0, -86.0, -89.0, -101.0, -83.0, -89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0], "episode_lengths": [94, 93, 132, 108, 92, 82, 92, 123, 88, 91, 90, 116, 105, 107, 120, 111, 97, 101, 103, 90, 130, 106, 216, 84, 106, 101, 117, 91, 88, 87, 95, 83, 88, 95, 100, 79, 87, 103, 86, 125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96, 92, 86, 92, 98, 90, 84, 92, 98, 103, 96, 88, 79, 91, 101, 106, 87, 90, 102, 84, 90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20364548862132004, "mean_inference_ms": 0.8019157316812937, "mean_action_processing_ms": 0.08888158124740327, "mean_env_wait_ms": 0.13030133556347884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004688739776611328, "StateBufferConnector_ms": 0.003935337066650391, "ViewRequirementAgentConnector_ms": 0.08124303817749023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.23254329322907, "num_env_steps_trained_throughput_per_sec": 274.23254329322907, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14694.818, "sample_time_ms": 4980.581, "load_time_ms": 2.989, "load_throughput": 1338162.792, "learn_time_ms": 9708.198, "learn_throughput": 412.023, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 431, "training_iteration": 16, "trial_id": "default", "date": "2024-08-30_12-40-01", "timestamp": 1724992801, "time_this_iter_s": 14.594086170196533, "time_total_s": 235.09562921524048, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.09562921524048, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 6.310526315789473, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.18526315789473688, "vram_util_percent0": 0.15559253358004382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.292655169066563, "policy_loss": 7.087155095031184e-05, "vf_loss": 9.292348837083386, "vf_explained_var": 0.11578381599918489, "kl": 0.004708892041771021, "entropy": 0.4646509498998683, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -280.0, "episode_reward_mean": -100.39, "episode_len_mean": 101.39, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0, -91.0, -85.0, -91.0, -97.0, -89.0, -83.0, -91.0, -97.0, -102.0, -95.0, -87.0, -78.0, -90.0, -100.0, -105.0, -86.0, -89.0, -101.0, -83.0, -89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0, -189.0, -93.0, -89.0, -96.0, -85.0, -113.0, -76.0, -93.0, -96.0, -89.0, -116.0, -92.0, -77.0, -89.0, -95.0, -104.0, -92.0, -97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0], "episode_lengths": [125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96, 92, 86, 92, 98, 90, 84, 92, 98, 103, 96, 88, 79, 91, 101, 106, 87, 90, 102, 84, 90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117, 190, 94, 90, 97, 86, 114, 77, 94, 97, 90, 117, 93, 78, 90, 96, 105, 93, 98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20385880197369688, "mean_inference_ms": 0.8021130403662913, "mean_action_processing_ms": 0.08891953639428216, "mean_env_wait_ms": 0.1303485098472039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004660129547119141, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.08219647407531738}}, "episode_reward_max": -64.0, "episode_reward_min": -280.0, "episode_reward_mean": -100.39, "episode_len_mean": 101.39, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-124.0, -91.0, -92.0, -93.0, -95.0, -131.0, -111.0, -79.0, -106.0, -160.0, -117.0, -114.0, -82.0, -142.0, -64.0, -104.0, -89.0, -124.0, -84.0, -95.0, -91.0, -85.0, -91.0, -97.0, -89.0, -83.0, -91.0, -97.0, -102.0, -95.0, -87.0, -78.0, -90.0, -100.0, -105.0, -86.0, -89.0, -101.0, -83.0, -89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0, -189.0, -93.0, -89.0, -96.0, -85.0, -113.0, -76.0, -93.0, -96.0, -89.0, -116.0, -92.0, -77.0, -89.0, -95.0, -104.0, -92.0, -97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0], "episode_lengths": [125, 92, 93, 94, 96, 132, 112, 80, 107, 161, 118, 115, 83, 143, 65, 105, 90, 125, 85, 96, 92, 86, 92, 98, 90, 84, 92, 98, 103, 96, 88, 79, 91, 101, 106, 87, 90, 102, 84, 90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117, 190, 94, 90, 97, 86, 114, 77, 94, 97, 90, 117, 93, 78, 90, 96, 105, 93, 98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20385880197369688, "mean_inference_ms": 0.8021130403662913, "mean_action_processing_ms": 0.08891953639428216, "mean_env_wait_ms": 0.1303485098472039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004660129547119141, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.08219647407531738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.8528023122795, "num_env_steps_trained_throughput_per_sec": 271.8528023122795, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14688.977, "sample_time_ms": 4975.203, "load_time_ms": 2.997, "load_throughput": 1334564.922, "learn_time_ms": 9707.706, "learn_throughput": 412.044, "synch_weights_time_ms": 2.242}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 470, "training_iteration": 17, "trial_id": "default", "date": "2024-08-30_12-40-16", "timestamp": 1724992816, "time_this_iter_s": 14.721695899963379, "time_total_s": 249.81732511520386, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 249.81732511520386, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 6.026315789473683, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.19000000000000003, "vram_util_percent0": 0.1559544613486842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.29789971741297, "policy_loss": -0.0009163750796228327, "vf_loss": 9.298663847933533, "vf_explained_var": 0.1049955609665122, "kl": 0.006089583999461742, "entropy": 0.44445385823967637, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -280.0, "episode_reward_mean": -101.44, "episode_len_mean": 102.44, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0, -189.0, -93.0, -89.0, -96.0, -85.0, -113.0, -76.0, -93.0, -96.0, -89.0, -116.0, -92.0, -77.0, -89.0, -95.0, -104.0, -92.0, -97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0, -108.0, -108.0, -104.0, -110.0, -91.0, -85.0, -82.0, -122.0, -124.0, -89.0, -156.0, -107.0, -77.0, -85.0, -93.0, -105.0, -93.0, -86.0, -88.0, -93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0], "episode_lengths": [90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117, 190, 94, 90, 97, 86, 114, 77, 94, 97, 90, 117, 93, 78, 90, 96, 105, 93, 98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89, 109, 109, 105, 111, 92, 86, 83, 123, 125, 90, 157, 108, 78, 86, 94, 106, 94, 87, 89, 94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20398136042728168, "mean_inference_ms": 0.8020343816010441, "mean_action_processing_ms": 0.08891537641914159, "mean_env_wait_ms": 0.13033489781044705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004407167434692383, "StateBufferConnector_ms": 0.003921985626220703, "ViewRequirementAgentConnector_ms": 0.08111572265625}}, "episode_reward_max": -69.0, "episode_reward_min": -280.0, "episode_reward_mean": -101.44, "episode_len_mean": 102.44, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -107.0, -118.0, -69.0, -101.0, -105.0, -94.0, -99.0, -79.0, -78.0, -81.0, -119.0, -123.0, -70.0, -81.0, -217.0, -119.0, -91.0, -86.0, -72.0, -80.0, -116.0, -189.0, -93.0, -89.0, -96.0, -85.0, -113.0, -76.0, -93.0, -96.0, -89.0, -116.0, -92.0, -77.0, -89.0, -95.0, -104.0, -92.0, -97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0, -108.0, -108.0, -104.0, -110.0, -91.0, -85.0, -82.0, -122.0, -124.0, -89.0, -156.0, -107.0, -77.0, -85.0, -93.0, -105.0, -93.0, -86.0, -88.0, -93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0], "episode_lengths": [90, 108, 119, 70, 102, 106, 95, 100, 80, 79, 82, 120, 124, 71, 82, 218, 120, 92, 87, 73, 81, 117, 190, 94, 90, 97, 86, 114, 77, 94, 97, 90, 117, 93, 78, 90, 96, 105, 93, 98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89, 109, 109, 105, 111, 92, 86, 83, 123, 125, 90, 157, 108, 78, 86, 94, 106, 94, 87, 89, 94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20398136042728168, "mean_inference_ms": 0.8020343816010441, "mean_action_processing_ms": 0.08891537641914159, "mean_env_wait_ms": 0.13033489781044705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004407167434692383, "StateBufferConnector_ms": 0.003921985626220703, "ViewRequirementAgentConnector_ms": 0.08111572265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.65757563834336, "num_env_steps_trained_throughput_per_sec": 271.65757563834336, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14682.49, "sample_time_ms": 4957.119, "load_time_ms": 3.0, "load_throughput": 1333355.798, "learn_time_ms": 9719.377, "learn_throughput": 411.549, "synch_weights_time_ms": 2.196}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 509, "training_iteration": 18, "trial_id": "default", "date": "2024-08-30_12-40-31", "timestamp": 1724992831, "time_this_iter_s": 14.728923559188843, "time_total_s": 264.5462486743927, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 264.5462486743927, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 5.910526315789474, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.1742105263157895, "vram_util_percent0": 0.15555398506030704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.382463587484052, "policy_loss": 0.001563895503760025, "vf_loss": 9.380795099401986, "vf_explained_var": 0.10387750146209553, "kl": 0.004184494685550418, "entropy": 0.43381945599791827, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -309.0, "episode_reward_mean": -102.71, "episode_len_mean": 103.71, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0, -108.0, -108.0, -104.0, -110.0, -91.0, -85.0, -82.0, -122.0, -124.0, -89.0, -156.0, -107.0, -77.0, -85.0, -93.0, -105.0, -93.0, -86.0, -88.0, -93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0, -88.0, -89.0, -99.0, -85.0, -109.0, -170.0, -79.0, -79.0, -92.0, -104.0, -95.0, -105.0, -93.0, -101.0, -79.0, -90.0, -100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0], "episode_lengths": [98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89, 109, 109, 105, 111, 92, 86, 83, 123, 125, 90, 157, 108, 78, 86, 94, 106, 94, 87, 89, 94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84, 89, 90, 100, 86, 110, 171, 80, 80, 93, 105, 96, 106, 94, 102, 80, 91, 101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20420489583800383, "mean_inference_ms": 0.802340368677097, "mean_action_processing_ms": 0.08895725662638929, "mean_env_wait_ms": 0.13037688245924273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004659891128540039, "StateBufferConnector_ms": 0.004006385803222656, "ViewRequirementAgentConnector_ms": 0.08306336402893066}}, "episode_reward_max": -69.0, "episode_reward_min": -309.0, "episode_reward_mean": -102.71, "episode_len_mean": 103.71, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -112.0, -104.0, -73.0, -71.0, -280.0, -121.0, -85.0, -104.0, -87.0, -95.0, -80.0, -94.0, -108.0, -78.0, -87.0, -215.0, -91.0, -101.0, -80.0, -73.0, -88.0, -108.0, -108.0, -104.0, -110.0, -91.0, -85.0, -82.0, -122.0, -124.0, -89.0, -156.0, -107.0, -77.0, -85.0, -93.0, -105.0, -93.0, -86.0, -88.0, -93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0, -88.0, -89.0, -99.0, -85.0, -109.0, -170.0, -79.0, -79.0, -92.0, -104.0, -95.0, -105.0, -93.0, -101.0, -79.0, -90.0, -100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0], "episode_lengths": [98, 113, 105, 74, 72, 281, 122, 86, 105, 88, 96, 81, 95, 109, 79, 88, 216, 92, 102, 81, 74, 89, 109, 109, 105, 111, 92, 86, 83, 123, 125, 90, 157, 108, 78, 86, 94, 106, 94, 87, 89, 94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84, 89, 90, 100, 86, 110, 171, 80, 80, 93, 105, 96, 106, 94, 102, 80, 91, 101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20420489583800383, "mean_inference_ms": 0.802340368677097, "mean_action_processing_ms": 0.08895725662638929, "mean_env_wait_ms": 0.13037688245924273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004659891128540039, "StateBufferConnector_ms": 0.004006385803222656, "ViewRequirementAgentConnector_ms": 0.08306336402893066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.5214160016967, "num_env_steps_trained_throughput_per_sec": 269.5214160016967, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14711.557, "sample_time_ms": 4978.878, "load_time_ms": 3.038, "load_throughput": 1316830.918, "learn_time_ms": 9723.639, "learn_throughput": 411.369, "synch_weights_time_ms": 5.123}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 548, "training_iteration": 19, "trial_id": "default", "date": "2024-08-30_12-40-46", "timestamp": 1724992846, "time_this_iter_s": 14.848543167114258, "time_total_s": 279.39479184150696, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 279.39479184150696, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 6.664999999999999, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.19900000000000004, "vram_util_percent0": 0.155731201171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.297040843963623, "policy_loss": -0.01724583262036885, "vf_loss": 9.31371736629035, "vf_explained_var": 0.1401820908951503, "kl": 0.045551038302771074, "entropy": 0.5307979246941946, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -309.0, "episode_reward_mean": -99.65, "episode_len_mean": 100.65, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0, -88.0, -89.0, -99.0, -85.0, -109.0, -170.0, -79.0, -79.0, -92.0, -104.0, -95.0, -105.0, -93.0, -101.0, -79.0, -90.0, -100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0, -82.0, -112.0, -103.0, -71.0, -99.0, -87.0, -96.0, -73.0, -109.0, -87.0, -72.0, -70.0, -105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0], "episode_lengths": [94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84, 89, 90, 100, 86, 110, 171, 80, 80, 93, 105, 96, 106, 94, 102, 80, 91, 101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95, 83, 113, 104, 72, 100, 88, 97, 74, 110, 88, 73, 71, 106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20455071403759795, "mean_inference_ms": 0.8030800082837218, "mean_action_processing_ms": 0.08903922702106032, "mean_env_wait_ms": 0.13048189360721296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00471949577331543, "StateBufferConnector_ms": 0.004058837890625, "ViewRequirementAgentConnector_ms": 0.08404684066772461}}, "episode_reward_max": -63.0, "episode_reward_min": -309.0, "episode_reward_mean": -99.65, "episode_len_mean": 100.65, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.0, -80.0, -239.0, -117.0, -74.0, -108.0, -85.0, -99.0, -116.0, -75.0, -115.0, -150.0, -72.0, -92.0, -96.0, -71.0, -85.0, -82.0, -97.0, -83.0, -88.0, -89.0, -99.0, -85.0, -109.0, -170.0, -79.0, -79.0, -92.0, -104.0, -95.0, -105.0, -93.0, -101.0, -79.0, -90.0, -100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0, -82.0, -112.0, -103.0, -71.0, -99.0, -87.0, -96.0, -73.0, -109.0, -87.0, -72.0, -70.0, -105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0], "episode_lengths": [94, 81, 240, 118, 75, 109, 86, 100, 117, 76, 116, 151, 73, 93, 97, 72, 86, 83, 98, 84, 89, 90, 100, 86, 110, 171, 80, 80, 93, 105, 96, 106, 94, 102, 80, 91, 101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95, 83, 113, 104, 72, 100, 88, 97, 74, 110, 88, 73, 71, 106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20455071403759795, "mean_inference_ms": 0.8030800082837218, "mean_action_processing_ms": 0.08903922702106032, "mean_env_wait_ms": 0.13048189360721296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00471949577331543, "StateBufferConnector_ms": 0.004058837890625, "ViewRequirementAgentConnector_ms": 0.08404684066772461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.24629976082105, "num_env_steps_trained_throughput_per_sec": 267.24629976082105, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14741.038, "sample_time_ms": 4994.088, "load_time_ms": 3.033, "load_throughput": 1318642.155, "learn_time_ms": 9737.886, "learn_throughput": 410.767, "synch_weights_time_ms": 5.137}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 589, "training_iteration": 20, "trial_id": "default", "date": "2024-08-30_12-41-01", "timestamp": 1724992861, "time_this_iter_s": 14.975194215774536, "time_total_s": 294.3699860572815, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.3699860572815, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 5.842105263157895, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.1510526315789474, "vram_util_percent0": 0.15504000479714913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.377178623855755, "policy_loss": -0.002940579325521505, "vf_loss": 9.37988442451723, "vf_explained_var": 0.11392900719437547, "kl": 0.012520955468722495, "entropy": 0.602118057204831, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -309.0, "episode_reward_mean": -102.94, "episode_len_mean": 103.94, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0, -82.0, -112.0, -103.0, -71.0, -99.0, -87.0, -96.0, -73.0, -109.0, -87.0, -72.0, -70.0, -105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0, -71.0, -84.0, -86.0, -97.0, -85.0, -132.0, -95.0, -91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0], "episode_lengths": [101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95, 83, 113, 104, 72, 100, 88, 97, 74, 110, 88, 73, 71, 106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96, 72, 85, 87, 98, 86, 133, 96, 92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482788814822153, "mean_inference_ms": 0.8037227310532948, "mean_action_processing_ms": 0.0891101526771095, "mean_env_wait_ms": 0.1305600165150843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004770040512084961, "StateBufferConnector_ms": 0.004050254821777344, "ViewRequirementAgentConnector_ms": 0.08398175239562988}}, "episode_reward_max": -63.0, "episode_reward_min": -309.0, "episode_reward_mean": -102.94, "episode_len_mean": 103.94, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.0, -83.0, -85.0, -101.0, -84.0, -102.0, -73.0, -115.0, -70.0, -93.0, -86.0, -309.0, -100.0, -91.0, -241.0, -84.0, -108.0, -77.0, -95.0, -86.0, -102.0, -69.0, -94.0, -82.0, -112.0, -103.0, -71.0, -99.0, -87.0, -96.0, -73.0, -109.0, -87.0, -72.0, -70.0, -105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0, -71.0, -84.0, -86.0, -97.0, -85.0, -132.0, -95.0, -91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0], "episode_lengths": [101, 84, 86, 102, 85, 103, 74, 116, 71, 94, 87, 310, 101, 92, 242, 85, 109, 78, 96, 87, 103, 70, 95, 83, 113, 104, 72, 100, 88, 97, 74, 110, 88, 73, 71, 106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96, 72, 85, 87, 98, 86, 133, 96, 92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482788814822153, "mean_inference_ms": 0.8037227310532948, "mean_action_processing_ms": 0.0891101526771095, "mean_env_wait_ms": 0.1305600165150843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004770040512084961, "StateBufferConnector_ms": 0.004050254821777344, "ViewRequirementAgentConnector_ms": 0.08398175239562988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.72395104987294, "num_env_steps_trained_throughput_per_sec": 269.72395104987294, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14771.218, "sample_time_ms": 4998.058, "load_time_ms": 3.034, "load_throughput": 1318507.435, "learn_time_ms": 9764.124, "learn_throughput": 409.663, "synch_weights_time_ms": 5.111}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 625, "training_iteration": 21, "trial_id": "default", "date": "2024-08-30_12-41-16", "timestamp": 1724992876, "time_this_iter_s": 14.837156295776367, "time_total_s": 309.20714235305786, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 309.20714235305786, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 6.163157894736842, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.17421052631578948, "vram_util_percent0": 0.1543911047149123}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.384444122929727, "policy_loss": -0.0010412782370563477, "vf_loss": 9.385337082032235, "vf_explained_var": 0.09167898688265072, "kl": 0.007910815161711483, "entropy": 0.5578647286661209, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -400.0, "episode_reward_mean": -108.11, "episode_len_mean": 109.11, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0, -71.0, -84.0, -86.0, -97.0, -85.0, -132.0, -95.0, -91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0, -160.0, -81.0, -142.0, -91.0, -97.0, -145.0, -98.0, -83.0, -82.0, -118.0, -400.0, -112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0], "episode_lengths": [106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96, 72, 85, 87, 98, 86, 133, 96, 92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98, 161, 82, 143, 92, 98, 146, 99, 84, 83, 119, 401, 113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2048573053660683, "mean_inference_ms": 0.8036198306077637, "mean_action_processing_ms": 0.089094084146558, "mean_env_wait_ms": 0.13052959004099354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004686117172241211, "StateBufferConnector_ms": 0.0038962364196777344, "ViewRequirementAgentConnector_ms": 0.08199620246887207}}, "episode_reward_max": -63.0, "episode_reward_min": -400.0, "episode_reward_mean": -108.11, "episode_len_mean": 109.11, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.0, -122.0, -89.0, -88.0, -85.0, -101.0, -78.0, -103.0, -77.0, -97.0, -124.0, -116.0, -98.0, -82.0, -72.0, -145.0, -76.0, -63.0, -79.0, -104.0, -94.0, -88.0, -84.0, -96.0, -77.0, -193.0, -133.0, -106.0, -95.0, -71.0, -84.0, -86.0, -97.0, -85.0, -132.0, -95.0, -91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0, -160.0, -81.0, -142.0, -91.0, -97.0, -145.0, -98.0, -83.0, -82.0, -118.0, -400.0, -112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0], "episode_lengths": [106, 123, 90, 89, 86, 102, 79, 104, 78, 98, 125, 117, 99, 83, 73, 146, 77, 64, 80, 105, 95, 89, 85, 97, 78, 194, 134, 107, 96, 72, 85, 87, 98, 86, 133, 96, 92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98, 161, 82, 143, 92, 98, 146, 99, 84, 83, 119, 401, 113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2048573053660683, "mean_inference_ms": 0.8036198306077637, "mean_action_processing_ms": 0.089094084146558, "mean_env_wait_ms": 0.13052959004099354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004686117172241211, "StateBufferConnector_ms": 0.0038962364196777344, "ViewRequirementAgentConnector_ms": 0.08199620246887207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.52662071517034, "num_env_steps_trained_throughput_per_sec": 275.52662071517034, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14753.365, "sample_time_ms": 4979.612, "load_time_ms": 3.028, "load_throughput": 1320801.43, "learn_time_ms": 9764.756, "learn_throughput": 409.636, "synch_weights_time_ms": 5.087}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 660, "training_iteration": 22, "trial_id": "default", "date": "2024-08-30_12-41-30", "timestamp": 1724992890, "time_this_iter_s": 14.525599956512451, "time_total_s": 323.7327423095703, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 323.7327423095703, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 5.415789473684211, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.15526315789473688, "vram_util_percent0": 0.13982833059210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.372984048371674, "policy_loss": -0.0013275925190218032, "vf_loss": 9.374101271680606, "vf_explained_var": 0.1540552043786613, "kl": 0.01121905628314925, "entropy": 0.5526938299658478, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -79.0, "episode_reward_min": -400.0, "episode_reward_mean": -112.72, "episode_len_mean": 113.72, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0, -160.0, -81.0, -142.0, -91.0, -97.0, -145.0, -98.0, -83.0, -82.0, -118.0, -400.0, -112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0, -115.0, -121.0, -83.0, -100.0, -114.0, -90.0, -100.0, -82.0, -116.0, -82.0, -105.0, -121.0, -184.0, -112.0, -87.0, -101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0], "episode_lengths": [92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98, 161, 82, 143, 92, 98, 146, 99, 84, 83, 119, 401, 113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100, 116, 122, 84, 101, 115, 91, 101, 83, 117, 83, 106, 122, 185, 113, 88, 102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20484416936107475, "mean_inference_ms": 0.8034067403489269, "mean_action_processing_ms": 0.08906918531041441, "mean_env_wait_ms": 0.13047877045549355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004384517669677734, "StateBufferConnector_ms": 0.0038335323333740234, "ViewRequirementAgentConnector_ms": 0.08140850067138672}}, "episode_reward_max": -79.0, "episode_reward_min": -400.0, "episode_reward_mean": -112.72, "episode_len_mean": 113.72, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-91.0, -91.0, -119.0, -110.0, -92.0, -104.0, -107.0, -93.0, -130.0, -130.0, -144.0, -117.0, -109.0, -135.0, -87.0, -113.0, -255.0, -113.0, -120.0, -93.0, -99.0, -88.0, -98.0, -99.0, -98.0, -139.0, -101.0, -93.0, -97.0, -160.0, -81.0, -142.0, -91.0, -97.0, -145.0, -98.0, -83.0, -82.0, -118.0, -400.0, -112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0, -115.0, -121.0, -83.0, -100.0, -114.0, -90.0, -100.0, -82.0, -116.0, -82.0, -105.0, -121.0, -184.0, -112.0, -87.0, -101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0], "episode_lengths": [92, 92, 120, 111, 93, 105, 108, 94, 131, 131, 145, 118, 110, 136, 88, 114, 256, 114, 121, 94, 100, 89, 99, 100, 99, 140, 102, 94, 98, 161, 82, 143, 92, 98, 146, 99, 84, 83, 119, 401, 113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100, 116, 122, 84, 101, 115, 91, 101, 83, 117, 83, 106, 122, 185, 113, 88, 102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20484416936107475, "mean_inference_ms": 0.8034067403489269, "mean_action_processing_ms": 0.08906918531041441, "mean_env_wait_ms": 0.13047877045549355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004384517669677734, "StateBufferConnector_ms": 0.0038335323333740234, "ViewRequirementAgentConnector_ms": 0.08140850067138672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.4490357000265, "num_env_steps_trained_throughput_per_sec": 272.4490357000265, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14739.991, "sample_time_ms": 4974.226, "load_time_ms": 3.034, "load_throughput": 1318465.988, "learn_time_ms": 9756.794, "learn_throughput": 409.971, "synch_weights_time_ms": 5.066}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 696, "training_iteration": 23, "trial_id": "default", "date": "2024-08-30_12-41-45", "timestamp": 1724992905, "time_this_iter_s": 14.688851356506348, "time_total_s": 338.42159366607666, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.42159366607666, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 6.221052631578948, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.2, "vram_util_percent0": 0.14026307223135967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.267050164745699, "policy_loss": 0.0026697369112122444, "vf_loss": 9.26418017623245, "vf_explained_var": 0.155193894140182, "kl": 0.010680974176775777, "entropy": 0.523311647965062, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -78.0, "episode_reward_min": -188.0, "episode_reward_mean": -105.05, "episode_len_mean": 106.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0, -115.0, -121.0, -83.0, -100.0, -114.0, -90.0, -100.0, -82.0, -116.0, -82.0, -105.0, -121.0, -184.0, -112.0, -87.0, -101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0, -95.0, -96.0, -96.0, -91.0, -86.0, -108.0, -81.0, -98.0, -118.0, -93.0, -139.0, -93.0, -104.0, -109.0, -86.0, -107.0, -103.0, -97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0], "episode_lengths": [113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100, 116, 122, 84, 101, 115, 91, 101, 83, 117, 83, 106, 122, 185, 113, 88, 102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105, 96, 97, 97, 92, 87, 109, 82, 99, 119, 94, 140, 94, 105, 110, 87, 108, 104, 98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2049620877725276, "mean_inference_ms": 0.8035343392114386, "mean_action_processing_ms": 0.08909605853863507, "mean_env_wait_ms": 0.1305001026375087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041501522064208984, "StateBufferConnector_ms": 0.0038971900939941406, "ViewRequirementAgentConnector_ms": 0.0830373764038086}}, "episode_reward_max": -78.0, "episode_reward_min": -188.0, "episode_reward_mean": -105.05, "episode_len_mean": 106.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112.0, -99.0, -116.0, -111.0, -101.0, -138.0, -82.0, -123.0, -104.0, -117.0, -98.0, -87.0, -98.0, -96.0, -109.0, -86.0, -124.0, -122.0, -105.0, -94.0, -112.0, -94.0, -102.0, -99.0, -115.0, -121.0, -83.0, -100.0, -114.0, -90.0, -100.0, -82.0, -116.0, -82.0, -105.0, -121.0, -184.0, -112.0, -87.0, -101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0, -95.0, -96.0, -96.0, -91.0, -86.0, -108.0, -81.0, -98.0, -118.0, -93.0, -139.0, -93.0, -104.0, -109.0, -86.0, -107.0, -103.0, -97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0], "episode_lengths": [113, 100, 117, 112, 102, 139, 83, 124, 105, 118, 99, 88, 99, 97, 110, 87, 125, 123, 106, 95, 113, 95, 103, 100, 116, 122, 84, 101, 115, 91, 101, 83, 117, 83, 106, 122, 185, 113, 88, 102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105, 96, 97, 97, 92, 87, 109, 82, 99, 119, 94, 140, 94, 105, 110, 87, 108, 104, 98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2049620877725276, "mean_inference_ms": 0.8035343392114386, "mean_action_processing_ms": 0.08909605853863507, "mean_env_wait_ms": 0.1305001026375087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041501522064208984, "StateBufferConnector_ms": 0.0038971900939941406, "ViewRequirementAgentConnector_ms": 0.0830373764038086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.0874264986615, "num_env_steps_trained_throughput_per_sec": 272.0874264986615, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14726.666, "sample_time_ms": 4986.716, "load_time_ms": 3.118, "load_throughput": 1282857.929, "learn_time_ms": 9730.902, "learn_throughput": 411.062, "synch_weights_time_ms": 5.064}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 736, "training_iteration": 24, "trial_id": "default", "date": "2024-08-30_12-42-00", "timestamp": 1724992920, "time_this_iter_s": 14.70885682106018, "time_total_s": 353.13045048713684, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.13045048713684, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.7368421052631575, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.21157894736842103, "vram_util_percent0": 0.14013457716557015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.30665798699984, "policy_loss": 0.004189777814893312, "vf_loss": 9.302347331918696, "vf_explained_var": 0.13463364166598166, "kl": 0.006449028074346859, "entropy": 0.5085917033815897, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -198.0, "episode_reward_mean": -103.14, "episode_len_mean": 104.14, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0, -95.0, -96.0, -96.0, -91.0, -86.0, -108.0, -81.0, -98.0, -118.0, -93.0, -139.0, -93.0, -104.0, -109.0, -86.0, -107.0, -103.0, -97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0, -115.0, -130.0, -101.0, -107.0, -96.0, -98.0, -77.0, -69.0, -91.0, -101.0, -113.0, -112.0, -84.0, -91.0, -83.0, -81.0, -102.0, -110.0, -110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0], "episode_lengths": [102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105, 96, 97, 97, 92, 87, 109, 82, 99, 119, 94, 140, 94, 105, 110, 87, 108, 104, 98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101, 116, 131, 102, 108, 97, 99, 78, 70, 92, 102, 114, 113, 85, 92, 84, 82, 103, 111, 111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526703662321025, "mean_inference_ms": 0.804198654228002, "mean_action_processing_ms": 0.08920039172230937, "mean_env_wait_ms": 0.1306282812414018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004163026809692383, "StateBufferConnector_ms": 0.004091739654541016, "ViewRequirementAgentConnector_ms": 0.08572649955749512}}, "episode_reward_max": -69.0, "episode_reward_min": -198.0, "episode_reward_mean": -103.14, "episode_len_mean": 104.14, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.0, -123.0, -79.0, -111.0, -106.0, -121.0, -187.0, -92.0, -188.0, -79.0, -121.0, -105.0, -86.0, -115.0, -137.0, -105.0, -109.0, -98.0, -82.0, -120.0, -104.0, -95.0, -96.0, -96.0, -91.0, -86.0, -108.0, -81.0, -98.0, -118.0, -93.0, -139.0, -93.0, -104.0, -109.0, -86.0, -107.0, -103.0, -97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0, -115.0, -130.0, -101.0, -107.0, -96.0, -98.0, -77.0, -69.0, -91.0, -101.0, -113.0, -112.0, -84.0, -91.0, -83.0, -81.0, -102.0, -110.0, -110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0], "episode_lengths": [102, 124, 80, 112, 107, 122, 188, 93, 189, 80, 122, 106, 87, 116, 138, 106, 110, 99, 83, 121, 105, 96, 97, 97, 92, 87, 109, 82, 99, 119, 94, 140, 94, 105, 110, 87, 108, 104, 98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101, 116, 131, 102, 108, 97, 99, 78, 70, 92, 102, 114, 113, 85, 92, 84, 82, 103, 111, 111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526703662321025, "mean_inference_ms": 0.804198654228002, "mean_action_processing_ms": 0.08920039172230937, "mean_env_wait_ms": 0.1306282812414018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004163026809692383, "StateBufferConnector_ms": 0.004091739654541016, "ViewRequirementAgentConnector_ms": 0.08572649955749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.1700819303535, "num_env_steps_trained_throughput_per_sec": 270.1700819303535, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14736.844, "sample_time_ms": 5001.868, "load_time_ms": 3.12, "load_throughput": 1281975.701, "learn_time_ms": 9725.898, "learn_throughput": 411.273, "synch_weights_time_ms": 5.085}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 775, "training_iteration": 25, "trial_id": "default", "date": "2024-08-30_12-42-14", "timestamp": 1724992934, "time_this_iter_s": 14.813325881958008, "time_total_s": 367.94377636909485, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 367.94377636909485, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 6.810526315789474, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.2036842105263158, "vram_util_percent0": 0.14019882469846492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.274159155609787, "policy_loss": -0.0011265797901057427, "vf_loss": 9.27513714657035, "vf_explained_var": 0.13275003202499883, "kl": 0.007923172693109265, "entropy": 0.462994536116559, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -101.9, "episode_len_mean": 102.9, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0, -115.0, -130.0, -101.0, -107.0, -96.0, -98.0, -77.0, -69.0, -91.0, -101.0, -113.0, -112.0, -84.0, -91.0, -83.0, -81.0, -102.0, -110.0, -110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0, -110.0, -127.0, -91.0, -79.0, -101.0, -187.0, -106.0, -76.0, -102.0, -92.0, -118.0, -90.0, -97.0, -87.0, -97.0, -97.0, -121.0, -102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0], "episode_lengths": [98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101, 116, 131, 102, 108, 97, 99, 78, 70, 92, 102, 114, 113, 85, 92, 84, 82, 103, 111, 111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102, 111, 128, 92, 80, 102, 188, 107, 77, 103, 93, 119, 91, 98, 88, 98, 98, 122, 103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2054314053201851, "mean_inference_ms": 0.8045150990944108, "mean_action_processing_ms": 0.08926333607058956, "mean_env_wait_ms": 0.13070820009168455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004130125045776367, "StateBufferConnector_ms": 0.004065275192260742, "ViewRequirementAgentConnector_ms": 0.08360862731933594}}, "episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -101.9, "episode_len_mean": 102.9, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -123.0, -102.0, -110.0, -121.0, -88.0, -81.0, -115.0, -97.0, -101.0, -87.0, -84.0, -126.0, -112.0, -78.0, -104.0, -95.0, -82.0, -99.0, -96.0, -96.0, -98.0, -100.0, -115.0, -130.0, -101.0, -107.0, -96.0, -98.0, -77.0, -69.0, -91.0, -101.0, -113.0, -112.0, -84.0, -91.0, -83.0, -81.0, -102.0, -110.0, -110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0, -110.0, -127.0, -91.0, -79.0, -101.0, -187.0, -106.0, -76.0, -102.0, -92.0, -118.0, -90.0, -97.0, -87.0, -97.0, -97.0, -121.0, -102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0], "episode_lengths": [98, 124, 103, 111, 122, 89, 82, 116, 98, 102, 88, 85, 127, 113, 79, 105, 96, 83, 100, 97, 97, 99, 101, 116, 131, 102, 108, 97, 99, 78, 70, 92, 102, 114, 113, 85, 92, 84, 82, 103, 111, 111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102, 111, 128, 92, 80, 102, 188, 107, 77, 103, 93, 119, 91, 98, 88, 98, 98, 122, 103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2054314053201851, "mean_inference_ms": 0.8045150990944108, "mean_action_processing_ms": 0.08926333607058956, "mean_env_wait_ms": 0.13070820009168455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004130125045776367, "StateBufferConnector_ms": 0.004065275192260742, "ViewRequirementAgentConnector_ms": 0.08360862731933594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.5648527687859, "num_env_steps_trained_throughput_per_sec": 272.5648527687859, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 14745.769, "sample_time_ms": 4997.981, "load_time_ms": 3.193, "load_throughput": 1252741.555, "learn_time_ms": 9738.652, "learn_throughput": 410.734, "synch_weights_time_ms": 5.076}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 813, "training_iteration": 26, "trial_id": "default", "date": "2024-08-30_12-42-29", "timestamp": 1724992949, "time_this_iter_s": 14.682964324951172, "time_total_s": 382.626740694046, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 382.626740694046, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 6.226315789473684, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.1726315789473684, "vram_util_percent0": 0.14014528508771928}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.236699738553776, "policy_loss": 0.001084033327717935, "vf_loss": 9.235518534465502, "vf_explained_var": 0.14287370911208533, "kl": 0.005181777525131887, "entropy": 0.4391013164033172, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -100.88, "episode_len_mean": 101.88, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0, -110.0, -127.0, -91.0, -79.0, -101.0, -187.0, -106.0, -76.0, -102.0, -92.0, -118.0, -90.0, -97.0, -87.0, -97.0, -97.0, -121.0, -102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0, -86.0, -109.0, -90.0, -146.0, -87.0, -92.0, -88.0, -79.0, -102.0, -70.0, -87.0, -96.0, -72.0, -118.0, -84.0, -95.0, -103.0, -103.0, -93.0, -132.0, -104.0, -69.0, -109.0, -133.0, -97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0], "episode_lengths": [111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102, 111, 128, 92, 80, 102, 188, 107, 77, 103, 93, 119, 91, 98, 88, 98, 98, 122, 103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87, 87, 110, 91, 147, 88, 93, 89, 80, 103, 71, 88, 97, 73, 119, 85, 96, 104, 104, 94, 133, 105, 70, 110, 134, 98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20536808199748194, "mean_inference_ms": 0.8041373020486027, "mean_action_processing_ms": 0.08923696673930319, "mean_env_wait_ms": 0.1306659762156919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004241466522216797, "StateBufferConnector_ms": 0.003952503204345703, "ViewRequirementAgentConnector_ms": 0.08014702796936035}}, "episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -100.88, "episode_len_mean": 101.88, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.0, -80.0, -97.0, -117.0, -112.0, -86.0, -109.0, -117.0, -110.0, -89.0, -78.0, -198.0, -89.0, -109.0, -107.0, -113.0, -92.0, -105.0, -78.0, -92.0, -101.0, -110.0, -127.0, -91.0, -79.0, -101.0, -187.0, -106.0, -76.0, -102.0, -92.0, -118.0, -90.0, -97.0, -87.0, -97.0, -97.0, -121.0, -102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0, -86.0, -109.0, -90.0, -146.0, -87.0, -92.0, -88.0, -79.0, -102.0, -70.0, -87.0, -96.0, -72.0, -118.0, -84.0, -95.0, -103.0, -103.0, -93.0, -132.0, -104.0, -69.0, -109.0, -133.0, -97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0], "episode_lengths": [111, 81, 98, 118, 113, 87, 110, 118, 111, 90, 79, 199, 90, 110, 108, 114, 93, 106, 79, 93, 102, 111, 128, 92, 80, 102, 188, 107, 77, 103, 93, 119, 91, 98, 88, 98, 98, 122, 103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87, 87, 110, 91, 147, 88, 93, 89, 80, 103, 71, 88, 97, 73, 119, 85, 96, 104, 104, 94, 133, 105, 70, 110, 134, 98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20536808199748194, "mean_inference_ms": 0.8041373020486027, "mean_action_processing_ms": 0.08923696673930319, "mean_env_wait_ms": 0.1306659762156919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004241466522216797, "StateBufferConnector_ms": 0.003952503204345703, "ViewRequirementAgentConnector_ms": 0.08014702796936035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.55566874478654, "num_env_steps_trained_throughput_per_sec": 270.55566874478654, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 14752.825, "sample_time_ms": 4976.085, "load_time_ms": 3.176, "load_throughput": 1259267.132, "learn_time_ms": 9767.717, "learn_throughput": 409.512, "synch_weights_time_ms": 4.994}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 854, "training_iteration": 27, "trial_id": "default", "date": "2024-08-30_12-42-44", "timestamp": 1724992964, "time_this_iter_s": 14.791464805603027, "time_total_s": 397.41820549964905, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 397.41820549964905, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 5.221052631578948, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.11684210526315789, "vram_util_percent0": 0.14062285841557015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.293550543118549, "policy_loss": -0.0021868140246438725, "vf_loss": 9.295569229125977, "vf_explained_var": 0.13896190684328796, "kl": 0.008966506694164903, "entropy": 0.4171596929591189, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -100.6, "episode_len_mean": 101.6, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0, -86.0, -109.0, -90.0, -146.0, -87.0, -92.0, -88.0, -79.0, -102.0, -70.0, -87.0, -96.0, -72.0, -118.0, -84.0, -95.0, -103.0, -103.0, -93.0, -132.0, -104.0, -69.0, -109.0, -133.0, -97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0, -88.0, -157.0, -99.0, -89.0, -120.0, -203.0, -108.0, -91.0, -87.0, -81.0, -79.0, -111.0, -94.0, -105.0, -111.0, -83.0, -85.0, -91.0, -189.0, -98.0, -88.0, -116.0, -102.0, -133.0, -99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0], "episode_lengths": [103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87, 87, 110, 91, 147, 88, 93, 89, 80, 103, 71, 88, 97, 73, 119, 85, 96, 104, 104, 94, 133, 105, 70, 110, 134, 98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74, 89, 158, 100, 90, 121, 204, 109, 92, 88, 82, 80, 112, 95, 106, 112, 84, 86, 92, 190, 99, 89, 117, 103, 134, 100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2051321551989667, "mean_inference_ms": 0.803268896699856, "mean_action_processing_ms": 0.089141964644565, "mean_env_wait_ms": 0.13053413986027532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004170417785644531, "StateBufferConnector_ms": 0.003838777542114258, "ViewRequirementAgentConnector_ms": 0.07760787010192871}}, "episode_reward_max": -69.0, "episode_reward_min": -243.0, "episode_reward_mean": -100.6, "episode_len_mean": 101.6, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.0, -102.0, -82.0, -92.0, -90.0, -91.0, -96.0, -84.0, -95.0, -91.0, -175.0, -88.0, -80.0, -98.0, -99.0, -88.0, -86.0, -96.0, -106.0, -243.0, -86.0, -86.0, -109.0, -90.0, -146.0, -87.0, -92.0, -88.0, -79.0, -102.0, -70.0, -87.0, -96.0, -72.0, -118.0, -84.0, -95.0, -103.0, -103.0, -93.0, -132.0, -104.0, -69.0, -109.0, -133.0, -97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0, -88.0, -157.0, -99.0, -89.0, -120.0, -203.0, -108.0, -91.0, -87.0, -81.0, -79.0, -111.0, -94.0, -105.0, -111.0, -83.0, -85.0, -91.0, -189.0, -98.0, -88.0, -116.0, -102.0, -133.0, -99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0], "episode_lengths": [103, 103, 83, 93, 91, 92, 97, 85, 96, 92, 176, 89, 81, 99, 100, 89, 87, 97, 107, 244, 87, 87, 110, 91, 147, 88, 93, 89, 80, 103, 71, 88, 97, 73, 119, 85, 96, 104, 104, 94, 133, 105, 70, 110, 134, 98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74, 89, 158, 100, 90, 121, 204, 109, 92, 88, 82, 80, 112, 95, 106, 112, 84, 86, 92, 190, 99, 89, 117, 103, 134, 100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2051321551989667, "mean_inference_ms": 0.803268896699856, "mean_action_processing_ms": 0.089141964644565, "mean_env_wait_ms": 0.13053413986027532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004170417785644531, "StateBufferConnector_ms": 0.003838777542114258, "ViewRequirementAgentConnector_ms": 0.07760787010192871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.7205608284041, "num_env_steps_trained_throughput_per_sec": 277.7205608284041, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 14720.679, "sample_time_ms": 4965.652, "load_time_ms": 3.283, "load_throughput": 1218318.18, "learn_time_ms": 9745.862, "learn_throughput": 410.431, "synch_weights_time_ms": 5.022}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 892, "training_iteration": 28, "trial_id": "default", "date": "2024-08-30_12-42-58", "timestamp": 1724992978, "time_this_iter_s": 14.410677909851074, "time_total_s": 411.8288834095001, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 411.8288834095001, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 5.721052631578948, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.1473684210526316, "vram_util_percent0": 0.14032517817982457}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.098485775404079, "policy_loss": -0.0045913562979749455, "vf_loss": 9.102915849993305, "vf_explained_var": 0.17444842028361496, "kl": 0.0086023430420024, "entropy": 0.4209691817401558, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -70.0, "episode_reward_min": -203.0, "episode_reward_mean": -95.25, "episode_len_mean": 96.25, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0, -88.0, -157.0, -99.0, -89.0, -120.0, -203.0, -108.0, -91.0, -87.0, -81.0, -79.0, -111.0, -94.0, -105.0, -111.0, -83.0, -85.0, -91.0, -189.0, -98.0, -88.0, -116.0, -102.0, -133.0, -99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0, -79.0, -88.0, -93.0, -107.0, -83.0, -100.0, -71.0, -78.0, -83.0, -94.0, -94.0, -98.0, -70.0, -106.0, -85.0, -90.0, -80.0, -91.0, -81.0, -78.0, -87.0, -70.0, -86.0, -82.0, -70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0], "episode_lengths": [98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74, 89, 158, 100, 90, 121, 204, 109, 92, 88, 82, 80, 112, 95, 106, 112, 84, 86, 92, 190, 99, 89, 117, 103, 134, 100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105, 80, 89, 94, 108, 84, 101, 72, 79, 84, 95, 95, 99, 71, 107, 86, 91, 81, 92, 82, 79, 88, 71, 87, 83, 71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20492185846822264, "mean_inference_ms": 0.802395370345422, "mean_action_processing_ms": 0.08904988710614646, "mean_env_wait_ms": 0.1304140104886359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004436969757080078, "StateBufferConnector_ms": 0.003849029541015625, "ViewRequirementAgentConnector_ms": 0.07821345329284668}}, "episode_reward_max": -70.0, "episode_reward_min": -203.0, "episode_reward_mean": -95.25, "episode_len_mean": 96.25, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.0, -90.0, -105.0, -82.0, -92.0, -83.0, -92.0, -72.0, -94.0, -104.0, -116.0, -77.0, -89.0, -92.0, -111.0, -135.0, -73.0, -88.0, -157.0, -99.0, -89.0, -120.0, -203.0, -108.0, -91.0, -87.0, -81.0, -79.0, -111.0, -94.0, -105.0, -111.0, -83.0, -85.0, -91.0, -189.0, -98.0, -88.0, -116.0, -102.0, -133.0, -99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0, -79.0, -88.0, -93.0, -107.0, -83.0, -100.0, -71.0, -78.0, -83.0, -94.0, -94.0, -98.0, -70.0, -106.0, -85.0, -90.0, -80.0, -91.0, -81.0, -78.0, -87.0, -70.0, -86.0, -82.0, -70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0], "episode_lengths": [98, 91, 106, 83, 93, 84, 93, 73, 95, 105, 117, 78, 90, 93, 112, 136, 74, 89, 158, 100, 90, 121, 204, 109, 92, 88, 82, 80, 112, 95, 106, 112, 84, 86, 92, 190, 99, 89, 117, 103, 134, 100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105, 80, 89, 94, 108, 84, 101, 72, 79, 84, 95, 95, 99, 71, 107, 86, 91, 81, 92, 82, 79, 88, 71, 87, 83, 71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20492185846822264, "mean_inference_ms": 0.802395370345422, "mean_action_processing_ms": 0.08904988710614646, "mean_env_wait_ms": 0.1304140104886359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004436969757080078, "StateBufferConnector_ms": 0.003849029541015625, "ViewRequirementAgentConnector_ms": 0.07821345329284668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.3033839715563, "num_env_steps_trained_throughput_per_sec": 272.3033839715563, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 14705.524, "sample_time_ms": 4945.25, "load_time_ms": 3.248, "load_throughput": 1231373.378, "learn_time_ms": 9754.15, "learn_throughput": 410.082, "synch_weights_time_ms": 2.095}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 937, "training_iteration": 29, "trial_id": "default", "date": "2024-08-30_12-43-13", "timestamp": 1724992993, "time_this_iter_s": 14.697394132614136, "time_total_s": 426.52627754211426, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 426.52627754211426, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 6.815789473684211, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.21999999999999997, "vram_util_percent0": 0.14061643366228072}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.195747768238027, "policy_loss": 0.0004618326862973552, "vf_loss": 9.195133658378355, "vf_explained_var": 0.1656949152869563, "kl": 0.008120060773792688, "entropy": 0.39506196453366227, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -70.0, "episode_reward_min": -229.0, "episode_reward_mean": -92.88, "episode_len_mean": 93.88, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0, -79.0, -88.0, -93.0, -107.0, -83.0, -100.0, -71.0, -78.0, -83.0, -94.0, -94.0, -98.0, -70.0, -106.0, -85.0, -90.0, -80.0, -91.0, -81.0, -78.0, -87.0, -70.0, -86.0, -82.0, -70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0, -76.0, -79.0, -92.0, -85.0, -85.0, -202.0, -96.0, -103.0, -83.0, -79.0, -126.0, -97.0, -83.0, -83.0, -75.0, -106.0, -123.0, -79.0, -78.0, -86.0, -121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0], "episode_lengths": [100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105, 80, 89, 94, 108, 84, 101, 72, 79, 84, 95, 95, 99, 71, 107, 86, 91, 81, 92, 82, 79, 88, 71, 87, 83, 71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82, 77, 80, 93, 86, 86, 203, 97, 104, 84, 80, 127, 98, 84, 84, 76, 107, 124, 80, 79, 87, 122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20493962775744856, "mean_inference_ms": 0.8022463051863462, "mean_action_processing_ms": 0.08904413809247348, "mean_env_wait_ms": 0.13040844995025508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004433155059814453, "StateBufferConnector_ms": 0.0038847923278808594, "ViewRequirementAgentConnector_ms": 0.08105945587158203}}, "episode_reward_max": -70.0, "episode_reward_min": -229.0, "episode_reward_mean": -92.88, "episode_len_mean": 93.88, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.0, -84.0, -124.0, -96.0, -87.0, -124.0, -75.0, -79.0, -90.0, -100.0, -98.0, -80.0, -91.0, -104.0, -79.0, -88.0, -93.0, -107.0, -83.0, -100.0, -71.0, -78.0, -83.0, -94.0, -94.0, -98.0, -70.0, -106.0, -85.0, -90.0, -80.0, -91.0, -81.0, -78.0, -87.0, -70.0, -86.0, -82.0, -70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0, -76.0, -79.0, -92.0, -85.0, -85.0, -202.0, -96.0, -103.0, -83.0, -79.0, -126.0, -97.0, -83.0, -83.0, -75.0, -106.0, -123.0, -79.0, -78.0, -86.0, -121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0], "episode_lengths": [100, 85, 125, 97, 88, 125, 76, 80, 91, 101, 99, 81, 92, 105, 80, 89, 94, 108, 84, 101, 72, 79, 84, 95, 95, 99, 71, 107, 86, 91, 81, 92, 82, 79, 88, 71, 87, 83, 71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82, 77, 80, 93, 86, 86, 203, 97, 104, 84, 80, 127, 98, 84, 84, 76, 107, 124, 80, 79, 87, 122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20493962775744856, "mean_inference_ms": 0.8022463051863462, "mean_action_processing_ms": 0.08904413809247348, "mean_env_wait_ms": 0.13040844995025508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004433155059814453, "StateBufferConnector_ms": 0.0038847923278808594, "ViewRequirementAgentConnector_ms": 0.08105945587158203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.66833084139876, "num_env_steps_trained_throughput_per_sec": 274.66833084139876, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 14665.08, "sample_time_ms": 4941.774, "load_time_ms": 3.246, "load_throughput": 1232304.969, "learn_time_ms": 9717.204, "learn_throughput": 411.641, "synch_weights_time_ms": 2.082}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 978, "training_iteration": 30, "trial_id": "default", "date": "2024-08-30_12-43-28", "timestamp": 1724993008, "time_this_iter_s": 14.570472002029419, "time_total_s": 441.0967495441437, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 441.0967495441437, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 6.15263157894737, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.18210526315789477, "vram_util_percent0": 0.13978335731907895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.256552702893494, "policy_loss": -0.0018010045351680888, "vf_loss": 9.258213721039475, "vf_explained_var": 0.15256437409308649, "kl": 0.007465906172832134, "entropy": 0.4130881892737522, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -70.0, "episode_reward_min": -229.0, "episode_reward_mean": -97.36, "episode_len_mean": 98.36, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0, -76.0, -79.0, -92.0, -85.0, -85.0, -202.0, -96.0, -103.0, -83.0, -79.0, -126.0, -97.0, -83.0, -83.0, -75.0, -106.0, -123.0, -79.0, -78.0, -86.0, -121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0, -95.0, -86.0, -102.0, -79.0, -100.0, -109.0, -100.0, -102.0, -113.0, -93.0, -89.0, -94.0, -82.0, -112.0, -86.0, -75.0, -131.0, -75.0, -94.0, -118.0, -90.0, -107.0, -212.0, -91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0], "episode_lengths": [71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82, 77, 80, 93, 86, 86, 203, 97, 104, 84, 80, 127, 98, 84, 84, 76, 107, 124, 80, 79, 87, 122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85, 96, 87, 103, 80, 101, 110, 101, 103, 114, 94, 90, 95, 83, 113, 87, 76, 132, 76, 95, 119, 91, 108, 213, 92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20505462115869183, "mean_inference_ms": 0.8024505698878802, "mean_action_processing_ms": 0.08907708936049709, "mean_env_wait_ms": 0.13045041810716307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043849945068359375, "StateBufferConnector_ms": 0.003966331481933594, "ViewRequirementAgentConnector_ms": 0.08270907402038574}}, "episode_reward_max": -70.0, "episode_reward_min": -229.0, "episode_reward_mean": -97.36, "episode_len_mean": 98.36, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.0, -84.0, -87.0, -96.0, -95.0, -88.0, -84.0, -95.0, -83.0, -89.0, -100.0, -80.0, -75.0, -96.0, -86.0, -79.0, -74.0, -90.0, -181.0, -95.0, -81.0, -76.0, -79.0, -92.0, -85.0, -85.0, -202.0, -96.0, -103.0, -83.0, -79.0, -126.0, -97.0, -83.0, -83.0, -75.0, -106.0, -123.0, -79.0, -78.0, -86.0, -121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0, -95.0, -86.0, -102.0, -79.0, -100.0, -109.0, -100.0, -102.0, -113.0, -93.0, -89.0, -94.0, -82.0, -112.0, -86.0, -75.0, -131.0, -75.0, -94.0, -118.0, -90.0, -107.0, -212.0, -91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0], "episode_lengths": [71, 85, 88, 97, 96, 89, 85, 96, 84, 90, 101, 81, 76, 97, 87, 80, 75, 91, 182, 96, 82, 77, 80, 93, 86, 86, 203, 97, 104, 84, 80, 127, 98, 84, 84, 76, 107, 124, 80, 79, 87, 122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85, 96, 87, 103, 80, 101, 110, 101, 103, 114, 94, 90, 95, 83, 113, 87, 76, 132, 76, 95, 119, 91, 108, 213, 92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20505462115869183, "mean_inference_ms": 0.8024505698878802, "mean_action_processing_ms": 0.08907708936049709, "mean_env_wait_ms": 0.13045041810716307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043849945068359375, "StateBufferConnector_ms": 0.003966331481933594, "ViewRequirementAgentConnector_ms": 0.08270907402038574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.647604165201, "num_env_steps_trained_throughput_per_sec": 271.647604165201, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 14654.576, "sample_time_ms": 4944.237, "load_time_ms": 3.227, "load_throughput": 1239460.693, "learn_time_ms": 9704.24, "learn_throughput": 412.191, "synch_weights_time_ms": 2.096}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1016, "training_iteration": 31, "trial_id": "default", "date": "2024-08-30_12-43-43", "timestamp": 1724993023, "time_this_iter_s": 14.732242345809937, "time_total_s": 455.8289918899536, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 455.8289918899536, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 6.4526315789473685, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.21052631578947373, "vram_util_percent0": 0.1389352898848684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.160065009004326, "policy_loss": -0.0007463486043996708, "vf_loss": 9.160622031714327, "vf_explained_var": 0.1768508888060047, "kl": 0.010095887247580723, "entropy": 0.4093551670351336, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -229.0, "episode_reward_mean": -99.11, "episode_len_mean": 100.11, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0, -95.0, -86.0, -102.0, -79.0, -100.0, -109.0, -100.0, -102.0, -113.0, -93.0, -89.0, -94.0, -82.0, -112.0, -86.0, -75.0, -131.0, -75.0, -94.0, -118.0, -90.0, -107.0, -212.0, -91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0, -178.0, -80.0, -95.0, -117.0, -77.0, -103.0, -98.0, -98.0, -91.0, -98.0, -107.0, -116.0, -99.0, -89.0, -73.0, -98.0, -89.0, -100.0, -97.0, -82.0, -98.0, -100.0, -144.0, -117.0, -89.0, -92.0, -86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0], "episode_lengths": [122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85, 96, 87, 103, 80, 101, 110, 101, 103, 114, 94, 90, 95, 83, 113, 87, 76, 132, 76, 95, 119, 91, 108, 213, 92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89, 179, 81, 96, 118, 78, 104, 99, 99, 92, 99, 108, 117, 100, 90, 74, 99, 90, 101, 98, 83, 99, 101, 145, 118, 90, 93, 87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526306468162606, "mean_inference_ms": 0.8029184274587448, "mean_action_processing_ms": 0.08915039258659985, "mean_env_wait_ms": 0.13054142925619147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042743682861328125, "StateBufferConnector_ms": 0.004073619842529297, "ViewRequirementAgentConnector_ms": 0.08463549613952637}}, "episode_reward_max": -64.0, "episode_reward_min": -229.0, "episode_reward_mean": -99.11, "episode_len_mean": 100.11, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-121.0, -82.0, -87.0, -100.0, -125.0, -229.0, -85.0, -83.0, -92.0, -85.0, -85.0, -78.0, -97.0, -98.0, -83.0, -100.0, -83.0, -82.0, -105.0, -75.0, -84.0, -95.0, -86.0, -102.0, -79.0, -100.0, -109.0, -100.0, -102.0, -113.0, -93.0, -89.0, -94.0, -82.0, -112.0, -86.0, -75.0, -131.0, -75.0, -94.0, -118.0, -90.0, -107.0, -212.0, -91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0, -178.0, -80.0, -95.0, -117.0, -77.0, -103.0, -98.0, -98.0, -91.0, -98.0, -107.0, -116.0, -99.0, -89.0, -73.0, -98.0, -89.0, -100.0, -97.0, -82.0, -98.0, -100.0, -144.0, -117.0, -89.0, -92.0, -86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0], "episode_lengths": [122, 83, 88, 101, 126, 230, 86, 84, 93, 86, 86, 79, 98, 99, 84, 101, 84, 83, 106, 76, 85, 96, 87, 103, 80, 101, 110, 101, 103, 114, 94, 90, 95, 83, 113, 87, 76, 132, 76, 95, 119, 91, 108, 213, 92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89, 179, 81, 96, 118, 78, 104, 99, 99, 92, 99, 108, 117, 100, 90, 74, 99, 90, 101, 98, 83, 99, 101, 145, 118, 90, 93, 87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526306468162606, "mean_inference_ms": 0.8029184274587448, "mean_action_processing_ms": 0.08915039258659985, "mean_env_wait_ms": 0.13054142925619147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042743682861328125, "StateBufferConnector_ms": 0.004073619842529297, "ViewRequirementAgentConnector_ms": 0.08463549613952637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.18443965543355, "num_env_steps_trained_throughput_per_sec": 268.18443965543355, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 14694.321, "sample_time_ms": 4973.814, "load_time_ms": 3.058, "load_throughput": 1307899.841, "learn_time_ms": 9714.59, "learn_throughput": 411.752, "synch_weights_time_ms": 2.094}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1057, "training_iteration": 32, "trial_id": "default", "date": "2024-08-30_12-43-58", "timestamp": 1724993038, "time_this_iter_s": 14.922966718673706, "time_total_s": 470.7519586086273, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 470.7519586086273, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 6.64736842105263, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.1836842105263158, "vram_util_percent0": 0.1386012027138158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.131255232390536, "policy_loss": -0.0007347927749237065, "vf_loss": 9.131818018677414, "vf_explained_var": 0.20833451901712724, "kl": 0.009174829350727375, "entropy": 0.40611976244116343, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -215.0, "episode_reward_mean": -95.28, "episode_len_mean": 96.28, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0, -178.0, -80.0, -95.0, -117.0, -77.0, -103.0, -98.0, -98.0, -91.0, -98.0, -107.0, -116.0, -99.0, -89.0, -73.0, -98.0, -89.0, -100.0, -97.0, -82.0, -98.0, -100.0, -144.0, -117.0, -89.0, -92.0, -86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0, -89.0, -95.0, -84.0, -125.0, -88.0, -109.0, -82.0, -115.0, -73.0, -83.0, -87.0, -78.0, -61.0, -99.0, -99.0, -106.0, -95.0, -87.0, -96.0, -92.0, -110.0, -109.0, -83.0, -87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0], "episode_lengths": [92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89, 179, 81, 96, 118, 78, 104, 99, 99, 92, 99, 108, 117, 100, 90, 74, 99, 90, 101, 98, 83, 99, 101, 145, 118, 90, 93, 87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127, 90, 96, 85, 126, 89, 110, 83, 116, 74, 84, 88, 79, 62, 100, 100, 107, 96, 88, 97, 93, 111, 110, 84, 88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2054139618786399, "mean_inference_ms": 0.8030757200773513, "mean_action_processing_ms": 0.08919237331480825, "mean_env_wait_ms": 0.13059204902280003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250049591064453, "StateBufferConnector_ms": 0.004031181335449219, "ViewRequirementAgentConnector_ms": 0.08382177352905273}}, "episode_reward_max": -61.0, "episode_reward_min": -215.0, "episode_reward_mean": -95.28, "episode_len_mean": 96.28, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-91.0, -86.0, -100.0, -100.0, -101.0, -92.0, -89.0, -102.0, -87.0, -102.0, -70.0, -112.0, -215.0, -74.0, -88.0, -178.0, -80.0, -95.0, -117.0, -77.0, -103.0, -98.0, -98.0, -91.0, -98.0, -107.0, -116.0, -99.0, -89.0, -73.0, -98.0, -89.0, -100.0, -97.0, -82.0, -98.0, -100.0, -144.0, -117.0, -89.0, -92.0, -86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0, -89.0, -95.0, -84.0, -125.0, -88.0, -109.0, -82.0, -115.0, -73.0, -83.0, -87.0, -78.0, -61.0, -99.0, -99.0, -106.0, -95.0, -87.0, -96.0, -92.0, -110.0, -109.0, -83.0, -87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0], "episode_lengths": [92, 87, 101, 101, 102, 93, 90, 103, 88, 103, 71, 113, 216, 75, 89, 179, 81, 96, 118, 78, 104, 99, 99, 92, 99, 108, 117, 100, 90, 74, 99, 90, 101, 98, 83, 99, 101, 145, 118, 90, 93, 87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127, 90, 96, 85, 126, 89, 110, 83, 116, 74, 84, 88, 79, 62, 100, 100, 107, 96, 88, 97, 93, 111, 110, 84, 88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2054139618786399, "mean_inference_ms": 0.8030757200773513, "mean_action_processing_ms": 0.08919237331480825, "mean_env_wait_ms": 0.13059204902280003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250049591064453, "StateBufferConnector_ms": 0.004031181335449219, "ViewRequirementAgentConnector_ms": 0.08382177352905273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.8190808558387, "num_env_steps_trained_throughput_per_sec": 273.8190808558387, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 14686.973, "sample_time_ms": 4961.958, "load_time_ms": 2.988, "load_throughput": 1338685.987, "learn_time_ms": 9719.135, "learn_throughput": 411.559, "synch_weights_time_ms": 2.113}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1101, "training_iteration": 33, "trial_id": "default", "date": "2024-08-30_12-44-12", "timestamp": 1724993052, "time_this_iter_s": 14.61560583114624, "time_total_s": 485.36756443977356, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 485.36756443977356, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 6.3052631578947365, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.18421052631578946, "vram_util_percent0": 0.13877681263706138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.19391551069034, "policy_loss": 0.002638643295053513, "vf_loss": 9.191180377878169, "vf_explained_var": 0.20800665283715852, "kl": 0.005144315056195072, "entropy": 0.4099466060758919, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -181.0, "episode_reward_mean": -93.51, "episode_len_mean": 94.51, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0, -89.0, -95.0, -84.0, -125.0, -88.0, -109.0, -82.0, -115.0, -73.0, -83.0, -87.0, -78.0, -61.0, -99.0, -99.0, -106.0, -95.0, -87.0, -96.0, -92.0, -110.0, -109.0, -83.0, -87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0, -70.0, -95.0, -99.0, -97.0, -96.0, -109.0, -99.0, -77.0, -181.0, -96.0, -100.0, -79.0, -90.0, -83.0, -103.0, -91.0, -93.0, -84.0, -91.0, -96.0, -98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0], "episode_lengths": [87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127, 90, 96, 85, 126, 89, 110, 83, 116, 74, 84, 88, 79, 62, 100, 100, 107, 96, 88, 97, 93, 111, 110, 84, 88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89, 71, 96, 100, 98, 97, 110, 100, 78, 182, 97, 101, 80, 91, 84, 104, 92, 94, 85, 92, 97, 99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20554183760884648, "mean_inference_ms": 0.8031982350024665, "mean_action_processing_ms": 0.08923201178031288, "mean_env_wait_ms": 0.1306358686951195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004364490509033203, "StateBufferConnector_ms": 0.004045724868774414, "ViewRequirementAgentConnector_ms": 0.08394670486450195}}, "episode_reward_max": -61.0, "episode_reward_min": -181.0, "episode_reward_mean": -93.51, "episode_len_mean": 94.51, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.0, -81.0, -95.0, -104.0, -93.0, -93.0, -85.0, -64.0, -85.0, -83.0, -102.0, -91.0, -94.0, -92.0, -126.0, -89.0, -95.0, -84.0, -125.0, -88.0, -109.0, -82.0, -115.0, -73.0, -83.0, -87.0, -78.0, -61.0, -99.0, -99.0, -106.0, -95.0, -87.0, -96.0, -92.0, -110.0, -109.0, -83.0, -87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0, -70.0, -95.0, -99.0, -97.0, -96.0, -109.0, -99.0, -77.0, -181.0, -96.0, -100.0, -79.0, -90.0, -83.0, -103.0, -91.0, -93.0, -84.0, -91.0, -96.0, -98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0], "episode_lengths": [87, 82, 96, 105, 94, 94, 86, 65, 86, 84, 103, 92, 95, 93, 127, 90, 96, 85, 126, 89, 110, 83, 116, 74, 84, 88, 79, 62, 100, 100, 107, 96, 88, 97, 93, 111, 110, 84, 88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89, 71, 96, 100, 98, 97, 110, 100, 78, 182, 97, 101, 80, 91, 84, 104, 92, 94, 85, 92, 97, 99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20554183760884648, "mean_inference_ms": 0.8031982350024665, "mean_action_processing_ms": 0.08923201178031288, "mean_env_wait_ms": 0.1306358686951195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004364490509033203, "StateBufferConnector_ms": 0.004045724868774414, "ViewRequirementAgentConnector_ms": 0.08394670486450195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.51749777937727, "num_env_steps_trained_throughput_per_sec": 272.51749777937727, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 14684.653, "sample_time_ms": 4961.647, "load_time_ms": 2.901, "load_throughput": 1378730.174, "learn_time_ms": 9717.179, "learn_throughput": 411.642, "synch_weights_time_ms": 2.143}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1142, "training_iteration": 34, "trial_id": "default", "date": "2024-08-30_12-44-27", "timestamp": 1724993067, "time_this_iter_s": 14.686434984207153, "time_total_s": 500.0539994239807, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 500.0539994239807, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 5.794736842105263, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.14105263157894735, "vram_util_percent0": 0.13879822848135967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.205220277335053, "policy_loss": 0.002046133084623243, "vf_loss": 9.203052013151106, "vf_explained_var": 0.20448077385143568, "kl": 0.006514454078805019, "entropy": 0.38141921543946833, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -67.0, "episode_reward_min": -221.0, "episode_reward_mean": -98.07, "episode_len_mean": 99.07, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0, -70.0, -95.0, -99.0, -97.0, -96.0, -109.0, -99.0, -77.0, -181.0, -96.0, -100.0, -79.0, -90.0, -83.0, -103.0, -91.0, -93.0, -84.0, -91.0, -96.0, -98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0, -79.0, -86.0, -112.0, -121.0, -107.0, -90.0, -84.0, -89.0, -122.0, -221.0, -83.0, -125.0, -83.0, -80.0, -83.0, -97.0, -116.0, -85.0, -101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0], "episode_lengths": [88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89, 71, 96, 100, 98, 97, 110, 100, 78, 182, 97, 101, 80, 91, 84, 104, 92, 94, 85, 92, 97, 99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113, 80, 87, 113, 122, 108, 91, 85, 90, 123, 222, 84, 126, 84, 81, 84, 98, 117, 86, 102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20563316133192053, "mean_inference_ms": 0.8033517843156294, "mean_action_processing_ms": 0.08925852645180843, "mean_env_wait_ms": 0.13065366495967054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374504089355469, "StateBufferConnector_ms": 0.0040624141693115234, "ViewRequirementAgentConnector_ms": 0.08322429656982422}}, "episode_reward_max": -67.0, "episode_reward_min": -221.0, "episode_reward_mean": -98.07, "episode_len_mean": 99.07, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-87.0, -92.0, -86.0, -111.0, -114.0, -77.0, -71.0, -119.0, -105.0, -87.0, -95.0, -83.0, -67.0, -118.0, -81.0, -71.0, -76.0, -74.0, -74.0, -99.0, -88.0, -70.0, -95.0, -99.0, -97.0, -96.0, -109.0, -99.0, -77.0, -181.0, -96.0, -100.0, -79.0, -90.0, -83.0, -103.0, -91.0, -93.0, -84.0, -91.0, -96.0, -98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0, -79.0, -86.0, -112.0, -121.0, -107.0, -90.0, -84.0, -89.0, -122.0, -221.0, -83.0, -125.0, -83.0, -80.0, -83.0, -97.0, -116.0, -85.0, -101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0], "episode_lengths": [88, 93, 87, 112, 115, 78, 72, 120, 106, 88, 96, 84, 68, 119, 82, 72, 77, 75, 75, 100, 89, 71, 96, 100, 98, 97, 110, 100, 78, 182, 97, 101, 80, 91, 84, 104, 92, 94, 85, 92, 97, 99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113, 80, 87, 113, 122, 108, 91, 85, 90, 123, 222, 84, 126, 84, 81, 84, 98, 117, 86, 102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20563316133192053, "mean_inference_ms": 0.8033517843156294, "mean_action_processing_ms": 0.08925852645180843, "mean_env_wait_ms": 0.13065366495967054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374504089355469, "StateBufferConnector_ms": 0.0040624141693115234, "ViewRequirementAgentConnector_ms": 0.08322429656982422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.9554251069576, "num_env_steps_trained_throughput_per_sec": 271.9554251069576, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 14674.934, "sample_time_ms": 4948.696, "load_time_ms": 2.896, "load_throughput": 1381250.082, "learn_time_ms": 9720.444, "learn_throughput": 411.504, "synch_weights_time_ms": 2.117}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1180, "training_iteration": 35, "trial_id": "default", "date": "2024-08-30_12-44-42", "timestamp": 1724993082, "time_this_iter_s": 14.715798616409302, "time_total_s": 514.76979804039, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 514.76979804039, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 5.56842105263158, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.12894736842105264, "vram_util_percent0": 0.13912803248355263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.205534178210844, "policy_loss": 0.0019844675777099465, "vf_loss": 9.203435394328128, "vf_explained_var": 0.2541414269837, "kl": 0.006097397269411383, "entropy": 0.3480684918421571, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -221.0, "episode_reward_mean": -99.08, "episode_len_mean": 100.08, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0, -79.0, -86.0, -112.0, -121.0, -107.0, -90.0, -84.0, -89.0, -122.0, -221.0, -83.0, -125.0, -83.0, -80.0, -83.0, -97.0, -116.0, -85.0, -101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0, -101.0, -97.0, -100.0, -88.0, -85.0, -91.0, -151.0, -75.0, -86.0, -87.0, -82.0, -68.0, -82.0, -92.0, -93.0, -93.0, -104.0, -125.0, -86.0, -100.0, -71.0, -100.0, -78.0, -93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0], "episode_lengths": [99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113, 80, 87, 113, 122, 108, 91, 85, 90, 123, 222, 84, 126, 84, 81, 84, 98, 117, 86, 102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96, 102, 98, 101, 89, 86, 92, 152, 76, 87, 88, 83, 69, 83, 93, 94, 94, 105, 126, 87, 101, 72, 101, 79, 94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20577097519004148, "mean_inference_ms": 0.8036540089402573, "mean_action_processing_ms": 0.08930494569904296, "mean_env_wait_ms": 0.13069210600495726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00452423095703125, "StateBufferConnector_ms": 0.004076480865478516, "ViewRequirementAgentConnector_ms": 0.08403849601745605}}, "episode_reward_max": -62.0, "episode_reward_min": -221.0, "episode_reward_mean": -99.08, "episode_len_mean": 100.08, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.0, -74.0, -82.0, -118.0, -84.0, -110.0, -81.0, -76.0, -117.0, -92.0, -115.0, -74.0, -86.0, -107.0, -104.0, -131.0, -93.0, -108.0, -84.0, -82.0, -112.0, -79.0, -86.0, -112.0, -121.0, -107.0, -90.0, -84.0, -89.0, -122.0, -221.0, -83.0, -125.0, -83.0, -80.0, -83.0, -97.0, -116.0, -85.0, -101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0, -101.0, -97.0, -100.0, -88.0, -85.0, -91.0, -151.0, -75.0, -86.0, -87.0, -82.0, -68.0, -82.0, -92.0, -93.0, -93.0, -104.0, -125.0, -86.0, -100.0, -71.0, -100.0, -78.0, -93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0], "episode_lengths": [99, 75, 83, 119, 85, 111, 82, 77, 118, 93, 116, 75, 87, 108, 105, 132, 94, 109, 85, 83, 113, 80, 87, 113, 122, 108, 91, 85, 90, 123, 222, 84, 126, 84, 81, 84, 98, 117, 86, 102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96, 102, 98, 101, 89, 86, 92, 152, 76, 87, 88, 83, 69, 83, 93, 94, 94, 105, 126, 87, 101, 72, 101, 79, 94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20577097519004148, "mean_inference_ms": 0.8036540089402573, "mean_action_processing_ms": 0.08930494569904296, "mean_env_wait_ms": 0.13069210600495726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00452423095703125, "StateBufferConnector_ms": 0.004076480865478516, "ViewRequirementAgentConnector_ms": 0.08403849601745605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.86053095208797, "num_env_steps_trained_throughput_per_sec": 268.86053095208797, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14695.154, "sample_time_ms": 4964.043, "load_time_ms": 2.915, "load_throughput": 1372290.83, "learn_time_ms": 9725.292, "learn_throughput": 411.299, "synch_weights_time_ms": 2.121}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1221, "training_iteration": 36, "trial_id": "default", "date": "2024-08-30_12-44-57", "timestamp": 1724993097, "time_this_iter_s": 14.885400295257568, "time_total_s": 529.6551983356476, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 529.6551983356476, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 6.536842105263157, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.20473684210526316, "vram_util_percent0": 0.13893100671600878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.189753363209386, "policy_loss": -0.0002502804401741233, "vf_loss": 9.18978128330682, "vf_explained_var": 0.13312420441258338, "kl": 0.011857461686054865, "entropy": 0.3284185225124, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -500.0, "episode_reward_mean": -100.28, "episode_len_mean": 101.27, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0, -101.0, -97.0, -100.0, -88.0, -85.0, -91.0, -151.0, -75.0, -86.0, -87.0, -82.0, -68.0, -82.0, -92.0, -93.0, -93.0, -104.0, -125.0, -86.0, -100.0, -71.0, -100.0, -78.0, -93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0, -88.0, -99.0, -81.0, -95.0, -78.0, -101.0, -77.0, -100.0, -108.0, -86.0, -107.0, -86.0, -83.0, -86.0, -94.0, -77.0, -78.0, -146.0, -75.0, -79.0, -80.0, -79.0, -82.0, -119.0, -99.0, -86.0, -96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0], "episode_lengths": [102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96, 102, 98, 101, 89, 86, 92, 152, 76, 87, 88, 83, 69, 83, 93, 94, 94, 105, 126, 87, 101, 72, 101, 79, 94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89, 89, 100, 82, 96, 79, 102, 78, 101, 109, 87, 108, 87, 84, 87, 95, 78, 79, 147, 76, 80, 81, 80, 83, 120, 100, 87, 97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2058401259093108, "mean_inference_ms": 0.8037159184895701, "mean_action_processing_ms": 0.08933277836174529, "mean_env_wait_ms": 0.13071159035237817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004376888275146484, "StateBufferConnector_ms": 0.003987789154052734, "ViewRequirementAgentConnector_ms": 0.08253359794616699}}, "episode_reward_max": -62.0, "episode_reward_min": -500.0, "episode_reward_mean": -100.28, "episode_len_mean": 101.27, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.0, -123.0, -86.0, -90.0, -102.0, -149.0, -75.0, -89.0, -76.0, -142.0, -84.0, -112.0, -130.0, -116.0, -78.0, -77.0, -200.0, -80.0, -107.0, -95.0, -101.0, -97.0, -100.0, -88.0, -85.0, -91.0, -151.0, -75.0, -86.0, -87.0, -82.0, -68.0, -82.0, -92.0, -93.0, -93.0, -104.0, -125.0, -86.0, -100.0, -71.0, -100.0, -78.0, -93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0, -88.0, -99.0, -81.0, -95.0, -78.0, -101.0, -77.0, -100.0, -108.0, -86.0, -107.0, -86.0, -83.0, -86.0, -94.0, -77.0, -78.0, -146.0, -75.0, -79.0, -80.0, -79.0, -82.0, -119.0, -99.0, -86.0, -96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0], "episode_lengths": [102, 124, 87, 91, 103, 150, 76, 90, 77, 143, 85, 113, 131, 117, 79, 78, 201, 81, 108, 96, 102, 98, 101, 89, 86, 92, 152, 76, 87, 88, 83, 69, 83, 93, 94, 94, 105, 126, 87, 101, 72, 101, 79, 94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89, 89, 100, 82, 96, 79, 102, 78, 101, 109, 87, 108, 87, 84, 87, 95, 78, 79, 147, 76, 80, 81, 80, 83, 120, 100, 87, 97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2058401259093108, "mean_inference_ms": 0.8037159184895701, "mean_action_processing_ms": 0.08933277836174529, "mean_env_wait_ms": 0.13071159035237817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004376888275146484, "StateBufferConnector_ms": 0.003987789154052734, "ViewRequirementAgentConnector_ms": 0.08253359794616699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.41517310981317, "num_env_steps_trained_throughput_per_sec": 273.41517310981317, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 14679.69, "sample_time_ms": 4975.955, "load_time_ms": 2.94, "load_throughput": 1360671.527, "learn_time_ms": 9697.869, "learn_throughput": 412.462, "synch_weights_time_ms": 2.14}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1260, "training_iteration": 37, "trial_id": "default", "date": "2024-08-30_12-45-11", "timestamp": 1724993111, "time_this_iter_s": 14.637096643447876, "time_total_s": 544.2922949790955, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 544.2922949790955, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 6.173684210526316, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.18052631578947373, "vram_util_percent0": 0.1387339809484649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.005958135666386, "policy_loss": -0.0032044405798598, "vf_loss": 9.008937317837951, "vf_explained_var": 0.23524508636484864, "kl": 0.012014576985344012, "entropy": 0.36633299118088136, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -500.0, "episode_reward_mean": -96.72, "episode_len_mean": 97.71, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0, -88.0, -99.0, -81.0, -95.0, -78.0, -101.0, -77.0, -100.0, -108.0, -86.0, -107.0, -86.0, -83.0, -86.0, -94.0, -77.0, -78.0, -146.0, -75.0, -79.0, -80.0, -79.0, -82.0, -119.0, -99.0, -86.0, -96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0, -89.0, -83.0, -100.0, -97.0, -95.0, -81.0, -94.0, -104.0, -67.0, -80.0, -94.0, -79.0, -90.0, -85.0, -105.0, -93.0, -68.0, -74.0, -80.0, -88.0, -76.0, -77.0, -104.0, -87.0, -92.0, -132.0, -116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0], "episode_lengths": [94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89, 89, 100, 82, 96, 79, 102, 78, 101, 109, 87, 108, 87, 84, 87, 95, 78, 79, 147, 76, 80, 81, 80, 83, 120, 100, 87, 97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96, 90, 84, 101, 98, 96, 82, 95, 105, 68, 81, 95, 80, 91, 86, 106, 94, 69, 75, 81, 89, 77, 78, 105, 88, 93, 133, 117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20585866323991328, "mean_inference_ms": 0.8035840218148027, "mean_action_processing_ms": 0.08934086959345766, "mean_env_wait_ms": 0.1307126641556764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043184757232666016, "StateBufferConnector_ms": 0.003902435302734375, "ViewRequirementAgentConnector_ms": 0.08156991004943848}}, "episode_reward_max": -62.0, "episode_reward_min": -500.0, "episode_reward_mean": -96.72, "episode_len_mean": 97.71, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.0, -98.0, -104.0, -143.0, -100.0, -179.0, -99.0, -86.0, -90.0, -97.0, -86.0, -100.0, -62.0, -89.0, -82.0, -85.0, -89.0, -88.0, -88.0, -99.0, -81.0, -95.0, -78.0, -101.0, -77.0, -100.0, -108.0, -86.0, -107.0, -86.0, -83.0, -86.0, -94.0, -77.0, -78.0, -146.0, -75.0, -79.0, -80.0, -79.0, -82.0, -119.0, -99.0, -86.0, -96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0, -89.0, -83.0, -100.0, -97.0, -95.0, -81.0, -94.0, -104.0, -67.0, -80.0, -94.0, -79.0, -90.0, -85.0, -105.0, -93.0, -68.0, -74.0, -80.0, -88.0, -76.0, -77.0, -104.0, -87.0, -92.0, -132.0, -116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0], "episode_lengths": [94, 99, 105, 144, 101, 180, 100, 87, 91, 98, 87, 101, 63, 90, 83, 86, 90, 89, 89, 100, 82, 96, 79, 102, 78, 101, 109, 87, 108, 87, 84, 87, 95, 78, 79, 147, 76, 80, 81, 80, 83, 120, 100, 87, 97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96, 90, 84, 101, 98, 96, 82, 95, 105, 68, 81, 95, 80, 91, 86, 106, 94, 69, 75, 81, 89, 77, 78, 105, 88, 93, 133, 117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20585866323991328, "mean_inference_ms": 0.8035840218148027, "mean_action_processing_ms": 0.08934086959345766, "mean_env_wait_ms": 0.1307126641556764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043184757232666016, "StateBufferConnector_ms": 0.003902435302734375, "ViewRequirementAgentConnector_ms": 0.08156991004943848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.78226238719833, "num_env_steps_trained_throughput_per_sec": 274.78226238719833, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 14695.092, "sample_time_ms": 4991.494, "load_time_ms": 2.851, "load_throughput": 1402859.365, "learn_time_ms": 9697.819, "learn_throughput": 412.464, "synch_weights_time_ms": 2.143}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1303, "training_iteration": 38, "trial_id": "default", "date": "2024-08-30_12-45-26", "timestamp": 1724993126, "time_this_iter_s": 14.564709424972534, "time_total_s": 558.857004404068, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 558.857004404068, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 5.873684210526315, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.18210526315789477, "vram_util_percent0": 0.13923725328947367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.933858196197017, "policy_loss": -0.000887050151184041, "vf_loss": 8.934466880880377, "vf_explained_var": 0.23246772289276124, "kl": 0.01484529066392431, "entropy": 0.37301011005396484, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -65.0, "episode_reward_min": -500.0, "episode_reward_mean": -95.48, "episode_len_mean": 96.47, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0, -89.0, -83.0, -100.0, -97.0, -95.0, -81.0, -94.0, -104.0, -67.0, -80.0, -94.0, -79.0, -90.0, -85.0, -105.0, -93.0, -68.0, -74.0, -80.0, -88.0, -76.0, -77.0, -104.0, -87.0, -92.0, -132.0, -116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0, -105.0, -92.0, -88.0, -88.0, -95.0, -96.0, -84.0, -99.0, -65.0, -82.0, -83.0, -125.0, -83.0, -131.0, -108.0, -108.0, -79.0, -74.0, -84.0, -70.0, -78.0, -98.0, -85.0, -114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0], "episode_lengths": [97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96, 90, 84, 101, 98, 96, 82, 95, 105, 68, 81, 95, 80, 91, 86, 106, 94, 69, 75, 81, 89, 77, 78, 105, 88, 93, 133, 117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86, 106, 93, 89, 89, 96, 97, 85, 100, 66, 83, 84, 126, 84, 132, 109, 109, 80, 75, 85, 71, 79, 99, 86, 115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20591078676175045, "mean_inference_ms": 0.8035367851130394, "mean_action_processing_ms": 0.08935172342754835, "mean_env_wait_ms": 0.1307172033513055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224061965942383, "StateBufferConnector_ms": 0.0038614273071289062, "ViewRequirementAgentConnector_ms": 0.08170676231384277}}, "episode_reward_max": -65.0, "episode_reward_min": -500.0, "episode_reward_mean": -95.48, "episode_len_mean": 96.47, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-96.0, -500.0, -110.0, -79.0, -81.0, -97.0, -93.0, -98.0, -97.0, -101.0, -97.0, -98.0, -95.0, -89.0, -83.0, -100.0, -97.0, -95.0, -81.0, -94.0, -104.0, -67.0, -80.0, -94.0, -79.0, -90.0, -85.0, -105.0, -93.0, -68.0, -74.0, -80.0, -88.0, -76.0, -77.0, -104.0, -87.0, -92.0, -132.0, -116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0, -105.0, -92.0, -88.0, -88.0, -95.0, -96.0, -84.0, -99.0, -65.0, -82.0, -83.0, -125.0, -83.0, -131.0, -108.0, -108.0, -79.0, -74.0, -84.0, -70.0, -78.0, -98.0, -85.0, -114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0], "episode_lengths": [97, 500, 111, 80, 82, 98, 94, 99, 98, 102, 98, 99, 96, 90, 84, 101, 98, 96, 82, 95, 105, 68, 81, 95, 80, 91, 86, 106, 94, 69, 75, 81, 89, 77, 78, 105, 88, 93, 133, 117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86, 106, 93, 89, 89, 96, 97, 85, 100, 66, 83, 84, 126, 84, 132, 109, 109, 80, 75, 85, 71, 79, 99, 86, 115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20591078676175045, "mean_inference_ms": 0.8035367851130394, "mean_action_processing_ms": 0.08935172342754835, "mean_env_wait_ms": 0.1307172033513055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224061965942383, "StateBufferConnector_ms": 0.0038614273071289062, "ViewRequirementAgentConnector_ms": 0.08170676231384277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.823631126698, "num_env_steps_trained_throughput_per_sec": 267.823631126698, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 14719.664, "sample_time_ms": 5005.126, "load_time_ms": 2.879, "load_throughput": 1389463.502, "learn_time_ms": 9708.719, "learn_throughput": 412.001, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1347, "training_iteration": 39, "trial_id": "default", "date": "2024-08-30_12-45-41", "timestamp": 1724993141, "time_this_iter_s": 14.94377875328064, "time_total_s": 573.8007831573486, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 573.8007831573486, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 9.199999999999998, "gpu_util_percent0": 0.17263157894736844, "vram_util_percent0": 0.13904236910635964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.104976808896629, "policy_loss": 0.001358134001092885, "vf_loss": 9.103528232471918, "vf_explained_var": 0.24439413124515164, "kl": 0.004823384430788265, "entropy": 0.3871818141110482, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -65.0, "episode_reward_min": -268.0, "episode_reward_mean": -95.17, "episode_len_mean": 96.17, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0, -105.0, -92.0, -88.0, -88.0, -95.0, -96.0, -84.0, -99.0, -65.0, -82.0, -83.0, -125.0, -83.0, -131.0, -108.0, -108.0, -79.0, -74.0, -84.0, -70.0, -78.0, -98.0, -85.0, -114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0, -98.0, -72.0, -93.0, -78.0, -68.0, -152.0, -91.0, -137.0, -83.0, -87.0, -84.0, -88.0, -111.0, -89.0, -104.0, -131.0, -117.0, -71.0, -85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0], "episode_lengths": [117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86, 106, 93, 89, 89, 96, 97, 85, 100, 66, 83, 84, 126, 84, 132, 109, 109, 80, 75, 85, 71, 79, 99, 86, 115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91, 99, 73, 94, 79, 69, 153, 92, 138, 84, 88, 85, 89, 112, 90, 105, 132, 118, 72, 86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060097636040252, "mean_inference_ms": 0.8037081996319276, "mean_action_processing_ms": 0.089387442830779, "mean_env_wait_ms": 0.1307504404619062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004301786422729492, "StateBufferConnector_ms": 0.003939151763916016, "ViewRequirementAgentConnector_ms": 0.08333182334899902}}, "episode_reward_max": -65.0, "episode_reward_min": -268.0, "episode_reward_mean": -95.17, "episode_len_mean": 96.17, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.0, -96.0, -107.0, -85.0, -71.0, -88.0, -81.0, -103.0, -98.0, -107.0, -85.0, -96.0, -86.0, -82.0, -93.0, -98.0, -85.0, -105.0, -92.0, -88.0, -88.0, -95.0, -96.0, -84.0, -99.0, -65.0, -82.0, -83.0, -125.0, -83.0, -131.0, -108.0, -108.0, -79.0, -74.0, -84.0, -70.0, -78.0, -98.0, -85.0, -114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0, -98.0, -72.0, -93.0, -78.0, -68.0, -152.0, -91.0, -137.0, -83.0, -87.0, -84.0, -88.0, -111.0, -89.0, -104.0, -131.0, -117.0, -71.0, -85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0], "episode_lengths": [117, 97, 108, 86, 72, 89, 82, 104, 99, 108, 86, 97, 87, 83, 94, 99, 86, 106, 93, 89, 89, 96, 97, 85, 100, 66, 83, 84, 126, 84, 132, 109, 109, 80, 75, 85, 71, 79, 99, 86, 115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91, 99, 73, 94, 79, 69, 153, 92, 138, 84, 88, 85, 89, 112, 90, 105, 132, 118, 72, 86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060097636040252, "mean_inference_ms": 0.8037081996319276, "mean_action_processing_ms": 0.089387442830779, "mean_env_wait_ms": 0.1307504404619062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004301786422729492, "StateBufferConnector_ms": 0.003939151763916016, "ViewRequirementAgentConnector_ms": 0.08333182334899902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.8202642557694, "num_env_steps_trained_throughput_per_sec": 269.8202642557694, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14745.83, "sample_time_ms": 5004.97, "load_time_ms": 2.883, "load_throughput": 1387211.721, "learn_time_ms": 9735.033, "learn_throughput": 410.887, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1386, "training_iteration": 40, "trial_id": "default", "date": "2024-08-30_12-45-56", "timestamp": 1724993156, "time_this_iter_s": 14.832297086715698, "time_total_s": 588.6330802440643, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 588.6330802440643, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 6.705263157894738, "ram_util_percent": 9.263157894736842, "gpu_util_percent0": 0.20421052631578948, "vram_util_percent0": 0.13306306537828946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.10825573962222, "policy_loss": -0.003084714354206157, "vf_loss": 9.111247456971036, "vf_explained_var": 0.2486021181588532, "kl": 0.009917088094852932, "entropy": 0.39945538989318313, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -68.0, "episode_reward_min": -268.0, "episode_reward_mean": -98.17, "episode_len_mean": 99.17, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0, -98.0, -72.0, -93.0, -78.0, -68.0, -152.0, -91.0, -137.0, -83.0, -87.0, -84.0, -88.0, -111.0, -89.0, -104.0, -131.0, -117.0, -71.0, -85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0, -194.0, -78.0, -101.0, -84.0, -94.0, -88.0, -143.0, -115.0, -155.0, -96.0, -90.0, -122.0, -79.0, -78.0, -94.0, -131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0], "episode_lengths": [115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91, 99, 73, 94, 79, 69, 153, 92, 138, 84, 88, 85, 89, 112, 90, 105, 132, 118, 72, 86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89, 195, 79, 102, 85, 95, 89, 144, 116, 156, 97, 91, 123, 80, 79, 95, 132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061328549636773, "mean_inference_ms": 0.8040035810640245, "mean_action_processing_ms": 0.08943944978044209, "mean_env_wait_ms": 0.13080444383070344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004536867141723633, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.08424234390258789}}, "episode_reward_max": -68.0, "episode_reward_min": -268.0, "episode_reward_mean": -98.17, "episode_len_mean": 99.17, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.0, -99.0, -95.0, -82.0, -96.0, -117.0, -104.0, -89.0, -84.0, -80.0, -82.0, -71.0, -74.0, -81.0, -85.0, -95.0, -97.0, -101.0, -86.0, -93.0, -90.0, -98.0, -72.0, -93.0, -78.0, -68.0, -152.0, -91.0, -137.0, -83.0, -87.0, -84.0, -88.0, -111.0, -89.0, -104.0, -131.0, -117.0, -71.0, -85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0, -194.0, -78.0, -101.0, -84.0, -94.0, -88.0, -143.0, -115.0, -155.0, -96.0, -90.0, -122.0, -79.0, -78.0, -94.0, -131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0], "episode_lengths": [115, 100, 96, 83, 97, 118, 105, 90, 85, 81, 83, 72, 75, 82, 86, 96, 98, 102, 87, 94, 91, 99, 73, 94, 79, 69, 153, 92, 138, 84, 88, 85, 89, 112, 90, 105, 132, 118, 72, 86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89, 195, 79, 102, 85, 95, 89, 144, 116, 156, 97, 91, 123, 80, 79, 95, 132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061328549636773, "mean_inference_ms": 0.8040035810640245, "mean_action_processing_ms": 0.08943944978044209, "mean_env_wait_ms": 0.13080444383070344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004536867141723633, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.08424234390258789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.60229859486174, "num_env_steps_trained_throughput_per_sec": 266.60229859486174, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 14773.699, "sample_time_ms": 5011.523, "load_time_ms": 2.93, "load_throughput": 1365322.222, "learn_time_ms": 9756.319, "learn_throughput": 409.991, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1426, "training_iteration": 41, "trial_id": "default", "date": "2024-08-30_12-46-11", "timestamp": 1724993171, "time_this_iter_s": 15.010759115219116, "time_total_s": 603.6438393592834, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 603.6438393592834, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 6.51, "ram_util_percent": 9.5, "gpu_util_percent0": 0.1945, "vram_util_percent0": 0.11319986979166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.216551098772275, "policy_loss": 2.370547022550337e-05, "vf_loss": 9.216421606207406, "vf_explained_var": 0.27576818312368084, "kl": 0.011282661282760315, "entropy": 0.4325211113178602, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -268.0, "episode_reward_mean": -101.52, "episode_len_mean": 102.52, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0, -194.0, -78.0, -101.0, -84.0, -94.0, -88.0, -143.0, -115.0, -155.0, -96.0, -90.0, -122.0, -79.0, -78.0, -94.0, -131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0, -202.0, -113.0, -134.0, -99.0, -82.0, -93.0, -85.0, -121.0, -86.0, -105.0, -90.0, -105.0, -81.0, -80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0], "episode_lengths": [86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89, 195, 79, 102, 85, 95, 89, 144, 116, 156, 97, 91, 123, 80, 79, 95, 132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93, 203, 114, 135, 100, 83, 94, 86, 122, 87, 106, 91, 106, 82, 81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20613588065328003, "mean_inference_ms": 0.803996749317199, "mean_action_processing_ms": 0.08945213994360718, "mean_env_wait_ms": 0.13081780471511106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004611015319824219, "StateBufferConnector_ms": 0.0039522647857666016, "ViewRequirementAgentConnector_ms": 0.08209228515625}}, "episode_reward_max": -69.0, "episode_reward_min": -268.0, "episode_reward_mean": -101.52, "episode_len_mean": 102.52, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.0, -83.0, -83.0, -95.0, -77.0, -100.0, -193.0, -96.0, -102.0, -77.0, -77.0, -80.0, -268.0, -94.0, -90.0, -100.0, -84.0, -105.0, -95.0, -99.0, -88.0, -194.0, -78.0, -101.0, -84.0, -94.0, -88.0, -143.0, -115.0, -155.0, -96.0, -90.0, -122.0, -79.0, -78.0, -94.0, -131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0, -202.0, -113.0, -134.0, -99.0, -82.0, -93.0, -85.0, -121.0, -86.0, -105.0, -90.0, -105.0, -81.0, -80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0], "episode_lengths": [86, 84, 84, 96, 78, 101, 194, 97, 103, 78, 78, 81, 269, 95, 91, 101, 85, 106, 96, 100, 89, 195, 79, 102, 85, 95, 89, 144, 116, 156, 97, 91, 123, 80, 79, 95, 132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93, 203, 114, 135, 100, 83, 94, 86, 122, 87, 106, 91, 106, 82, 81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20613588065328003, "mean_inference_ms": 0.803996749317199, "mean_action_processing_ms": 0.08945213994360718, "mean_env_wait_ms": 0.13081780471511106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004611015319824219, "StateBufferConnector_ms": 0.0039522647857666016, "ViewRequirementAgentConnector_ms": 0.08209228515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.76861765199084, "num_env_steps_trained_throughput_per_sec": 271.76861765199084, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 14754.027, "sample_time_ms": 4983.166, "load_time_ms": 3.102, "load_throughput": 1289543.281, "learn_time_ms": 9764.799, "learn_throughput": 409.635, "synch_weights_time_ms": 2.161}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 1465, "training_iteration": 42, "trial_id": "default", "date": "2024-08-30_12-46-26", "timestamp": 1724993186, "time_this_iter_s": 14.726132154464722, "time_total_s": 618.3699715137482, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 618.3699715137482, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 5.268421052631578, "ram_util_percent": 9.5, "gpu_util_percent0": 0.1236842105263158, "vram_util_percent0": 0.11333050644188597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.215597438299527, "policy_loss": 0.002106453965027486, "vf_loss": 9.213430788183725, "vf_explained_var": 0.2764707910758193, "kl": 0.0064224632620699185, "entropy": 0.4436662106744705, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -202.0, "episode_reward_mean": -102.17, "episode_len_mean": 103.17, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0, -202.0, -113.0, -134.0, -99.0, -82.0, -93.0, -85.0, -121.0, -86.0, -105.0, -90.0, -105.0, -81.0, -80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0, -93.0, -96.0, -91.0, -98.0, -94.0, -121.0, -108.0, -86.0, -90.0, -88.0, -96.0, -77.0, -89.0, -141.0, -85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0], "episode_lengths": [132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93, 203, 114, 135, 100, 83, 94, 86, 122, 87, 106, 91, 106, 82, 81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79, 94, 97, 92, 99, 95, 122, 109, 87, 91, 89, 97, 78, 90, 142, 86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060501627212249, "mean_inference_ms": 0.8037974640445392, "mean_action_processing_ms": 0.08942391759843012, "mean_env_wait_ms": 0.1307742444521657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004467010498046875, "StateBufferConnector_ms": 0.003871440887451172, "ViewRequirementAgentConnector_ms": 0.08077597618103027}}, "episode_reward_max": -69.0, "episode_reward_min": -202.0, "episode_reward_mean": -102.17, "episode_len_mean": 103.17, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-131.0, -97.0, -81.0, -76.0, -87.0, -80.0, -76.0, -92.0, -130.0, -94.0, -114.0, -108.0, -90.0, -76.0, -100.0, -100.0, -85.0, -107.0, -81.0, -131.0, -69.0, -82.0, -78.0, -109.0, -92.0, -202.0, -113.0, -134.0, -99.0, -82.0, -93.0, -85.0, -121.0, -86.0, -105.0, -90.0, -105.0, -81.0, -80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0, -93.0, -96.0, -91.0, -98.0, -94.0, -121.0, -108.0, -86.0, -90.0, -88.0, -96.0, -77.0, -89.0, -141.0, -85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0], "episode_lengths": [132, 98, 82, 77, 88, 81, 77, 93, 131, 95, 115, 109, 91, 77, 101, 101, 86, 108, 82, 132, 70, 83, 79, 110, 93, 203, 114, 135, 100, 83, 94, 86, 122, 87, 106, 91, 106, 82, 81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79, 94, 97, 92, 99, 95, 122, 109, 87, 91, 89, 97, 78, 90, 142, 86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2060501627212249, "mean_inference_ms": 0.8037974640445392, "mean_action_processing_ms": 0.08942391759843012, "mean_env_wait_ms": 0.1307742444521657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004467010498046875, "StateBufferConnector_ms": 0.003871440887451172, "ViewRequirementAgentConnector_ms": 0.08077597618103027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.86670602208596, "num_env_steps_trained_throughput_per_sec": 273.86670602208596, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 14753.775, "sample_time_ms": 4981.531, "load_time_ms": 3.139, "load_throughput": 1274128.619, "learn_time_ms": 9766.161, "learn_throughput": 409.578, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 1501, "training_iteration": 43, "trial_id": "default", "date": "2024-08-30_12-46-40", "timestamp": 1724993200, "time_this_iter_s": 14.612972497940063, "time_total_s": 632.9829440116882, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 632.9829440116882, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 5.3736842105263145, "ram_util_percent": 9.5, "gpu_util_percent0": 0.15947368421052632, "vram_util_percent0": 0.11400510553728069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.1781140388981, "policy_loss": 0.0011890735136725569, "vf_loss": 9.176885102384833, "vf_explained_var": 0.260780039141255, "kl": 0.00424902466994025, "entropy": 0.370489651221101, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -75.0, "episode_reward_min": -217.0, "episode_reward_mean": -105.06, "episode_len_mean": 106.06, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0, -93.0, -96.0, -91.0, -98.0, -94.0, -121.0, -108.0, -86.0, -90.0, -88.0, -96.0, -77.0, -89.0, -141.0, -85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0, -141.0, -96.0, -103.0, -199.0, -95.0, -80.0, -109.0, -106.0, -89.0, -132.0, -88.0, -201.0, -81.0, -93.0, -88.0, -103.0, -97.0, -88.0, -89.0, -108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0], "episode_lengths": [81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79, 94, 97, 92, 99, 95, 122, 109, 87, 91, 89, 97, 78, 90, 142, 86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121, 142, 97, 104, 200, 96, 81, 110, 107, 90, 133, 89, 202, 82, 94, 89, 104, 98, 89, 90, 109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2059279604646479, "mean_inference_ms": 0.8034767001434117, "mean_action_processing_ms": 0.08938278981209148, "mean_env_wait_ms": 0.13071753596200913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275321960449219, "StateBufferConnector_ms": 0.0038650035858154297, "ViewRequirementAgentConnector_ms": 0.07977628707885742}}, "episode_reward_max": -75.0, "episode_reward_min": -217.0, "episode_reward_mean": -105.06, "episode_len_mean": 106.06, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.0, -107.0, -122.0, -127.0, -151.0, -136.0, -86.0, -107.0, -89.0, -103.0, -107.0, -87.0, -85.0, -120.0, -110.0, -80.0, -91.0, -112.0, -75.0, -88.0, -100.0, -96.0, -77.0, -103.0, -91.0, -78.0, -93.0, -96.0, -91.0, -98.0, -94.0, -121.0, -108.0, -86.0, -90.0, -88.0, -96.0, -77.0, -89.0, -141.0, -85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0, -141.0, -96.0, -103.0, -199.0, -95.0, -80.0, -109.0, -106.0, -89.0, -132.0, -88.0, -201.0, -81.0, -93.0, -88.0, -103.0, -97.0, -88.0, -89.0, -108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0], "episode_lengths": [81, 108, 123, 128, 152, 137, 87, 108, 90, 104, 108, 88, 86, 121, 111, 81, 92, 113, 76, 89, 101, 97, 78, 104, 92, 79, 94, 97, 92, 99, 95, 122, 109, 87, 91, 89, 97, 78, 90, 142, 86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121, 142, 97, 104, 200, 96, 81, 110, 107, 90, 133, 89, 202, 82, 94, 89, 104, 98, 89, 90, 109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2059279604646479, "mean_inference_ms": 0.8034767001434117, "mean_action_processing_ms": 0.08938278981209148, "mean_env_wait_ms": 0.13071753596200913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275321960449219, "StateBufferConnector_ms": 0.0038650035858154297, "ViewRequirementAgentConnector_ms": 0.07977628707885742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.5505358909433, "num_env_steps_trained_throughput_per_sec": 273.5505358909433, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14748.232, "sample_time_ms": 4963.581, "load_time_ms": 3.14, "load_throughput": 1273925.45, "learn_time_ms": 9778.592, "learn_throughput": 409.057, "synch_weights_time_ms": 2.129}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 1539, "training_iteration": 44, "trial_id": "default", "date": "2024-08-30_12-46-55", "timestamp": 1724993215, "time_this_iter_s": 14.631004095077515, "time_total_s": 647.6139481067657, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.6139481067657, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 6.652631578947368, "ram_util_percent": 9.5, "gpu_util_percent0": 0.21105263157894735, "vram_util_percent0": 0.11312491433662279}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.104636413820328, "policy_loss": -0.0006803148816670141, "vf_loss": 9.105274576781898, "vf_explained_var": 0.31680273964840877, "kl": 0.008993936996919093, "entropy": 0.3634003414421953, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -217.0, "episode_reward_mean": -104.34, "episode_len_mean": 105.34, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0, -141.0, -96.0, -103.0, -199.0, -95.0, -80.0, -109.0, -106.0, -89.0, -132.0, -88.0, -201.0, -81.0, -93.0, -88.0, -103.0, -97.0, -88.0, -89.0, -108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0, -95.0, -78.0, -101.0, -83.0, -93.0, -102.0, -83.0, -111.0, -114.0, -61.0, -77.0, -112.0, -79.0, -95.0, -91.0, -108.0, -100.0, -87.0, -104.0, -85.0, -92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0], "episode_lengths": [86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121, 142, 97, 104, 200, 96, 81, 110, 107, 90, 133, 89, 202, 82, 94, 89, 104, 98, 89, 90, 109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218, 96, 79, 102, 84, 94, 103, 84, 112, 115, 62, 78, 113, 80, 96, 92, 109, 101, 88, 105, 86, 93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20595426709701192, "mean_inference_ms": 0.803555891014666, "mean_action_processing_ms": 0.08939461649467596, "mean_env_wait_ms": 0.13072984124186968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454612731933594, "StateBufferConnector_ms": 0.003971576690673828, "ViewRequirementAgentConnector_ms": 0.08310079574584961}}, "episode_reward_max": -61.0, "episode_reward_min": -217.0, "episode_reward_mean": -104.34, "episode_len_mean": 105.34, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.0, -105.0, -95.0, -105.0, -100.0, -104.0, -108.0, -122.0, -85.0, -121.0, -143.0, -122.0, -104.0, -171.0, -93.0, -100.0, -107.0, -122.0, -118.0, -113.0, -136.0, -120.0, -141.0, -96.0, -103.0, -199.0, -95.0, -80.0, -109.0, -106.0, -89.0, -132.0, -88.0, -201.0, -81.0, -93.0, -88.0, -103.0, -97.0, -88.0, -89.0, -108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0, -95.0, -78.0, -101.0, -83.0, -93.0, -102.0, -83.0, -111.0, -114.0, -61.0, -77.0, -112.0, -79.0, -95.0, -91.0, -108.0, -100.0, -87.0, -104.0, -85.0, -92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0], "episode_lengths": [86, 106, 96, 106, 101, 105, 109, 123, 86, 122, 144, 123, 105, 172, 94, 101, 108, 123, 119, 114, 137, 121, 142, 97, 104, 200, 96, 81, 110, 107, 90, 133, 89, 202, 82, 94, 89, 104, 98, 89, 90, 109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218, 96, 79, 102, 84, 94, 103, 84, 112, 115, 62, 78, 113, 80, 96, 92, 109, 101, 88, 105, 86, 93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20595426709701192, "mean_inference_ms": 0.803555891014666, "mean_action_processing_ms": 0.08939461649467596, "mean_env_wait_ms": 0.13072984124186968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454612731933594, "StateBufferConnector_ms": 0.003971576690673828, "ViewRequirementAgentConnector_ms": 0.08310079574584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.61964000748696, "num_env_steps_trained_throughput_per_sec": 267.61964000748696, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 14772.061, "sample_time_ms": 4980.915, "load_time_ms": 3.141, "load_throughput": 1273374.319, "learn_time_ms": 9785.095, "learn_throughput": 408.785, "synch_weights_time_ms": 2.123}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 1579, "training_iteration": 45, "trial_id": "default", "date": "2024-08-30_12-47-10", "timestamp": 1724993230, "time_this_iter_s": 14.953864812850952, "time_total_s": 662.5678129196167, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 662.5678129196167, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 6.863157894736842, "ram_util_percent": 9.5, "gpu_util_percent0": 0.2010526315789474, "vram_util_percent0": 0.11309493215460527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.990701005792104, "policy_loss": -0.004446562075166292, "vf_loss": 8.99509102964914, "vf_explained_var": 0.28770853338703034, "kl": 0.012055847602618389, "entropy": 0.3825330166086074, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -217.0, "episode_reward_mean": -98.84, "episode_len_mean": 99.84, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0, -95.0, -78.0, -101.0, -83.0, -93.0, -102.0, -83.0, -111.0, -114.0, -61.0, -77.0, -112.0, -79.0, -95.0, -91.0, -108.0, -100.0, -87.0, -104.0, -85.0, -92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0, -111.0, -87.0, -77.0, -91.0, -102.0, -88.0, -101.0, -103.0, -110.0, -102.0, -101.0, -96.0, -77.0, -88.0, -106.0, -106.0, -73.0, -99.0, -109.0, -115.0, -96.0, -86.0, -70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0], "episode_lengths": [109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218, 96, 79, 102, 84, 94, 103, 84, 112, 115, 62, 78, 113, 80, 96, 92, 109, 101, 88, 105, 86, 93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93, 112, 88, 78, 92, 103, 89, 102, 104, 111, 103, 102, 97, 78, 89, 107, 107, 74, 100, 110, 116, 97, 87, 71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20610507068010173, "mean_inference_ms": 0.8038927545666706, "mean_action_processing_ms": 0.08945270677057965, "mean_env_wait_ms": 0.130805950029545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004530191421508789, "StateBufferConnector_ms": 0.004066944122314453, "ViewRequirementAgentConnector_ms": 0.08520102500915527}}, "episode_reward_max": -61.0, "episode_reward_min": -217.0, "episode_reward_mean": -98.84, "episode_len_mean": 99.84, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-108.0, -129.0, -85.0, -100.0, -93.0, -102.0, -84.0, -80.0, -84.0, -104.0, -77.0, -90.0, -114.0, -121.0, -89.0, -103.0, -96.0, -97.0, -217.0, -95.0, -78.0, -101.0, -83.0, -93.0, -102.0, -83.0, -111.0, -114.0, -61.0, -77.0, -112.0, -79.0, -95.0, -91.0, -108.0, -100.0, -87.0, -104.0, -85.0, -92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0, -111.0, -87.0, -77.0, -91.0, -102.0, -88.0, -101.0, -103.0, -110.0, -102.0, -101.0, -96.0, -77.0, -88.0, -106.0, -106.0, -73.0, -99.0, -109.0, -115.0, -96.0, -86.0, -70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0], "episode_lengths": [109, 130, 86, 101, 94, 103, 85, 81, 85, 105, 78, 91, 115, 122, 90, 104, 97, 98, 218, 96, 79, 102, 84, 94, 103, 84, 112, 115, 62, 78, 113, 80, 96, 92, 109, 101, 88, 105, 86, 93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93, 112, 88, 78, 92, 103, 89, 102, 104, 111, 103, 102, 97, 78, 89, 107, 107, 74, 100, 110, 116, 97, 87, 71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20610507068010173, "mean_inference_ms": 0.8038927545666706, "mean_action_processing_ms": 0.08945270677057965, "mean_env_wait_ms": 0.130805950029545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004530191421508789, "StateBufferConnector_ms": 0.004066944122314453, "ViewRequirementAgentConnector_ms": 0.08520102500915527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.34031010523944, "num_env_steps_trained_throughput_per_sec": 265.34031010523944, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 14791.792, "sample_time_ms": 4983.388, "load_time_ms": 3.229, "load_throughput": 1238582.26, "learn_time_ms": 9799.381, "learn_throughput": 408.189, "synch_weights_time_ms": 4.941}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 1620, "training_iteration": 46, "trial_id": "default", "date": "2024-08-30_12-47-25", "timestamp": 1724993245, "time_this_iter_s": 15.081120491027832, "time_total_s": 677.6489334106445, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 677.6489334106445, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 6.414999999999999, "ram_util_percent": 9.5, "gpu_util_percent0": 0.2015, "vram_util_percent0": 0.11313883463541667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.139248963325254, "policy_loss": 0.002327114347648877, "vf_loss": 9.136894262990644, "vf_explained_var": 0.3316169866951563, "kl": 0.005889217706317503, "entropy": 0.33090116699096017, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -70.0, "episode_reward_min": -256.0, "episode_reward_mean": -100.32, "episode_len_mean": 101.32, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0, -111.0, -87.0, -77.0, -91.0, -102.0, -88.0, -101.0, -103.0, -110.0, -102.0, -101.0, -96.0, -77.0, -88.0, -106.0, -106.0, -73.0, -99.0, -109.0, -115.0, -96.0, -86.0, -70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0, -99.0, -87.0, -108.0, -90.0, -110.0, -80.0, -77.0, -83.0, -101.0, -256.0, -75.0, -106.0, -113.0, -79.0, -99.0, -80.0, -97.0, -94.0, -103.0, -105.0, -93.0, -87.0, -90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0], "episode_lengths": [93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93, 112, 88, 78, 92, 103, 89, 102, 104, 111, 103, 102, 97, 78, 89, 107, 107, 74, 100, 110, 116, 97, 87, 71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143, 100, 88, 109, 91, 111, 81, 78, 84, 102, 257, 76, 107, 114, 80, 100, 81, 98, 95, 104, 106, 94, 88, 91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20624457846746347, "mean_inference_ms": 0.8042144614352543, "mean_action_processing_ms": 0.08950467248960986, "mean_env_wait_ms": 0.13086512747503753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044324398040771484, "StateBufferConnector_ms": 0.004061460494995117, "ViewRequirementAgentConnector_ms": 0.08495903015136719}}, "episode_reward_max": -70.0, "episode_reward_min": -256.0, "episode_reward_mean": -100.32, "episode_len_mean": 101.32, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-92.0, -174.0, -157.0, -90.0, -109.0, -80.0, -102.0, -99.0, -80.0, -82.0, -80.0, -76.0, -100.0, -101.0, -89.0, -81.0, -178.0, -94.0, -89.0, -92.0, -111.0, -87.0, -77.0, -91.0, -102.0, -88.0, -101.0, -103.0, -110.0, -102.0, -101.0, -96.0, -77.0, -88.0, -106.0, -106.0, -73.0, -99.0, -109.0, -115.0, -96.0, -86.0, -70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0, -99.0, -87.0, -108.0, -90.0, -110.0, -80.0, -77.0, -83.0, -101.0, -256.0, -75.0, -106.0, -113.0, -79.0, -99.0, -80.0, -97.0, -94.0, -103.0, -105.0, -93.0, -87.0, -90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0], "episode_lengths": [93, 175, 158, 91, 110, 81, 103, 100, 81, 83, 81, 77, 101, 102, 90, 82, 179, 95, 90, 93, 112, 88, 78, 92, 103, 89, 102, 104, 111, 103, 102, 97, 78, 89, 107, 107, 74, 100, 110, 116, 97, 87, 71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143, 100, 88, 109, 91, 111, 81, 78, 84, 102, 257, 76, 107, 114, 80, 100, 81, 98, 95, 104, 106, 94, 88, 91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20624457846746347, "mean_inference_ms": 0.8042144614352543, "mean_action_processing_ms": 0.08950467248960986, "mean_env_wait_ms": 0.13086512747503753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044324398040771484, "StateBufferConnector_ms": 0.004061460494995117, "ViewRequirementAgentConnector_ms": 0.08495903015136719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.27135090810697, "num_env_steps_trained_throughput_per_sec": 270.27135090810697, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 14808.809, "sample_time_ms": 4994.012, "load_time_ms": 3.226, "load_throughput": 1240047.008, "learn_time_ms": 9805.762, "learn_throughput": 407.923, "synch_weights_time_ms": 4.952}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 1659, "training_iteration": 47, "trial_id": "default", "date": "2024-08-30_12-47-40", "timestamp": 1724993260, "time_this_iter_s": 14.80763053894043, "time_total_s": 692.456563949585, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 692.456563949585, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 6.052631578947367, "ram_util_percent": 9.5, "gpu_util_percent0": 0.19105263157894736, "vram_util_percent0": 0.11346328467653508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.932311728180096, "policy_loss": -1.6498457520238814e-05, "vf_loss": 8.932296542711155, "vf_explained_var": 0.37282623373052126, "kl": 0.006760286004572486, "entropy": 0.35530286681267526, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -256.0, "episode_reward_mean": -97.85, "episode_len_mean": 98.85, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0, -99.0, -87.0, -108.0, -90.0, -110.0, -80.0, -77.0, -83.0, -101.0, -256.0, -75.0, -106.0, -113.0, -79.0, -99.0, -80.0, -97.0, -94.0, -103.0, -105.0, -93.0, -87.0, -90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0, -90.0, -83.0, -84.0, -105.0, -90.0, -94.0, -118.0, -75.0, -94.0, -229.0, -74.0, -96.0, -92.0, -88.0, -88.0, -91.0, -92.0, -83.0, -109.0, -82.0, -78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0], "episode_lengths": [71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143, 100, 88, 109, 91, 111, 81, 78, 84, 102, 257, 76, 107, 114, 80, 100, 81, 98, 95, 104, 106, 94, 88, 91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134, 91, 84, 85, 106, 91, 95, 119, 76, 95, 230, 75, 97, 93, 89, 89, 92, 93, 84, 110, 83, 79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20633467033358294, "mean_inference_ms": 0.804409848749177, "mean_action_processing_ms": 0.08953542416876202, "mean_env_wait_ms": 0.13089333318023283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004347085952758789, "StateBufferConnector_ms": 0.004053592681884766, "ViewRequirementAgentConnector_ms": 0.08420062065124512}}, "episode_reward_max": -62.0, "episode_reward_min": -256.0, "episode_reward_mean": -97.85, "episode_len_mean": 98.85, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.0, -90.0, -93.0, -104.0, -88.0, -81.0, -91.0, -140.0, -82.0, -84.0, -83.0, -105.0, -81.0, -73.0, -75.0, -129.0, -187.0, -85.0, -142.0, -99.0, -87.0, -108.0, -90.0, -110.0, -80.0, -77.0, -83.0, -101.0, -256.0, -75.0, -106.0, -113.0, -79.0, -99.0, -80.0, -97.0, -94.0, -103.0, -105.0, -93.0, -87.0, -90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0, -90.0, -83.0, -84.0, -105.0, -90.0, -94.0, -118.0, -75.0, -94.0, -229.0, -74.0, -96.0, -92.0, -88.0, -88.0, -91.0, -92.0, -83.0, -109.0, -82.0, -78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0], "episode_lengths": [71, 91, 94, 105, 89, 82, 92, 141, 83, 85, 84, 106, 82, 74, 76, 130, 188, 86, 143, 100, 88, 109, 91, 111, 81, 78, 84, 102, 257, 76, 107, 114, 80, 100, 81, 98, 95, 104, 106, 94, 88, 91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134, 91, 84, 85, 106, 91, 95, 119, 76, 95, 230, 75, 97, 93, 89, 89, 92, 93, 84, 110, 83, 79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20633467033358294, "mean_inference_ms": 0.804409848749177, "mean_action_processing_ms": 0.08953542416876202, "mean_env_wait_ms": 0.13089333318023283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004347085952758789, "StateBufferConnector_ms": 0.004053592681884766, "ViewRequirementAgentConnector_ms": 0.08420062065124512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.4747664978536, "num_env_steps_trained_throughput_per_sec": 270.4747664978536, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14831.992, "sample_time_ms": 5002.668, "load_time_ms": 3.209, "load_throughput": 1246505.491, "learn_time_ms": 9820.313, "learn_throughput": 407.319, "synch_weights_time_ms": 4.943}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 1701, "training_iteration": 48, "trial_id": "default", "date": "2024-08-30_12-47-55", "timestamp": 1724993275, "time_this_iter_s": 14.796588659286499, "time_total_s": 707.2531526088715, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 707.2531526088715, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 5.805263157894737, "ram_util_percent": 9.5, "gpu_util_percent0": 0.16578947368421051, "vram_util_percent0": 0.11337119654605261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.944622153107838, "policy_loss": 0.001664338737565984, "vf_loss": 8.942922022522136, "vf_explained_var": 0.3734511323513523, "kl": 0.007628485211038021, "entropy": 0.3601170061416523, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -229.0, "episode_reward_mean": -96.44, "episode_len_mean": 97.44, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0, -90.0, -83.0, -84.0, -105.0, -90.0, -94.0, -118.0, -75.0, -94.0, -229.0, -74.0, -96.0, -92.0, -88.0, -88.0, -91.0, -92.0, -83.0, -109.0, -82.0, -78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0, -100.0, -105.0, -88.0, -87.0, -76.0, -76.0, -81.0, -71.0, -83.0, -96.0, -77.0, -88.0, -121.0, -90.0, -121.0, -83.0, -83.0, -94.0, -98.0, -102.0, -93.0, -107.0, -105.0, -80.0, -96.0, -106.0, -97.0, -108.0, -98.0, -80.0, -82.0, -108.0, -103.0, -81.0, -148.0, -106.0, -77.0, -116.0, -112.0, -93.0, -148.0], "episode_lengths": [91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134, 91, 84, 85, 106, 91, 95, 119, 76, 95, 230, 75, 97, 93, 89, 89, 92, 93, 84, 110, 83, 79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96, 101, 106, 89, 88, 77, 77, 82, 72, 84, 97, 78, 89, 122, 91, 122, 84, 84, 95, 99, 103, 94, 108, 106, 81, 97, 107, 98, 109, 99, 81, 83, 109, 104, 82, 149, 107, 78, 117, 113, 94, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.206384863467866, "mean_inference_ms": 0.8044947470511988, "mean_action_processing_ms": 0.08954577956947223, "mean_env_wait_ms": 0.1308950154834387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045855045318603516, "StateBufferConnector_ms": 0.004050493240356445, "ViewRequirementAgentConnector_ms": 0.08328628540039062}}, "episode_reward_max": -62.0, "episode_reward_min": -229.0, "episode_reward_mean": -96.44, "episode_len_mean": 97.44, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.0, -105.0, -98.0, -86.0, -137.0, -81.0, -81.0, -81.0, -93.0, -112.0, -98.0, -121.0, -99.0, -159.0, -76.0, -108.0, -133.0, -90.0, -83.0, -84.0, -105.0, -90.0, -94.0, -118.0, -75.0, -94.0, -229.0, -74.0, -96.0, -92.0, -88.0, -88.0, -91.0, -92.0, -83.0, -109.0, -82.0, -78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0, -100.0, -105.0, -88.0, -87.0, -76.0, -76.0, -81.0, -71.0, -83.0, -96.0, -77.0, -88.0, -121.0, -90.0, -121.0, -83.0, -83.0, -94.0, -98.0, -102.0, -93.0, -107.0, -105.0, -80.0, -96.0, -106.0, -97.0, -108.0, -98.0, -80.0, -82.0, -108.0, -103.0, -81.0, -148.0, -106.0, -77.0, -116.0, -112.0, -93.0, -148.0], "episode_lengths": [91, 106, 99, 87, 138, 82, 82, 82, 94, 113, 99, 122, 100, 160, 77, 109, 134, 91, 84, 85, 106, 91, 95, 119, 76, 95, 230, 75, 97, 93, 89, 89, 92, 93, 84, 110, 83, 79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96, 101, 106, 89, 88, 77, 77, 82, 72, 84, 97, 78, 89, 122, 91, 122, 84, 84, 95, 99, 103, 94, 108, 106, 81, 97, 107, 98, 109, 99, 81, 83, 109, 104, 82, 149, 107, 78, 117, 113, 94, 149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.206384863467866, "mean_inference_ms": 0.8044947470511988, "mean_action_processing_ms": 0.08954577956947223, "mean_env_wait_ms": 0.1308950154834387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045855045318603516, "StateBufferConnector_ms": 0.004050493240356445, "ViewRequirementAgentConnector_ms": 0.08328628540039062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.5528663632683, "num_env_steps_trained_throughput_per_sec": 272.5528663632683, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 14806.077, "sample_time_ms": 4996.745, "load_time_ms": 3.178, "load_throughput": 1258728.608, "learn_time_ms": 9800.335, "learn_throughput": 408.149, "synch_weights_time_ms": 4.959}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 1742, "training_iteration": 49, "trial_id": "default", "date": "2024-08-30_12-48-10", "timestamp": 1724993290, "time_this_iter_s": 14.683618783950806, "time_total_s": 721.9367713928223, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 721.9367713928223, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 5.657894736842106, "ram_util_percent": 9.5, "gpu_util_percent0": 0.13789473684210524, "vram_util_percent0": 0.11294716282894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.095118669284288, "policy_loss": -0.0027255061893693864, "vf_loss": 9.097816283728486, "vf_explained_var": 0.33070345303063753, "kl": 0.005951357049742011, "entropy": 0.34170231518726196, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -234.0, "episode_reward_mean": -98.39, "episode_len_mean": 99.39, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0, -100.0, -105.0, -88.0, -87.0, -76.0, -76.0, -81.0, -71.0, -83.0, -96.0, -77.0, -88.0, -121.0, -90.0, -121.0, -83.0, -83.0, -94.0, -98.0, -102.0, -93.0, -107.0, -105.0, -80.0, -96.0, -106.0, -97.0, -108.0, -98.0, -80.0, -82.0, -108.0, -103.0, -81.0, -148.0, -106.0, -77.0, -116.0, -112.0, -93.0, -148.0, -112.0, -71.0, -92.0, -80.0, -180.0, -79.0, -81.0, -73.0, -97.0, -100.0, -234.0, -104.0, -71.0, -92.0, -137.0, -104.0, -98.0, -225.0, -79.0, -163.0, -86.0, -107.0, -135.0, -89.0, -93.0, -106.0, -127.0, -74.0, -111.0, -96.0, -92.0, -72.0, -83.0, -97.0, -73.0, -79.0, -118.0], "episode_lengths": [79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96, 101, 106, 89, 88, 77, 77, 82, 72, 84, 97, 78, 89, 122, 91, 122, 84, 84, 95, 99, 103, 94, 108, 106, 81, 97, 107, 98, 109, 99, 81, 83, 109, 104, 82, 149, 107, 78, 117, 113, 94, 149, 113, 72, 93, 81, 181, 80, 82, 74, 98, 101, 235, 105, 72, 93, 138, 105, 99, 226, 80, 164, 87, 108, 136, 90, 94, 107, 128, 75, 112, 97, 93, 73, 84, 98, 74, 80, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064345091041263, "mean_inference_ms": 0.8046489931445079, "mean_action_processing_ms": 0.08955529567794673, "mean_env_wait_ms": 0.13090338984821578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004812955856323242, "StateBufferConnector_ms": 0.004052877426147461, "ViewRequirementAgentConnector_ms": 0.08384370803833008}}, "episode_reward_max": -62.0, "episode_reward_min": -234.0, "episode_reward_mean": -98.39, "episode_len_mean": 99.39, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -88.0, -82.0, -82.0, -103.0, -90.0, -65.0, -80.0, -99.0, -101.0, -99.0, -94.0, -107.0, -76.0, -76.0, -62.0, -90.0, -96.0, -100.0, -86.0, -116.0, -95.0, -100.0, -105.0, -88.0, -87.0, -76.0, -76.0, -81.0, -71.0, -83.0, -96.0, -77.0, -88.0, -121.0, -90.0, -121.0, -83.0, -83.0, -94.0, -98.0, -102.0, -93.0, -107.0, -105.0, -80.0, -96.0, -106.0, -97.0, -108.0, -98.0, -80.0, -82.0, -108.0, -103.0, -81.0, -148.0, -106.0, -77.0, -116.0, -112.0, -93.0, -148.0, -112.0, -71.0, -92.0, -80.0, -180.0, -79.0, -81.0, -73.0, -97.0, -100.0, -234.0, -104.0, -71.0, -92.0, -137.0, -104.0, -98.0, -225.0, -79.0, -163.0, -86.0, -107.0, -135.0, -89.0, -93.0, -106.0, -127.0, -74.0, -111.0, -96.0, -92.0, -72.0, -83.0, -97.0, -73.0, -79.0, -118.0], "episode_lengths": [79, 89, 83, 83, 104, 91, 66, 81, 100, 102, 100, 95, 108, 77, 77, 63, 91, 97, 101, 87, 117, 96, 101, 106, 89, 88, 77, 77, 82, 72, 84, 97, 78, 89, 122, 91, 122, 84, 84, 95, 99, 103, 94, 108, 106, 81, 97, 107, 98, 109, 99, 81, 83, 109, 104, 82, 149, 107, 78, 117, 113, 94, 149, 113, 72, 93, 81, 181, 80, 82, 74, 98, 101, 235, 105, 72, 93, 138, 105, 99, 226, 80, 164, 87, 108, 136, 90, 94, 107, 128, 75, 112, 97, 93, 73, 84, 98, 74, 80, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2064345091041263, "mean_inference_ms": 0.8046489931445079, "mean_action_processing_ms": 0.08955529567794673, "mean_env_wait_ms": 0.13090338984821578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004812955856323242, "StateBufferConnector_ms": 0.004052877426147461, "ViewRequirementAgentConnector_ms": 0.08384370803833008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.0734285194741, "num_env_steps_trained_throughput_per_sec": 267.0734285194741, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 14821.323, "sample_time_ms": 4998.785, "load_time_ms": 3.17, "load_throughput": 1261748.391, "learn_time_ms": 9813.579, "learn_throughput": 407.598, "synch_weights_time_ms": 4.93}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 1779, "training_iteration": 50, "trial_id": "default", "date": "2024-08-30_12-48-25", "timestamp": 1724993305, "time_this_iter_s": 14.984178304672241, "time_total_s": 736.9209496974945, "pid": 31558, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fce02c66310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 736.9209496974945, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 5.999999999999999, "ram_util_percent": 9.5, "gpu_util_percent0": 0.17263157894736844, "vram_util_percent0": 0.11349969161184213}}
