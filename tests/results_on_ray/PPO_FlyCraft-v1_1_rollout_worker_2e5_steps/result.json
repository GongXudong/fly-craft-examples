{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.88420043555639, "policy_loss": 0.0015643136926315805, "vf_loss": 9.880649176464287, "vf_explained_var": 0.0007380498352871146, "kl": 0.009934693250914044, "entropy": 4.242731638877623, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -14.092346134436486, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -196.385720978744, "episode_len_mean": 162.08333333333334, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24615916810134628, "mean_inference_ms": 0.8439912822239997, "mean_action_processing_ms": 0.1454161453533101, "mean_env_wait_ms": 1.5484789138256208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019294023513793945, "StateBufferConnector_ms": 0.004431605339050293, "ViewRequirementAgentConnector_ms": 0.08582671483357747}}, "episode_reward_max": -14.092346134436486, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -196.385720978744, "episode_len_mean": 162.08333333333334, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24615916810134628, "mean_inference_ms": 0.8439912822239997, "mean_action_processing_ms": 0.1454161453533101, "mean_env_wait_ms": 1.5484789138256208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019294023513793945, "StateBufferConnector_ms": 0.004431605339050293, "ViewRequirementAgentConnector_ms": 0.08582671483357747}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.8481111135288, "num_env_steps_trained_throughput_per_sec": 175.8481111135288, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 22746.864, "sample_time_ms": 11445.209, "load_time_ms": 24.556, "load_throughput": 162895.081, "learn_time_ms": 11274.026, "learn_throughput": 354.798, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "default", "date": "2024-08-30_11-44-45", "timestamp": 1724989485, "time_this_iter_s": 22.754393339157104, "time_total_s": 22.754393339157104, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.754393339157104, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.746666666666666, "ram_util_percent": 10.053333333333333, "gpu_util_percent0": 0.13366666666666666, "vram_util_percent0": 0.16211751302083335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.945582078092842, "policy_loss": -0.0017252173645281664, "vf_loss": 9.945911421827091, "vf_explained_var": 0.00206074894115489, "kl": 0.006979362477320524, "entropy": 4.225766357042456, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -14.092346134436486, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -201.75603496121462, "episode_len_mean": 196.64102564102564, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2439654923819704, "mean_inference_ms": 0.8488220469807702, "mean_action_processing_ms": 0.1445213154681115, "mean_env_wait_ms": 1.5344947390443944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018431590153620794, "StateBufferConnector_ms": 0.004416245680588942, "ViewRequirementAgentConnector_ms": 0.08484644767565605}}, "episode_reward_max": -14.092346134436486, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -201.75603496121462, "episode_len_mean": 196.64102564102564, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2439654923819704, "mean_inference_ms": 0.8488220469807702, "mean_action_processing_ms": 0.1445213154681115, "mean_env_wait_ms": 1.5344947390443944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018431590153620794, "StateBufferConnector_ms": 0.004416245680588942, "ViewRequirementAgentConnector_ms": 0.08484644767565605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.2222731424755, "num_env_steps_trained_throughput_per_sec": 184.2222731424755, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 22229.861, "sample_time_ms": 11263.346, "load_time_ms": 35.196, "load_throughput": 113649.066, "learn_time_ms": 10928.168, "learn_throughput": 366.027, "synch_weights_time_ms": 2.234}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 39, "training_iteration": 2, "trial_id": "default", "date": "2024-08-30_11-45-06", "timestamp": 1724989506, "time_this_iter_s": 21.720052003860474, "time_total_s": 44.47444534301758, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.47444534301758, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.546428571428573, "ram_util_percent": 9.8, "gpu_util_percent0": 0.11071428571428574, "vram_util_percent0": 0.1619713192894345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.822091593793644, "policy_loss": -0.007076594868414505, "vf_loss": 9.826986049836682, "vf_explained_var": 0.0003635650040000998, "kl": 0.010910672203642235, "entropy": 4.19409965520264, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -195.28691221734798, "episode_len_mean": 202.5084745762712, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2423317638366268, "mean_inference_ms": 0.8498189731473761, "mean_action_processing_ms": 0.14431178626743732, "mean_env_wait_ms": 1.5244221900540276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01850411043328754, "StateBufferConnector_ms": 0.004587335101628708, "ViewRequirementAgentConnector_ms": 0.0845347420643952}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -195.28691221734798, "episode_len_mean": 202.5084745762712, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2423317638366268, "mean_inference_ms": 0.8498189731473761, "mean_action_processing_ms": 0.14431178626743732, "mean_env_wait_ms": 1.5244221900540276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01850411043328754, "StateBufferConnector_ms": 0.004587335101628708, "ViewRequirementAgentConnector_ms": 0.0845347420643952}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.47930338200467, "num_env_steps_trained_throughput_per_sec": 185.47930338200467, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 22008.474, "sample_time_ms": 11190.951, "load_time_ms": 26.635, "load_throughput": 150177.826, "learn_time_ms": 10787.807, "learn_throughput": 370.789, "synch_weights_time_ms": 2.212}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 59, "training_iteration": 3, "trial_id": "default", "date": "2024-08-30_11-45-28", "timestamp": 1724989528, "time_this_iter_s": 21.575058460235596, "time_total_s": 66.04950380325317, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.04950380325317, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.339285714285714, "ram_util_percent": 9.74642857142857, "gpu_util_percent0": 0.115, "vram_util_percent0": 0.16217186337425593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.84021672587241, "policy_loss": -0.00810947415108482, "vf_loss": 9.845725746564968, "vf_explained_var": 0.0002112150833170901, "kl": 0.013002221145647912, "entropy": 4.268298666964295, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -197.40609642423146, "episode_len_mean": 217.53424657534248, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.241995633196346, "mean_inference_ms": 0.8527453182764603, "mean_action_processing_ms": 0.14428400396001717, "mean_env_wait_ms": 1.5222508182269725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0184451064018354, "StateBufferConnector_ms": 0.004620094821877675, "ViewRequirementAgentConnector_ms": 0.08523398882722201}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -197.40609642423146, "episode_len_mean": 217.53424657534248, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.241995633196346, "mean_inference_ms": 0.8527453182764603, "mean_action_processing_ms": 0.14428400396001717, "mean_env_wait_ms": 1.5222508182269725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0184451064018354, "StateBufferConnector_ms": 0.004620094821877675, "ViewRequirementAgentConnector_ms": 0.08523398882722201}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.8224026632537, "num_env_steps_trained_throughput_per_sec": 179.8224026632537, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 22067.387, "sample_time_ms": 11310.639, "load_time_ms": 22.399, "load_throughput": 178583.137, "learn_time_ms": 10731.246, "learn_throughput": 372.743, "synch_weights_time_ms": 2.248}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 73, "training_iteration": 4, "trial_id": "default", "date": "2024-08-30_11-45-50", "timestamp": 1724989550, "time_this_iter_s": 22.251490592956543, "time_total_s": 88.30099439620972, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 88.30099439620972, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.53793103448276, "ram_util_percent": 9.741379310344827, "gpu_util_percent0": 0.13482758620689655, "vram_util_percent0": 0.162109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.855508450026154, "policy_loss": -0.0027065722071515615, "vf_loss": 9.855997852612568, "vf_explained_var": -0.0015057221535713441, "kl": 0.01108567023022992, "entropy": 4.2524606632929975, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -197.36399376577404, "episode_len_mean": 228.91954022988506, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24179861137286537, "mean_inference_ms": 0.8564411466310238, "mean_action_processing_ms": 0.14450540491035788, "mean_env_wait_ms": 1.5216695288352073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018436059184458065, "StateBufferConnector_ms": 0.004599834310597387, "ViewRequirementAgentConnector_ms": 0.08529246538534932}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -197.36399376577404, "episode_len_mean": 228.91954022988506, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24179861137286537, "mean_inference_ms": 0.8564411466310238, "mean_action_processing_ms": 0.14450540491035788, "mean_env_wait_ms": 1.5216695288352073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018436059184458065, "StateBufferConnector_ms": 0.004599834310597387, "ViewRequirementAgentConnector_ms": 0.08529246538534932}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.0769068867974, "num_env_steps_trained_throughput_per_sec": 180.0769068867974, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 22096.444, "sample_time_ms": 11369.487, "load_time_ms": 19.81, "load_throughput": 201922.992, "learn_time_ms": 10704.07, "learn_throughput": 373.69, "synch_weights_time_ms": 2.238}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 87, "training_iteration": 5, "trial_id": "default", "date": "2024-08-30_11-46-12", "timestamp": 1724989572, "time_this_iter_s": 22.22018551826477, "time_total_s": 110.52117991447449, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 110.52117991447449, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.96551724137931, "ram_util_percent": 9.806896551724137, "gpu_util_percent0": 0.1224137931034483, "vram_util_percent0": 0.16007346668462646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.786431613532447, "policy_loss": -0.003863791562616825, "vf_loss": 9.788088844155752, "vf_explained_var": -0.0003982514463445192, "kl": 0.011032854577706119, "entropy": 4.243291100891687, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -196.06425575151346, "episode_len_mean": 239.92, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24164921371209716, "mean_inference_ms": 0.8585094187434603, "mean_action_processing_ms": 0.14462509590259415, "mean_env_wait_ms": 1.5211495138827118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01841902732849121, "StateBufferConnector_ms": 0.004569530487060547, "ViewRequirementAgentConnector_ms": 0.08524942398071289}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -196.06425575151346, "episode_len_mean": 239.92, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.18474967664372, -217.18318922497335, -178.07450507922232, -250.3425707520631, -178.86579660942917, -260.02907811693575, -208.68001728886728, -195.06936249143075, -191.34628744649294, -175.33289727184987, -197.8696109947815, -211.5544105274219, -195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548], "episode_lengths": [43, 372, 149, 258, 399, 399, 119, 58, 82, 55, 182, 279, 61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24164921371209716, "mean_inference_ms": 0.8585094187434603, "mean_action_processing_ms": 0.14462509590259415, "mean_env_wait_ms": 1.5211495138827118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01841902732849121, "StateBufferConnector_ms": 0.004569530487060547, "ViewRequirementAgentConnector_ms": 0.08524942398071289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.06067440042003, "num_env_steps_trained_throughput_per_sec": 185.06067440042003, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 22016.118, "sample_time_ms": 11341.811, "load_time_ms": 17.904, "load_throughput": 223414.215, "learn_time_ms": 10653.362, "learn_throughput": 375.468, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 100, "training_iteration": 6, "trial_id": "default", "date": "2024-08-30_11-46-34", "timestamp": 1724989594, "time_this_iter_s": 21.621743202209473, "time_total_s": 132.14292311668396, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 132.14292311668396, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.528571428571428, "ram_util_percent": 9.778571428571428, "gpu_util_percent0": 0.12, "vram_util_percent0": 0.13198561895461308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.763606951826363, "policy_loss": -0.005189529407809499, "vf_loss": 9.766429714490009, "vf_explained_var": 0.004593110212715724, "kl": 0.01183387871819296, "entropy": 4.280909988444338, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -193.00428496569606, "episode_len_mean": 255.9, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895], "episode_lengths": [61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095893462881435, "mean_inference_ms": 0.8618411241956846, "mean_action_processing_ms": 0.14458797802744505, "mean_env_wait_ms": 1.5169312412516738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01825261116027832, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.08541440963745117}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -275.97016820324427, "episode_reward_mean": -193.00428496569606, "episode_len_mean": 255.9, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-195.94978303439916, -171.10520250415485, -203.75645503604824, -14.092346134436486, -236.44051921675594, -205.64287538567572, -186.3796035656986, -192.31524873637247, -183.9490433028343, -275.97016820324427, -204.76522549851302, -199.35835739161138, -155.33473987213065, -182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895], "episode_lengths": [61, 131, 98, 101, 199, 197, 67, 125, 48, 263, 119, 86, 399, 46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095893462881435, "mean_inference_ms": 0.8618411241956846, "mean_action_processing_ms": 0.14458797802744505, "mean_env_wait_ms": 1.5169312412516738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01825261116027832, "StateBufferConnector_ms": 0.004584789276123047, "ViewRequirementAgentConnector_ms": 0.08541440963745117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.68782907794656, "num_env_steps_trained_throughput_per_sec": 184.68782907794656, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 21964.978, "sample_time_ms": 11312.602, "load_time_ms": 16.584, "load_throughput": 241199.981, "learn_time_ms": 10632.83, "learn_throughput": 376.193, "synch_weights_time_ms": 2.17}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 112, "training_iteration": 7, "trial_id": "default", "date": "2024-08-30_11-46-56", "timestamp": 1724989616, "time_this_iter_s": 21.665431022644043, "time_total_s": 153.808354139328, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.808354139328, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 7.135714285714287, "ram_util_percent": 9.721428571428572, "gpu_util_percent0": 0.07535714285714286, "vram_util_percent0": 0.07138061523437499}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.749748285355107, "policy_loss": -0.04642316690415785, "vf_loss": 9.793621779000887, "vf_explained_var": -0.003460458593983804, "kl": 0.01274850318970829, "entropy": 4.228027448859266, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -270.734656704501, "episode_reward_mean": -193.34207622605106, "episode_len_mean": 277.11, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806], "episode_lengths": [46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24015142762802433, "mean_inference_ms": 0.8646447166020697, "mean_action_processing_ms": 0.1444960733478334, "mean_env_wait_ms": 1.5129723689791825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017974138259887695, "StateBufferConnector_ms": 0.00456547737121582, "ViewRequirementAgentConnector_ms": 0.08489990234375}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -270.734656704501, "episode_reward_mean": -193.34207622605106, "episode_len_mean": 277.11, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182.4418666791666, -232.92596965800305, -193.8569097604827, -270.734656704501, -197.43944075563448, -203.5812361474991, -240.8019110138191, -198.32784423464736, -180.99730407343773, -251.10763562540592, -232.7681061533963, -165.56926570347534, -192.90852640513722, -256.4326472107766, -233.81905813112445, -145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806], "episode_lengths": [46, 255, 380, 380, 117, 91, 224, 170, 399, 185, 209, 399, 138, 387, 399, 399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24015142762802433, "mean_inference_ms": 0.8646447166020697, "mean_action_processing_ms": 0.1444960733478334, "mean_env_wait_ms": 1.5129723689791825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017974138259887695, "StateBufferConnector_ms": 0.00456547737121582, "ViewRequirementAgentConnector_ms": 0.08489990234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.9863236580547, "num_env_steps_trained_throughput_per_sec": 182.9863236580547, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 21951.792, "sample_time_ms": 11290.268, "load_time_ms": 15.709, "load_throughput": 254637.177, "learn_time_ms": 10642.832, "learn_throughput": 375.84, "synch_weights_time_ms": 2.185}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 125, "training_iteration": 8, "trial_id": "default", "date": "2024-08-30_11-47-18", "timestamp": 1724989638, "time_this_iter_s": 21.86710548400879, "time_total_s": 175.6754596233368, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.6754596233368, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.228571428571428, "ram_util_percent": 9.77142857142857, "gpu_util_percent0": 0.09714285714285717, "vram_util_percent0": 0.07134428478422619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.665003836539483, "policy_loss": -0.005671937969983906, "vf_loss": 9.667815145882226, "vf_explained_var": -0.00014844453462990381, "kl": 0.014303018014785564, "entropy": 4.286999962406774, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -1.2478163833441502, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -188.03457985552748, "episode_len_mean": 278.93, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004], "episode_lengths": [399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23997131665018118, "mean_inference_ms": 0.865478195947164, "mean_action_processing_ms": 0.14463167034996405, "mean_env_wait_ms": 1.5127227708187372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018047809600830078, "StateBufferConnector_ms": 0.00455474853515625, "ViewRequirementAgentConnector_ms": 0.08495736122131348}}, "episode_reward_max": -1.2478163833441502, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -188.03457985552748, "episode_len_mean": 278.93, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-145.91088158597154, -185.05857500552753, -240.66512091998473, -187.05001557650573, -215.21553487352082, -18.07428777365786, -250.6691303558907, -1.2478163833441502, -217.3047196763979, -232.38252260469437, -199.22819023193807, -188.08637773025796, -32.806090642067126, -237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004], "episode_lengths": [399, 73, 399, 53, 313, 79, 391, 9, 242, 294, 289, 54, 124, 268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23997131665018118, "mean_inference_ms": 0.865478195947164, "mean_action_processing_ms": 0.14463167034996405, "mean_env_wait_ms": 1.5127227708187372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018047809600830078, "StateBufferConnector_ms": 0.00455474853515625, "ViewRequirementAgentConnector_ms": 0.08495736122131348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.1094292904648, "num_env_steps_trained_throughput_per_sec": 187.1094292904648, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 21888.017, "sample_time_ms": 11243.63, "load_time_ms": 18.997, "load_throughput": 210560.072, "learn_time_ms": 10622.387, "learn_throughput": 376.563, "synch_weights_time_ms": 2.195}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 140, "training_iteration": 9, "trial_id": "default", "date": "2024-08-30_11-47-39", "timestamp": 1724989659, "time_this_iter_s": 21.38538098335266, "time_total_s": 197.06084060668945, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 197.06084060668945, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.625, "ram_util_percent": 9.85, "gpu_util_percent0": 0.10714285714285716, "vram_util_percent0": 0.07068888346354164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.758913028881114, "policy_loss": -0.006539893576935414, "vf_loss": 9.762467446891211, "vf_explained_var": -0.0005329294871258479, "kl": 0.014927340652596512, "entropy": 4.363037027851227, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -24.667206817854876, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -191.2210793608933, "episode_len_mean": 289.08, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852], "episode_lengths": [268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.239942470186379, "mean_inference_ms": 0.867348139613176, "mean_action_processing_ms": 0.14473473815583385, "mean_env_wait_ms": 1.5136795459338155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018025875091552734, "StateBufferConnector_ms": 0.004436492919921875, "ViewRequirementAgentConnector_ms": 0.08497071266174316}}, "episode_reward_max": -24.667206817854876, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -191.2210793608933, "episode_len_mean": 289.08, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-237.19198777279163, -201.8003271661929, -200.50399246605298, -242.60013663598406, -186.33900421624827, -237.4886875880086, -149.65360276681378, -189.70064114877883, -186.16815595693328, -215.34462561877393, -214.13369786707804, -214.62560924786774, -209.84683341990234, -180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852], "episode_lengths": [268, 146, 79, 385, 45, 238, 399, 55, 399, 179, 399, 399, 399, 91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.239942470186379, "mean_inference_ms": 0.867348139613176, "mean_action_processing_ms": 0.14473473815583385, "mean_env_wait_ms": 1.5136795459338155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018025875091552734, "StateBufferConnector_ms": 0.004436492919921875, "ViewRequirementAgentConnector_ms": 0.08497071266174316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.3779338451321, "num_env_steps_trained_throughput_per_sec": 179.3779338451321, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 21929.141, "sample_time_ms": 11267.439, "load_time_ms": 17.928, "load_throughput": 223114.034, "learn_time_ms": 10640.807, "learn_throughput": 375.911, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 153, "training_iteration": 10, "trial_id": "default", "date": "2024-08-30_11-48-02", "timestamp": 1724989682, "time_this_iter_s": 22.3069908618927, "time_total_s": 219.36783146858215, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.36783146858215, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.948275862068966, "ram_util_percent": 9.93793103448276, "gpu_util_percent0": 0.09000000000000001, "vram_util_percent0": 0.07052296605603446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.701626140840592, "policy_loss": -0.0051416388762894494, "vf_loss": 9.704790395306002, "vf_explained_var": 0.0028675977901745867, "kl": 0.009886924432411317, "entropy": 4.309418717507393, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -186.23997791168367, "episode_len_mean": 295.05, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566], "episode_lengths": [91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397927493398867, "mean_inference_ms": 0.8682470372047181, "mean_action_processing_ms": 0.1448344914012601, "mean_env_wait_ms": 1.514353005828036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017960548400878906, "StateBufferConnector_ms": 0.004424571990966797, "ViewRequirementAgentConnector_ms": 0.08495378494262695}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -186.23997791168367, "episode_len_mean": 295.05, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180.30523419958362, -222.87786517017432, -182.0549115871593, -191.06902001190895, -223.35529798196072, -252.17105883743494, -257.41066433099536, -213.43778840160968, -215.8384743343799, -220.04875912505153, -198.91915561729192, -254.18795023735856, -224.78401164199173, -236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566], "episode_lengths": [91, 399, 36, 219, 235, 324, 399, 190, 149, 261, 84, 399, 399, 399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397927493398867, "mean_inference_ms": 0.8682470372047181, "mean_action_processing_ms": 0.1448344914012601, "mean_env_wait_ms": 1.514353005828036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017960548400878906, "StateBufferConnector_ms": 0.004424571990966797, "ViewRequirementAgentConnector_ms": 0.08495378494262695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.2882510242812, "num_env_steps_trained_throughput_per_sec": 182.2882510242812, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 21848.777, "sample_time_ms": 11256.639, "load_time_ms": 16.508, "load_throughput": 242308.757, "learn_time_ms": 10572.658, "learn_throughput": 378.334, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 166, "training_iteration": 11, "trial_id": "default", "date": "2024-08-30_11-48-24", "timestamp": 1724989704, "time_this_iter_s": 21.950888872146606, "time_total_s": 241.31872034072876, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.31872034072876, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 8.525, "ram_util_percent": 10.021428571428572, "gpu_util_percent0": 0.08642857142857142, "vram_util_percent0": 0.07054501488095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.361351176097449, "policy_loss": -0.005958389254507198, "vf_loss": 9.364778286346825, "vf_explained_var": -8.693273349474835e-05, "kl": 0.012656409858684738, "entropy": 4.249037092988209, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -177.97352186527277, "episode_len_mean": 305.88, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978], "episode_lengths": [399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23992788248102717, "mean_inference_ms": 0.867186626575271, "mean_action_processing_ms": 0.14485737858296205, "mean_env_wait_ms": 1.5144974461185894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017928123474121094, "StateBufferConnector_ms": 0.004402637481689453, "ViewRequirementAgentConnector_ms": 0.08447694778442383}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -177.97352186527277, "episode_len_mean": 305.88, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-236.99677077979746, -208.50582420535846, -175.813961984005, -151.046140038381, -184.7529801306157, -166.04114901566447, -123.2547952428852, -186.39465789905313, -218.29784171025273, -189.95251182850853, -201.69756090221944, -187.19398790132124, -167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978], "episode_lengths": [399, 147, 399, 399, 68, 353, 390, 399, 399, 399, 113, 154, 399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23992788248102717, "mean_inference_ms": 0.867186626575271, "mean_action_processing_ms": 0.14485737858296205, "mean_env_wait_ms": 1.5144974461185894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017928123474121094, "StateBufferConnector_ms": 0.004402637481689453, "ViewRequirementAgentConnector_ms": 0.08447694778442383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.7857355307165, "num_env_steps_trained_throughput_per_sec": 180.7857355307165, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 21890.048, "sample_time_ms": 11280.763, "load_time_ms": 12.808, "load_throughput": 312308.563, "learn_time_ms": 10593.511, "learn_throughput": 377.59, "synch_weights_time_ms": 2.182}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 179, "training_iteration": 12, "trial_id": "default", "date": "2024-08-30_11-48-46", "timestamp": 1724989726, "time_this_iter_s": 22.133503198623657, "time_total_s": 263.4522235393524, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.4522235393524, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 9.99310344827586, "ram_util_percent": 10.062068965517241, "gpu_util_percent0": 0.11724137931034484, "vram_util_percent0": 0.07052436916307471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.792807199621713, "policy_loss": -0.0004537876055736135, "vf_loss": 9.790555038247057, "vf_explained_var": 0.0004223717156276908, "kl": 0.013529742183789837, "entropy": 4.339975792874572, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -179.3470551353017, "episode_len_mean": 309.91, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069], "episode_lengths": [399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24003528251907538, "mean_inference_ms": 0.8655074783361915, "mean_action_processing_ms": 0.14477853999036863, "mean_env_wait_ms": 1.5147170588614944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017577409744262695, "StateBufferConnector_ms": 0.00441741943359375, "ViewRequirementAgentConnector_ms": 0.08439183235168457}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -262.2067512912989, "episode_reward_mean": -179.3470551353017, "episode_len_mean": 309.91, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-167.24367308646902, -183.9688624664903, -183.36206539420508, -176.66788061212645, -211.4172247813435, -250.7039042982214, -24.667206817854876, -262.2067512912989, -178.37864643869548, -185.48793463467555, -132.0847447129155, -174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069], "episode_lengths": [399, 367, 399, 399, 399, 260, 126, 263, 399, 399, 399, 285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24003528251907538, "mean_inference_ms": 0.8655074783361915, "mean_action_processing_ms": 0.14477853999036863, "mean_env_wait_ms": 1.5147170588614944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017577409744262695, "StateBufferConnector_ms": 0.00441741943359375, "ViewRequirementAgentConnector_ms": 0.08439183235168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.76944886716325, "num_env_steps_trained_throughput_per_sec": 189.76944886716325, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 21841.294, "sample_time_ms": 11311.523, "load_time_ms": 12.725, "load_throughput": 314352.557, "learn_time_ms": 10514.091, "learn_throughput": 380.442, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 191, "training_iteration": 13, "trial_id": "default", "date": "2024-08-30_11-49-07", "timestamp": 1724989747, "time_this_iter_s": 21.0849871635437, "time_total_s": 284.5372107028961, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 284.5372107028961, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 9.12962962962963, "ram_util_percent": 10.137037037037036, "gpu_util_percent0": 0.09851851851851852, "vram_util_percent0": 0.07051595052083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.682684528186757, "policy_loss": -0.006042833674338556, "vf_loss": 9.68613697380148, "vf_explained_var": 0.00026672001807920395, "kl": 0.012951977459056132, "entropy": 4.190214958498554, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -250.5136948558285, "episode_reward_mean": -181.4764433846358, "episode_len_mean": 309.75, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938], "episode_lengths": [285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2400700024544324, "mean_inference_ms": 0.8638904074281497, "mean_action_processing_ms": 0.14468303426904802, "mean_env_wait_ms": 1.5150215277658525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017465829849243164, "StateBufferConnector_ms": 0.004404544830322266, "ViewRequirementAgentConnector_ms": 0.0841064453125}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -250.5136948558285, "episode_reward_mean": -181.4764433846358, "episode_len_mean": 309.75, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-174.59712382580005, -193.57307996043062, -215.93482587794716, -146.85756354244165, -182.81734813553146, -204.7512303238441, -163.8024223346813, -192.13804500081216, -165.83302803356466, -179.65805051572895, -248.52700564473128, -129.6811075876468, -203.7702673172534, -227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938], "episode_lengths": [285, 56, 399, 399, 399, 86, 399, 399, 399, 374, 276, 399, 84, 338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2400700024544324, "mean_inference_ms": 0.8638904074281497, "mean_action_processing_ms": 0.14468303426904802, "mean_env_wait_ms": 1.5150215277658525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017465829849243164, "StateBufferConnector_ms": 0.004404544830322266, "ViewRequirementAgentConnector_ms": 0.0841064453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.94417892797605, "num_env_steps_trained_throughput_per_sec": 184.94417892797605, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 21779.693, "sample_time_ms": 11258.951, "load_time_ms": 12.649, "load_throughput": 316240.971, "learn_time_ms": 10505.186, "learn_throughput": 380.764, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 202, "training_iteration": 14, "trial_id": "default", "date": "2024-08-30_11-49-29", "timestamp": 1724989769, "time_this_iter_s": 21.634790182113647, "time_total_s": 306.17200088500977, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.17200088500977, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 8.842857142857143, "ram_util_percent": 10.185714285714285, "gpu_util_percent0": 0.09142857142857143, "vram_util_percent0": 0.07055082775297618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.661518146145728, "policy_loss": -0.006490001046369153, "vf_loss": 9.665391979935348, "vf_explained_var": 0.00968851286877868, "kl": 0.013080739238531413, "entropy": 4.13165783625777, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -250.5136948558285, "episode_reward_mean": -181.03763156836862, "episode_len_mean": 310.5, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721], "episode_lengths": [338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24008798930830821, "mean_inference_ms": 0.8615504194340515, "mean_action_processing_ms": 0.14457563221457329, "mean_env_wait_ms": 1.515671846736357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017890214920043945, "StateBufferConnector_ms": 0.004383087158203125, "ViewRequirementAgentConnector_ms": 0.08397984504699707}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -250.5136948558285, "episode_reward_mean": -181.03763156836862, "episode_len_mean": 310.5, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-227.7477868365093, -149.3654090522092, -214.74241808895562, -233.9495615399556, -138.44673620771007, -185.17705552857484, -180.75678936529675, -134.7671197261876, -218.54852230307736, -193.35891471926806, -226.12611004115234, -214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721], "episode_lengths": [338, 399, 399, 399, 399, 43, 399, 399, 399, 82, 138, 247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24008798930830821, "mean_inference_ms": 0.8615504194340515, "mean_action_processing_ms": 0.14457563221457329, "mean_env_wait_ms": 1.515671846736357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017890214920043945, "StateBufferConnector_ms": 0.004383087158203125, "ViewRequirementAgentConnector_ms": 0.08397984504699707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.48493484115528, "num_env_steps_trained_throughput_per_sec": 186.48493484115528, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 21703.365, "sample_time_ms": 11180.929, "load_time_ms": 12.682, "load_throughput": 315396.774, "learn_time_ms": 10506.831, "learn_throughput": 380.705, "synch_weights_time_ms": 2.137}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 215, "training_iteration": 15, "trial_id": "default", "date": "2024-08-30_11-49-50", "timestamp": 1724989790, "time_this_iter_s": 21.456829071044922, "time_total_s": 327.6288299560547, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 327.6288299560547, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.49642857142857, "ram_util_percent": 10.242857142857142, "gpu_util_percent0": 0.11928571428571429, "vram_util_percent0": 0.07051449730282737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.621241539780812, "policy_loss": -0.009354993745043713, "vf_loss": 9.627715981391168, "vf_explained_var": 0.011352697239127211, "kl": 0.01440274865285237, "entropy": 4.157883429527283, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.04707476352291, "episode_len_mean": 315.29, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004], "episode_lengths": [247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2401544380842126, "mean_inference_ms": 0.8602525350710016, "mean_action_processing_ms": 0.1445267991760477, "mean_env_wait_ms": 1.5159766859912915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018284320831298828, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.08417463302612305}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.04707476352291, "episode_len_mean": 315.29, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-214.3154182969133, -199.99077690439665, -151.71765222015364, -132.78472520703264, -231.86796533322644, -78.06084395352315, -218.69808320316048, -204.54019957784183, -177.33131673961284, -178.37268064167816, -175.7519658895875, -128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004], "episode_lengths": [247, 78, 399, 399, 189, 340, 206, 232, 399, 51, 399, 399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2401544380842126, "mean_inference_ms": 0.8602525350710016, "mean_action_processing_ms": 0.1445267991760477, "mean_env_wait_ms": 1.5159766859912915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018284320831298828, "StateBufferConnector_ms": 0.0043926239013671875, "ViewRequirementAgentConnector_ms": 0.08417463302612305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.39557968476205, "num_env_steps_trained_throughput_per_sec": 182.39557968476205, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 21734.948, "sample_time_ms": 11182.379, "load_time_ms": 12.72, "load_throughput": 314473.348, "learn_time_ms": 10536.911, "learn_throughput": 379.618, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 226, "training_iteration": 16, "trial_id": "default", "date": "2024-08-30_11-50-12", "timestamp": 1724989812, "time_this_iter_s": 21.93773365020752, "time_total_s": 349.5665636062622, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.5665636062622, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.73448275862069, "ram_util_percent": 10.344827586206897, "gpu_util_percent0": 0.08344827586206896, "vram_util_percent0": 0.07052436916307471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.302397003930102, "policy_loss": -0.010829799838604466, "vf_loss": 9.309265606505896, "vf_explained_var": 4.8926696982435e-05, "kl": 0.019805820613504374, "entropy": 4.065574228635398, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -182.92455476848647, "episode_len_mean": 326.96, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722], "episode_lengths": [399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24025485497743979, "mean_inference_ms": 0.8595499796816098, "mean_action_processing_ms": 0.14450912361572232, "mean_env_wait_ms": 1.5165846311153615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01856088638305664, "StateBufferConnector_ms": 0.004392385482788086, "ViewRequirementAgentConnector_ms": 0.08413934707641602}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -182.92455476848647, "episode_len_mean": 326.96, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-128.20150701981007, -186.57474693665569, -198.6287492394004, -139.11151838844677, -187.76652688754942, -195.4324069230263, -185.46518619271592, -197.21370920913768, -181.65419427712743, -206.23428849405613, -207.61057373148145, -177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722], "episode_lengths": [399, 86, 399, 399, 51, 172, 86, 399, 32, 399, 201, 399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24025485497743979, "mean_inference_ms": 0.8595499796816098, "mean_action_processing_ms": 0.14450912361572232, "mean_env_wait_ms": 1.5165846311153615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01856088638305664, "StateBufferConnector_ms": 0.004392385482788086, "ViewRequirementAgentConnector_ms": 0.08413934707641602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.4509830751795, "num_env_steps_trained_throughput_per_sec": 190.4509830751795, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 21669.408, "sample_time_ms": 11183.785, "load_time_ms": 12.891, "load_throughput": 310304.178, "learn_time_ms": 10469.771, "learn_throughput": 382.052, "synch_weights_time_ms": 2.152}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 237, "training_iteration": 17, "trial_id": "default", "date": "2024-08-30_11-50-33", "timestamp": 1724989833, "time_this_iter_s": 21.009347200393677, "time_total_s": 370.5759108066559, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.5759108066559, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 9.114814814814816, "ram_util_percent": 10.425925925925926, "gpu_util_percent0": 0.08740740740740742, "vram_util_percent0": 0.07055814766589506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.31776174217142, "policy_loss": -0.00483869802086584, "vf_loss": 9.31991620525237, "vf_explained_var": 0.00011751331308836578, "kl": 0.013421059818078033, "entropy": 4.208445268548945, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.70338625638928, "episode_len_mean": 341.34, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24034787495892004, "mean_inference_ms": 0.8585030966205872, "mean_action_processing_ms": 0.14445599047177862, "mean_env_wait_ms": 1.5172691464818429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019032001495361328, "StateBufferConnector_ms": 0.004403352737426758, "ViewRequirementAgentConnector_ms": 0.08423161506652832}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.70338625638928, "episode_len_mean": 341.34, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-177.56456455120718, -186.51654911702408, -176.02326835968674, -170.59682361848056, -221.15960414639852, -152.8998430871272, -194.72822609480542, -148.1498971530243, -218.087439238048, -119.13944991749935, -202.19406042943183, -131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 338, 399, 399, 79, 399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24034787495892004, "mean_inference_ms": 0.8585030966205872, "mean_action_processing_ms": 0.14445599047177862, "mean_env_wait_ms": 1.5172691464818429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019032001495361328, "StateBufferConnector_ms": 0.004403352737426758, "ViewRequirementAgentConnector_ms": 0.08423161506652832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.5029813994637, "num_env_steps_trained_throughput_per_sec": 179.5029813994637, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 21711.83, "sample_time_ms": 11208.04, "load_time_ms": 12.934, "load_throughput": 309259.718, "learn_time_ms": 10487.901, "learn_throughput": 381.392, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 248, "training_iteration": 18, "trial_id": "default", "date": "2024-08-30_11-50-55", "timestamp": 1724989855, "time_this_iter_s": 22.29102349281311, "time_total_s": 392.866934299469, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 392.866934299469, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 9.293103448275861, "ram_util_percent": 10.427586206896553, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.07042474856321838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.285215557086211, "policy_loss": -0.007323699781010228, "vf_loss": 9.289576682800888, "vf_explained_var": 6.094139109375656e-05, "kl": 0.014812925517867993, "entropy": 4.2728990408682055, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.5453230174987, "episode_len_mean": 341.24, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432], "episode_lengths": [399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.240430625952688, "mean_inference_ms": 0.8573169374471717, "mean_action_processing_ms": 0.144388332032517, "mean_env_wait_ms": 1.5176324107350154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898932456970215, "StateBufferConnector_ms": 0.004406929016113281, "ViewRequirementAgentConnector_ms": 0.08427691459655762}}, "episode_reward_max": -7.125279962749566, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -181.5453230174987, "episode_len_mean": 341.24, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-131.52861258190703, -208.76815235268944, -203.52552042865494, -176.27228887534793, -216.99385121508732, -207.87453561409495, -7.125279962749566, -173.8865197608112, -174.363836024648, -175.50679221301715, -36.57868613231079, -226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432], "episode_lengths": [399, 399, 110, 399, 230, 399, 38, 399, 355, 363, 152, 399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.240430625952688, "mean_inference_ms": 0.8573169374471717, "mean_action_processing_ms": 0.144388332032517, "mean_env_wait_ms": 1.5176324107350154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01898932456970215, "StateBufferConnector_ms": 0.004406929016113281, "ViewRequirementAgentConnector_ms": 0.08427691459655762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.05015768329153, "num_env_steps_trained_throughput_per_sec": 183.05015768329153, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 21759.238, "sample_time_ms": 11231.966, "load_time_ms": 9.297, "load_throughput": 430249.011, "learn_time_ms": 10515.025, "learn_throughput": 380.408, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 259, "training_iteration": 19, "trial_id": "default", "date": "2024-08-30_11-51-17", "timestamp": 1724989877, "time_this_iter_s": 21.859161138534546, "time_total_s": 414.72609543800354, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 414.72609543800354, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 7.07142857142857, "ram_util_percent": 10.435714285714287, "gpu_util_percent0": 0.09285714285714286, "vram_util_percent0": 0.06978207542782738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35602934027231, "policy_loss": -0.009329314939477432, "vf_loss": 9.3619240027602, "vf_explained_var": 2.227983167094569e-05, "kl": 0.017173391367591998, "entropy": 4.173964721413069, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -185.4426151964487, "episode_len_mean": 348.99, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975], "episode_lengths": [399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24038438471105203, "mean_inference_ms": 0.8562443727503396, "mean_action_processing_ms": 0.14429878728184942, "mean_env_wait_ms": 1.5179190014384585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018767595291137695, "StateBufferConnector_ms": 0.004377603530883789, "ViewRequirementAgentConnector_ms": 0.08429265022277832}}, "episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -185.4426151964487, "episode_len_mean": 348.99, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226.65245903646996, -176.45439726663915, -91.66676081035492, -185.17573887850682, -195.1347222676157, -200.00541308694056, -159.78051737602948, -137.60208078993028, -77.00666319253978, -178.73685886030836, -141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975], "episode_lengths": [399, 399, 399, 60, 289, 378, 399, 399, 277, 399, 399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24038438471105203, "mean_inference_ms": 0.8562443727503396, "mean_action_processing_ms": 0.14429878728184942, "mean_env_wait_ms": 1.5179190014384585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018767595291137695, "StateBufferConnector_ms": 0.004377603530883789, "ViewRequirementAgentConnector_ms": 0.08429265022277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.39734334077303, "num_env_steps_trained_throughput_per_sec": 184.39734334077303, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 21698.537, "sample_time_ms": 11208.367, "load_time_ms": 9.393, "load_throughput": 425870.629, "learn_time_ms": 10477.831, "learn_throughput": 381.758, "synch_weights_time_ms": 2.136}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 270, "training_iteration": 20, "trial_id": "default", "date": "2024-08-30_11-51-39", "timestamp": 1724989899, "time_this_iter_s": 21.696537733078003, "time_total_s": 436.42263317108154, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 436.42263317108154, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.964285714285712, "ram_util_percent": 10.549999999999999, "gpu_util_percent0": 0.10392857142857144, "vram_util_percent0": 0.06880696614583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.426475532593265, "policy_loss": -0.0107885377581722, "vf_loss": 9.43440739723944, "vf_explained_var": 4.580713087512601e-06, "kl": 0.014283280739509852, "entropy": 4.0722934089681155, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -187.0438967519757, "episode_len_mean": 353.57, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504], "episode_lengths": [399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2401107952864315, "mean_inference_ms": 0.855562653857576, "mean_action_processing_ms": 0.14417574331676652, "mean_env_wait_ms": 1.5177627923213564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018747568130493164, "StateBufferConnector_ms": 0.004366159439086914, "ViewRequirementAgentConnector_ms": 0.08413147926330566}}, "episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -187.0438967519757, "episode_len_mean": 353.57, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-141.641436624043, -187.53504653850635, -195.5590422770802, -190.23905747175144, -186.38608197421155, -194.73590540569796, -217.83518448370566, -216.38781150470695, -241.40967401822854, -183.1542963726078, -233.6811131101069, -195.88741837242026, -250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504], "episode_lengths": [399, 399, 283, 399, 52, 124, 393, 377, 399, 399, 399, 135, 399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2401107952864315, "mean_inference_ms": 0.855562653857576, "mean_action_processing_ms": 0.14417574331676652, "mean_env_wait_ms": 1.5177627923213564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018747568130493164, "StateBufferConnector_ms": 0.004366159439086914, "ViewRequirementAgentConnector_ms": 0.08413147926330566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.60698651867983, "num_env_steps_trained_throughput_per_sec": 183.60698651867983, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 21682.76, "sample_time_ms": 11170.744, "load_time_ms": 9.305, "load_throughput": 429895.122, "learn_time_ms": 10496.734, "learn_throughput": 381.071, "synch_weights_time_ms": 5.125}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 280, "training_iteration": 21, "trial_id": "default", "date": "2024-08-30_11-52-01", "timestamp": 1724989921, "time_this_iter_s": 21.79348087310791, "time_total_s": 458.21611404418945, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 458.21611404418945, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 7.824137931034482, "ram_util_percent": 10.658620689655171, "gpu_util_percent0": 0.0793103448275862, "vram_util_percent0": 0.06881819100215515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.228575648030928, "policy_loss": -0.00032045955379163065, "vf_loss": 9.226022976188249, "vf_explained_var": -3.3535624063143167e-06, "kl": 0.014365671222623754, "entropy": 4.092970332022636, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -183.0152141065869, "episode_len_mean": 358.91, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598], "episode_lengths": [399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23980374532292026, "mean_inference_ms": 0.8549465201276806, "mean_action_processing_ms": 0.14406169930776508, "mean_env_wait_ms": 1.51728203815779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018857240676879883, "StateBufferConnector_ms": 0.00434565544128418, "ViewRequirementAgentConnector_ms": 0.0841970443725586}}, "episode_reward_max": -21.05570270093447, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -183.0152141065869, "episode_len_mean": 358.91, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-250.5136948558285, -211.34234215640961, -169.23290282663555, -228.21747450927592, -191.28493724099033, -163.00991899884255, -179.39150769512474, -212.72730449482526, -140.7448709756117, -226.77534734173938, -124.46806924689288, -212.02339119099634, -231.12714568119816, -199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598], "episode_lengths": [399, 399, 399, 399, 399, 399, 284, 182, 399, 399, 399, 161, 399, 318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23980374532292026, "mean_inference_ms": 0.8549465201276806, "mean_action_processing_ms": 0.14406169930776508, "mean_env_wait_ms": 1.51728203815779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018857240676879883, "StateBufferConnector_ms": 0.00434565544128418, "ViewRequirementAgentConnector_ms": 0.0841970443725586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.49779262926583, "num_env_steps_trained_throughput_per_sec": 181.49779262926583, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 21674.083, "sample_time_ms": 11168.742, "load_time_ms": 9.397, "load_throughput": 425686.934, "learn_time_ms": 10490.01, "learn_throughput": 381.315, "synch_weights_time_ms": 5.092}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 292, "training_iteration": 22, "trial_id": "default", "date": "2024-08-30_11-52-23", "timestamp": 1724989943, "time_this_iter_s": 22.04570436477661, "time_total_s": 480.26181840896606, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 480.26181840896606, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 9.828571428571427, "ram_util_percent": 10.760714285714284, "gpu_util_percent0": 0.10607142857142857, "vram_util_percent0": 0.06883021763392856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.330225699567436, "policy_loss": -0.010221064695587723, "vf_loss": 8.33684114906336, "vf_explained_var": -1.774404638557024e-05, "kl": 0.018027959599833384, "entropy": 4.2613647307119065, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -178.5058385561428, "episode_len_mean": 352.12, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239], "episode_lengths": [318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2395807326469085, "mean_inference_ms": 0.8551574558610398, "mean_action_processing_ms": 0.14403971775699562, "mean_env_wait_ms": 1.5169499291031554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01907515525817871, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.08473610877990723}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -178.5058385561428, "episode_len_mean": 352.12, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-199.92534405142686, -154.6353613343704, -215.75357799187486, -205.49167199922329, -242.59129674842427, -168.95095762053185, -183.29273476411583, -189.2113302849144, -33.93355002425116, -196.6554855354721, -197.8529323143938, -260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239], "episode_lengths": [318, 399, 356, 399, 399, 399, 399, 94, 150, 157, 399, 399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2395807326469085, "mean_inference_ms": 0.8551574558610398, "mean_action_processing_ms": 0.14403971775699562, "mean_env_wait_ms": 1.5169499291031554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01907515525817871, "StateBufferConnector_ms": 0.004378080368041992, "ViewRequirementAgentConnector_ms": 0.08473610877990723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.22936105988066, "num_env_steps_trained_throughput_per_sec": 179.22936105988066, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 21798.04, "sample_time_ms": 11190.66, "load_time_ms": 9.368, "load_throughput": 427002.217, "learn_time_ms": 10592.069, "learn_throughput": 377.641, "synch_weights_time_ms": 5.096}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 305, "training_iteration": 23, "trial_id": "default", "date": "2024-08-30_11-52-45", "timestamp": 1724989965, "time_this_iter_s": 22.325177907943726, "time_total_s": 502.5869963169098, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.5869963169098, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 9.341379310344829, "ram_util_percent": 10.820689655172412, "gpu_util_percent0": 0.11034482758620692, "vram_util_percent0": 0.068811175466954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.643398916657253, "policy_loss": -0.010913107684382828, "vf_loss": 8.651604671952544, "vf_explained_var": -0.021418148663736158, "kl": 0.013536736459198659, "entropy": 4.497312015359119, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -177.93488630020545, "episode_len_mean": 356.73, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679], "episode_lengths": [399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23961534961573683, "mean_inference_ms": 0.8555624082235559, "mean_action_processing_ms": 0.1440696302890093, "mean_env_wait_ms": 1.516950869916076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018546104431152344, "StateBufferConnector_ms": 0.004412651062011719, "ViewRequirementAgentConnector_ms": 0.08466100692749023}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -298.44783664529206, "episode_reward_mean": -177.93488630020545, "episode_len_mean": 356.73, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-260.5376724801897, -196.15707807106065, -155.84002692483804, -236.73530477092564, -155.35343968211728, -237.51753850162504, -21.05570270093447, -298.44783664529206, -227.01916951921794, -117.41404131373004, -200.8614408887014, -194.880482778095, -165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679], "episode_lengths": [399, 196, 399, 399, 399, 399, 86, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23961534961573683, "mean_inference_ms": 0.8555624082235559, "mean_action_processing_ms": 0.1440696302890093, "mean_env_wait_ms": 1.516950869916076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018546104431152344, "StateBufferConnector_ms": 0.004412651062011719, "ViewRequirementAgentConnector_ms": 0.08466100692749023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.95973703455164, "num_env_steps_trained_throughput_per_sec": 179.95973703455164, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 21857.944, "sample_time_ms": 11229.903, "load_time_ms": 9.471, "load_throughput": 422320.125, "learn_time_ms": 10612.592, "learn_throughput": 376.911, "synch_weights_time_ms": 5.111}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 316, "training_iteration": 24, "trial_id": "default", "date": "2024-08-30_11-53-08", "timestamp": 1724989988, "time_this_iter_s": 22.234526872634888, "time_total_s": 524.8215231895447, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 524.8215231895447, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.951724137931034, "ram_util_percent": 10.844827586206897, "gpu_util_percent0": 0.07310344827586207, "vram_util_percent0": 0.06881398168103449}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.293552397752322, "policy_loss": -0.011405871952733685, "vf_loss": 8.30101872086525, "vf_explained_var": -0.01519607933618689, "kl": 0.01969774243267268, "entropy": 4.261095676114483, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -249.60648074683903, "episode_reward_mean": -175.87688203718452, "episode_len_mean": 353.18, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884], "episode_lengths": [399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2396655143187398, "mean_inference_ms": 0.8555053946430031, "mean_action_processing_ms": 0.144101644084723, "mean_env_wait_ms": 1.5172350940163069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018103599548339844, "StateBufferConnector_ms": 0.004410505294799805, "ViewRequirementAgentConnector_ms": 0.08474993705749512}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -249.60648074683903, "episode_reward_mean": -175.87688203718452, "episode_len_mean": 353.18, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-165.13387256870757, -195.21247415069263, -204.07073058183735, -176.80907088054317, -202.70236905740956, -171.5021239738019, -219.38049438322483, -249.20190883186837, -171.42466036860722, -108.05321957012134, -158.07053341929992, -153.32315757949945, -215.95235547417514, -187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884], "episode_lengths": [399, 399, 399, 399, 399, 399, 116, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2396655143187398, "mean_inference_ms": 0.8555053946430031, "mean_action_processing_ms": 0.144101644084723, "mean_env_wait_ms": 1.5172350940163069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018103599548339844, "StateBufferConnector_ms": 0.004410505294799805, "ViewRequirementAgentConnector_ms": 0.08474993705749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.37809492648796, "num_env_steps_trained_throughput_per_sec": 191.37809492648796, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 21803.104, "sample_time_ms": 11270.061, "load_time_ms": 13.092, "load_throughput": 305520.792, "learn_time_ms": 10513.988, "learn_throughput": 380.446, "synch_weights_time_ms": 5.097}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 328, "training_iteration": 25, "trial_id": "default", "date": "2024-08-30_11-53-29", "timestamp": 1724990009, "time_this_iter_s": 20.90815043449402, "time_total_s": 545.7296736240387, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 545.7296736240387, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.900000000000002, "ram_util_percent": 10.955555555555557, "gpu_util_percent0": 0.09703703703703705, "vram_util_percent0": 0.06882505063657407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.353868254242084, "policy_loss": -0.00691607827821406, "vf_loss": 9.357054360034645, "vf_explained_var": -0.013748109532940773, "kl": 0.018649661793641283, "entropy": 4.291106588609757, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -249.60648074683903, "episode_reward_mean": -175.55777468356374, "episode_len_mean": 344.49, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766], "episode_lengths": [399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2396808474452898, "mean_inference_ms": 0.8551163146847307, "mean_action_processing_ms": 0.14411471250547186, "mean_env_wait_ms": 1.5173804530774495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01750326156616211, "StateBufferConnector_ms": 0.004405498504638672, "ViewRequirementAgentConnector_ms": 0.08469009399414062}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -249.60648074683903, "episode_reward_mean": -175.55777468356374, "episode_len_mean": 344.49, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187.18303286637305, -174.7492212827284, -249.60648074683903, -161.40558693122082, -145.72440931274264, -138.0303937360102, -199.67816517067462, -203.3994765292658, -221.61208728556716, -127.7325223618727, -134.44242476659295, -110.14329116595671, -226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766], "episode_lengths": [399, 399, 399, 399, 399, 399, 71, 399, 208, 399, 399, 399, 399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2396808474452898, "mean_inference_ms": 0.8551163146847307, "mean_action_processing_ms": 0.14411471250547186, "mean_env_wait_ms": 1.5173804530774495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01750326156616211, "StateBufferConnector_ms": 0.004405498504638672, "ViewRequirementAgentConnector_ms": 0.08469009399414062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.37827112178135, "num_env_steps_trained_throughput_per_sec": 186.37827112178135, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 21756.239, "sample_time_ms": 11223.967, "load_time_ms": 13.106, "load_throughput": 305196.774, "learn_time_ms": 10513.177, "learn_throughput": 380.475, "synch_weights_time_ms": 5.111}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 341, "training_iteration": 26, "trial_id": "default", "date": "2024-08-30_11-53-50", "timestamp": 1724990030, "time_this_iter_s": 21.469238758087158, "time_total_s": 567.1989123821259, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 567.1989123821259, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 7.8392857142857135, "ram_util_percent": 11.035714285714286, "gpu_util_percent0": 0.10535714285714286, "vram_util_percent0": 0.06880841936383929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.261874936392871, "policy_loss": -0.011152003176750675, "vf_loss": 9.269071920264151, "vf_explained_var": 0.023153016323684363, "kl": 0.019775083358634277, "entropy": 4.074046863279035, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -262.14755467280963, "episode_reward_mean": -179.78585961746975, "episode_len_mean": 340.84, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996], "episode_lengths": [399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397487288624702, "mean_inference_ms": 0.8550185790366948, "mean_action_processing_ms": 0.14411800307396264, "mean_env_wait_ms": 1.5174802503387748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017148733139038086, "StateBufferConnector_ms": 0.0044515132904052734, "ViewRequirementAgentConnector_ms": 0.0850515365600586}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -262.14755467280963, "episode_reward_mean": -179.78585961746975, "episode_len_mean": 340.84, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226.0627771939318, -207.33771143880261, -174.26754414937335, -168.2160107941869, -184.01058597217508, -194.02897016595432, -190.9605978131345, -235.2261660526959, -192.16855937121005, -181.44003083338092, -150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996], "episode_lengths": [399, 399, 399, 399, 399, 199, 399, 399, 399, 28, 399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397487288624702, "mean_inference_ms": 0.8550185790366948, "mean_action_processing_ms": 0.14411800307396264, "mean_env_wait_ms": 1.5174802503387748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017148733139038086, "StateBufferConnector_ms": 0.0044515132904052734, "ViewRequirementAgentConnector_ms": 0.0850515365600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.24087014676502, "num_env_steps_trained_throughput_per_sec": 178.24087014676502, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 21900.116, "sample_time_ms": 11264.819, "load_time_ms": 12.967, "load_throughput": 308465.378, "learn_time_ms": 10616.337, "learn_throughput": 376.778, "synch_weights_time_ms": 5.118}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 353, "training_iteration": 27, "trial_id": "default", "date": "2024-08-30_11-54-13", "timestamp": 1724990053, "time_this_iter_s": 22.448413610458374, "time_total_s": 589.6473259925842, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 589.6473259925842, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 10.40344827586207, "ram_util_percent": 11.0448275862069, "gpu_util_percent0": 0.08758620689655174, "vram_util_percent0": 0.06880977235991378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.990233963761999, "policy_loss": -0.02173633811775074, "vf_loss": 8.007815910411137, "vf_explained_var": 0.029974567569712156, "kl": 0.020772062233347714, "entropy": 3.9993275001484863, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -274.1768659843333, "episode_reward_mean": -177.73109850633062, "episode_len_mean": 346.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23987797371081676, "mean_inference_ms": 0.8552414196272378, "mean_action_processing_ms": 0.14416367397885124, "mean_env_wait_ms": 1.518004282526465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01720142364501953, "StateBufferConnector_ms": 0.0044612884521484375, "ViewRequirementAgentConnector_ms": 0.08529019355773926}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -274.1768659843333, "episode_reward_mean": -177.73109850633062, "episode_len_mean": 346.33, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150.0974474131474, -164.34615298026773, -199.57000083254883, -179.08282643858968, -211.20839568034864, -186.1429781126731, -211.91013752831975, -91.37016262391712, -170.85362335977763, -230.93039784226767, -128.94106287456077, -215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 265, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23987797371081676, "mean_inference_ms": 0.8552414196272378, "mean_action_processing_ms": 0.14416367397885124, "mean_env_wait_ms": 1.518004282526465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01720142364501953, "StateBufferConnector_ms": 0.0044612884521484375, "ViewRequirementAgentConnector_ms": 0.08529019355773926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.12114813033378, "num_env_steps_trained_throughput_per_sec": 174.12114813033378, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 21968.991, "sample_time_ms": 11339.728, "load_time_ms": 12.977, "load_throughput": 308240.953, "learn_time_ms": 10610.234, "learn_throughput": 376.995, "synch_weights_time_ms": 5.163}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 363, "training_iteration": 28, "trial_id": "default", "date": "2024-08-30_11-54-36", "timestamp": 1724990076, "time_this_iter_s": 22.981637716293335, "time_total_s": 612.6289637088776, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 612.6289637088776, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 15.46896551724138, "ram_util_percent": 11.117241379310347, "gpu_util_percent0": 0.20862068965517241, "vram_util_percent0": 0.17249377020474138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.164041514678669, "policy_loss": -0.011888019191802188, "vf_loss": 9.171499128495494, "vf_explained_var": 0.004132037137144356, "kl": 0.014767993093479054, "entropy": 4.27705281396066, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -274.1768659843333, "episode_reward_mean": -181.22338437363308, "episode_len_mean": 343.75, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24007591568907316, "mean_inference_ms": 0.8555090365606136, "mean_action_processing_ms": 0.1442608107928589, "mean_env_wait_ms": 1.5189038152086585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017232656478881836, "StateBufferConnector_ms": 0.004483222961425781, "ViewRequirementAgentConnector_ms": 0.08563971519470215}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -274.1768659843333, "episode_reward_mean": -181.22338437363308, "episode_len_mean": 343.75, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-215.55396837246005, -152.2782341536186, -223.69966404740333, -238.77736287161144, -139.63392751692942, -196.30536345548504, -179.2644323096126, -184.86214119538838, -172.75083229688906, -145.02136484896948, -187.50738381173872, -27.447683048498657, -172.2219319352804, -170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 94, 399, 208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24007591568907316, "mean_inference_ms": 0.8555090365606136, "mean_action_processing_ms": 0.1442608107928589, "mean_env_wait_ms": 1.5189038152086585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017232656478881836, "StateBufferConnector_ms": 0.004483222961425781, "ViewRequirementAgentConnector_ms": 0.08563971519470215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.25284780729535, "num_env_steps_trained_throughput_per_sec": 179.25284780729535, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 22015.282, "sample_time_ms": 11393.15, "load_time_ms": 17.05, "load_throughput": 234610.612, "learn_time_ms": 10599.025, "learn_throughput": 377.393, "synch_weights_time_ms": 5.164}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 374, "training_iteration": 29, "trial_id": "default", "date": "2024-08-30_11-54-58", "timestamp": 1724990098, "time_this_iter_s": 22.32205057144165, "time_total_s": 634.9510142803192, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 634.9510142803192, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 15.448275862068964, "ram_util_percent": 10.096551724137932, "gpu_util_percent0": 0.1803448275862069, "vram_util_percent0": 0.17547817887931033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.977367642810268, "policy_loss": -0.008007135254240806, "vf_loss": 8.981626358211681, "vf_explained_var": 0.008741361864151493, "kl": 0.012494641454998394, "entropy": 4.3128133981458605, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -4.720818755840227, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -183.5135953557582, "episode_len_mean": 335.84, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414], "episode_lengths": [208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24034278785229163, "mean_inference_ms": 0.8559876402581051, "mean_action_processing_ms": 0.14439460594129552, "mean_env_wait_ms": 1.5201129759461331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017319917678833008, "StateBufferConnector_ms": 0.004482269287109375, "ViewRequirementAgentConnector_ms": 0.08594560623168945}}, "episode_reward_max": -4.720818755840227, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -183.5135953557582, "episode_len_mean": 335.84, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-170.70477365922926, -130.9336683806835, -225.91112555093196, -161.84877981084452, -223.10968676612598, -4.720818755840227, -146.93883415011874, -225.07564927952632, -213.02317133071784, -197.5366010444831, -149.19928209430958, -158.6896477445419, -233.59126449865926, -183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414], "episode_lengths": [208, 399, 399, 399, 399, 26, 399, 399, 399, 116, 399, 399, 299, 192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24034278785229163, "mean_inference_ms": 0.8559876402581051, "mean_action_processing_ms": 0.14439460594129552, "mean_env_wait_ms": 1.5201129759461331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017319917678833008, "StateBufferConnector_ms": 0.004482269287109375, "ViewRequirementAgentConnector_ms": 0.08594560623168945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.79720701832613, "num_env_steps_trained_throughput_per_sec": 178.79720701832613, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 22083.226, "sample_time_ms": 11413.939, "load_time_ms": 17.074, "load_throughput": 234278.413, "learn_time_ms": 10646.145, "learn_throughput": 375.723, "synch_weights_time_ms": 5.169}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 387, "training_iteration": 30, "trial_id": "default", "date": "2024-08-30_11-55-21", "timestamp": 1724990121, "time_this_iter_s": 22.37865900993347, "time_total_s": 657.3296732902527, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 657.3296732902527, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.92758620689655, "ram_util_percent": 9.427586206896551, "gpu_util_percent0": 0.13931034482758625, "vram_util_percent0": 0.1739010865660919}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.858918877314496, "policy_loss": -0.01453349539028701, "vf_loss": 8.86843460259899, "vf_explained_var": 0.02000090249123112, "kl": 0.016725838709994008, "entropy": 4.185986904944143, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.20057121416613, "episode_len_mean": 331.97, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269], "episode_lengths": [192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2405825227174635, "mean_inference_ms": 0.8563154069071092, "mean_action_processing_ms": 0.14448084303607217, "mean_env_wait_ms": 1.521076378525134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017443418502807617, "StateBufferConnector_ms": 0.004485130310058594, "ViewRequirementAgentConnector_ms": 0.08588552474975586}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.20057121416613, "episode_len_mean": 331.97, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183.5648548202351, -66.75801044604378, -208.60968423163922, -140.19750605502205, -162.0160277188239, -183.7676284468134, -132.71503608185898, -224.64717494132842, -224.00861337673064, -122.84078839465815, -201.3155230178792, -115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269], "episode_lengths": [192, 224, 288, 399, 399, 399, 399, 399, 399, 399, 399, 399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2405825227174635, "mean_inference_ms": 0.8563154069071092, "mean_action_processing_ms": 0.14448084303607217, "mean_env_wait_ms": 1.521076378525134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017443418502807617, "StateBufferConnector_ms": 0.004485130310058594, "ViewRequirementAgentConnector_ms": 0.08588552474975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.15053535691308, "num_env_steps_trained_throughput_per_sec": 190.15053535691308, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 22008.273, "sample_time_ms": 11437.112, "load_time_ms": 17.019, "load_throughput": 235037.559, "learn_time_ms": 10551.114, "learn_throughput": 379.107, "synch_weights_time_ms": 2.171}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 400, "training_iteration": 31, "trial_id": "default", "date": "2024-08-30_11-55-42", "timestamp": 1724990142, "time_this_iter_s": 21.04354190826416, "time_total_s": 678.3732151985168, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 678.3732151985168, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.86296296296296, "ram_util_percent": 9.488888888888889, "gpu_util_percent0": 0.13592592592592595, "vram_util_percent0": 0.1732780550733025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.016225381724295, "policy_loss": -0.013408379815518855, "vf_loss": 9.025777709804556, "vf_explained_var": 0.003312371943586616, "kl": 0.01285350911257627, "entropy": 4.331197190028365, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -188.17136725493327, "episode_len_mean": 336.01, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834], "episode_lengths": [399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407038859997448, "mean_inference_ms": 0.8567149092684272, "mean_action_processing_ms": 0.14456635999466402, "mean_env_wait_ms": 1.5218948220079802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017440080642700195, "StateBufferConnector_ms": 0.004467487335205078, "ViewRequirementAgentConnector_ms": 0.08602261543273926}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -188.17136725493327, "episode_len_mean": 336.01, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115.92629243384087, -195.43495789498485, -204.57759482431086, -135.2052610156851, -190.7601466471679, -241.12137500576685, -224.353969108635, -131.66035914533956, -132.89434430737546, -123.99299345860416, -179.1623545811918, -151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834], "episode_lengths": [399, 213, 174, 399, 351, 399, 176, 399, 399, 399, 399, 399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407038859997448, "mean_inference_ms": 0.8567149092684272, "mean_action_processing_ms": 0.14456635999466402, "mean_env_wait_ms": 1.5218948220079802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017440080642700195, "StateBufferConnector_ms": 0.004467487335205078, "ViewRequirementAgentConnector_ms": 0.08602261543273926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.89333590392567, "num_env_steps_trained_throughput_per_sec": 180.89333590392567, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 22015.637, "sample_time_ms": 11475.821, "load_time_ms": 17.016, "load_throughput": 235068.185, "learn_time_ms": 10519.729, "learn_throughput": 380.238, "synch_weights_time_ms": 2.195}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 411, "training_iteration": 32, "trial_id": "default", "date": "2024-08-30_11-56-04", "timestamp": 1724990164, "time_this_iter_s": 22.119300365447998, "time_total_s": 700.4925155639648, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 700.4925155639648, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 11.83448275862069, "ram_util_percent": 9.593103448275864, "gpu_util_percent0": 0.19551724137931034, "vram_util_percent0": 0.17780453035201146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.423585548452152, "policy_loss": -0.018427309231652367, "vf_loss": 8.435867344179462, "vf_explained_var": 0.0005883996204663349, "kl": 0.020484987477343945, "entropy": 4.271489636359676, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -188.65161735214664, "episode_len_mean": 336.29, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149], "episode_lengths": [399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24076044354135953, "mean_inference_ms": 0.8575033797678483, "mean_action_processing_ms": 0.1446527771418746, "mean_env_wait_ms": 1.5226117036427984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01750969886779785, "StateBufferConnector_ms": 0.0044667720794677734, "ViewRequirementAgentConnector_ms": 0.08637237548828125}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -188.65161735214664, "episode_len_mean": 336.29, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151.31978474751583, -188.99692282636846, -125.4180528537976, -207.2941905212788, -210.75853727754344, -179.04642414121884, -175.22770285607982, -176.19232760248119, -182.2862152039119, -56.56554672175603, -201.91929015159508, -213.5313140792942, -193.67364755355092, -180.1577504889947, -187.01681477653085, -234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149], "episode_lengths": [399, 62, 399, 376, 111, 399, 399, 399, 67, 288, 104, 399, 399, 399, 399, 304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24076044354135953, "mean_inference_ms": 0.8575033797678483, "mean_action_processing_ms": 0.1446527771418746, "mean_env_wait_ms": 1.5226117036427984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01750969886779785, "StateBufferConnector_ms": 0.0044667720794677734, "ViewRequirementAgentConnector_ms": 0.08637237548828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.86250455412807, "num_env_steps_trained_throughput_per_sec": 178.86250455412807, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 22020.214, "sample_time_ms": 11471.749, "load_time_ms": 17.06, "load_throughput": 234460.449, "learn_time_ms": 10528.29, "learn_throughput": 379.929, "synch_weights_time_ms": 2.224}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 422, "training_iteration": 33, "trial_id": "default", "date": "2024-08-30_11-56-26", "timestamp": 1724990186, "time_this_iter_s": 22.371931552886963, "time_total_s": 722.8644471168518, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 722.8644471168518, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.903448275862068, "ram_util_percent": 9.562068965517241, "gpu_util_percent0": 0.14758620689655172, "vram_util_percent0": 0.17894104705459776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.478555804747407, "policy_loss": -0.01034107777059719, "vf_loss": 8.48395147426154, "vf_explained_var": -0.0001707860859491492, "kl": 0.01098982596485888, "entropy": 4.259138945097565, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -187.38113937268594, "episode_len_mean": 333.17, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018], "episode_lengths": [304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24087878815621597, "mean_inference_ms": 0.8590319287330402, "mean_action_processing_ms": 0.1447959602924453, "mean_env_wait_ms": 1.5236264812528146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017821550369262695, "StateBufferConnector_ms": 0.004483938217163086, "ViewRequirementAgentConnector_ms": 0.08651423454284668}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -187.38113937268594, "episode_len_mean": 333.17, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.85171819360417, -193.2711022032523, -206.53645851903124, -157.69634712762766, -172.15240890219593, -222.23215834324188, -195.3148759158179, -242.86384905049684, -173.99120152292232, -235.04965762063802, -262.14755467280963, -216.87643049768621, -132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018], "episode_lengths": [304, 80, 399, 399, 214, 399, 399, 399, 399, 253, 358, 143, 399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24087878815621597, "mean_inference_ms": 0.8590319287330402, "mean_action_processing_ms": 0.1447959602924453, "mean_env_wait_ms": 1.5236264812528146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017821550369262695, "StateBufferConnector_ms": 0.004483938217163086, "ViewRequirementAgentConnector_ms": 0.08651423454284668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.7491107141138, "num_env_steps_trained_throughput_per_sec": 178.7491107141138, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 22035.267, "sample_time_ms": 11466.429, "load_time_ms": 17.081, "load_throughput": 234184.886, "learn_time_ms": 10548.625, "learn_throughput": 379.196, "synch_weights_time_ms": 2.24}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 437, "training_iteration": 34, "trial_id": "default", "date": "2024-08-30_11-56-49", "timestamp": 1724990209, "time_this_iter_s": 22.385424852371216, "time_total_s": 745.249871969223, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 745.249871969223, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 9.606896551724137, "ram_util_percent": 9.610344827586207, "gpu_util_percent0": 0.14827586206896554, "vram_util_percent0": 0.17886527927442528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.326614384497365, "policy_loss": -0.015444148337889102, "vf_loss": 9.3346434398364, "vf_explained_var": 0.00027567423799986483, "kl": 0.01647801775684461, "entropy": 4.201022275545264, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -184.4663207087109, "episode_len_mean": 333.37, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347], "episode_lengths": [399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094681353323832, "mean_inference_ms": 0.8601030338350464, "mean_action_processing_ms": 0.1449185936917523, "mean_env_wait_ms": 1.5243941423990628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017712116241455078, "StateBufferConnector_ms": 0.004448413848876953, "ViewRequirementAgentConnector_ms": 0.08626508712768555}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -184.4663207087109, "episode_len_mean": 333.37, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-132.10156557654074, -261.3477193479659, -171.36577728011355, -191.07238681601996, -150.42473287540125, -274.1768659843333, -144.49143652528758, -129.71498362075525, -161.80085145289482, -133.1169629266591, -144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347], "episode_lengths": [399, 399, 399, 143, 399, 377, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094681353323832, "mean_inference_ms": 0.8601030338350464, "mean_action_processing_ms": 0.1449185936917523, "mean_env_wait_ms": 1.5243941423990628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017712116241455078, "StateBufferConnector_ms": 0.004448413848876953, "ViewRequirementAgentConnector_ms": 0.08626508712768555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.54897066309292, "num_env_steps_trained_throughput_per_sec": 188.54897066309292, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 22066.614, "sample_time_ms": 11452.618, "load_time_ms": 17.17, "load_throughput": 232958.002, "learn_time_ms": 10590.457, "learn_throughput": 377.699, "synch_weights_time_ms": 5.385}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 449, "training_iteration": 35, "trial_id": "default", "date": "2024-08-30_11-57-10", "timestamp": 1724990230, "time_this_iter_s": 21.224284648895264, "time_total_s": 766.4741566181183, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 766.4741566181183, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 9.217857142857143, "ram_util_percent": 9.632142857142856, "gpu_util_percent0": 0.0892857142857143, "vram_util_percent0": 0.17930385044642858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.627380925352856, "policy_loss": -0.01423186995489623, "vf_loss": 9.636169218760665, "vf_explained_var": 0.0001225931029165945, "kl": 0.012096867441532958, "entropy": 4.590015137836497, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.44609308147662, "episode_len_mean": 335.47, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24097269045016848, "mean_inference_ms": 0.8609443766171929, "mean_action_processing_ms": 0.14500910049475846, "mean_env_wait_ms": 1.5247956270907428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017677783966064453, "StateBufferConnector_ms": 0.0044519901275634766, "ViewRequirementAgentConnector_ms": 0.08624744415283203}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.44609308147662, "episode_len_mean": 335.47, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-144.6157902532882, -234.04545639430052, -167.1481405508263, -208.70762208718577, -188.44682167519673, -250.36565037575733, -151.72857289635715, -251.65590409072533, -223.9926920299433, -194.51864372211804, -175.8349821593124, -185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 336, 399, 70, 399, 399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24097269045016848, "mean_inference_ms": 0.8609443766171929, "mean_action_processing_ms": 0.14500910049475846, "mean_env_wait_ms": 1.5247956270907428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017677783966064453, "StateBufferConnector_ms": 0.0044519901275634766, "ViewRequirementAgentConnector_ms": 0.08624744415283203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.24280716215983, "num_env_steps_trained_throughput_per_sec": 186.24280716215983, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 22068.177, "sample_time_ms": 11541.576, "load_time_ms": 17.115, "load_throughput": 233709.578, "learn_time_ms": 10503.127, "learn_throughput": 380.839, "synch_weights_time_ms": 5.378}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 459, "training_iteration": 36, "trial_id": "default", "date": "2024-08-30_11-57-32", "timestamp": 1724990252, "time_this_iter_s": 21.48413610458374, "time_total_s": 787.958292722702, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 787.958292722702, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 9.962962962962964, "ram_util_percent": 9.7, "gpu_util_percent0": 0.14851851851851852, "vram_util_percent0": 0.1791419511959877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.449031874825877, "policy_loss": -0.009634486395585281, "vf_loss": 8.452960023123731, "vf_explained_var": -0.00010533435370332451, "kl": 0.012680731086413143, "entropy": 4.399766010879189, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.26564693338148, "episode_len_mean": 335.6, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626], "episode_lengths": [399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2409615278782386, "mean_inference_ms": 0.8618660668745263, "mean_action_processing_ms": 0.14507114872576227, "mean_env_wait_ms": 1.524863964678552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017719268798828125, "StateBufferConnector_ms": 0.004460334777832031, "ViewRequirementAgentConnector_ms": 0.08637547492980957}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -276.7108876955416, "episode_reward_mean": -185.26564693338148, "episode_len_mean": 335.6, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.01369054932337, -196.96390602820898, -230.13704636674262, -225.02386252297924, -221.06254891888767, -276.7108876955416, -169.1640944796899, -120.36673193873527, -176.80105076724954, -188.70350040777433, -240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626], "episode_lengths": [399, 399, 399, 399, 399, 377, 399, 399, 249, 59, 399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2409615278782386, "mean_inference_ms": 0.8618660668745263, "mean_action_processing_ms": 0.14507114872576227, "mean_env_wait_ms": 1.524863964678552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017719268798828125, "StateBufferConnector_ms": 0.004460334777832031, "ViewRequirementAgentConnector_ms": 0.08637547492980957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.2885966702342, "num_env_steps_trained_throughput_per_sec": 178.2885966702342, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 22067.576, "sample_time_ms": 11532.072, "load_time_ms": 17.126, "load_throughput": 233562.517, "learn_time_ms": 10512.031, "learn_throughput": 380.516, "synch_weights_time_ms": 5.364}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 470, "training_iteration": 37, "trial_id": "default", "date": "2024-08-30_11-57-54", "timestamp": 1724990274, "time_this_iter_s": 22.44274401664734, "time_total_s": 810.4010367393494, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 810.4010367393494, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.213793103448275, "ram_util_percent": 9.803448275862067, "gpu_util_percent0": 0.16137931034482758, "vram_util_percent0": 0.17784241424209768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.18503532281486, "policy_loss": -0.013288728390089287, "vf_loss": 9.193520511702825, "vf_explained_var": 0.00010209006647909841, "kl": 0.01067451236914204, "entropy": 4.44163025271508, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -8.299455754656185, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -183.02437926654412, "episode_len_mean": 340.72, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719], "episode_lengths": [399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094812395426377, "mean_inference_ms": 0.8627590082608012, "mean_action_processing_ms": 0.14513058009364652, "mean_env_wait_ms": 1.5249114188789594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017723798751831055, "StateBufferConnector_ms": 0.0044748783111572266, "ViewRequirementAgentConnector_ms": 0.08643269538879395}}, "episode_reward_max": -8.299455754656185, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -183.02437926654412, "episode_len_mean": 340.72, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-240.95164018226058, -183.3441321875951, -190.19219342055092, -155.05778443202996, -171.22146857038703, -216.60408850945615, -154.1652665662414, -150.58987997738203, -8.299455754656185, -185.97983650447503, -187.79047998011293, -216.14368715807356, -159.83459893697162, -246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719], "episode_lengths": [399, 399, 83, 399, 399, 131, 399, 399, 33, 399, 111, 211, 399, 379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094812395426377, "mean_inference_ms": 0.8627590082608012, "mean_action_processing_ms": 0.14513058009364652, "mean_env_wait_ms": 1.5249114188789594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017723798751831055, "StateBufferConnector_ms": 0.0044748783111572266, "ViewRequirementAgentConnector_ms": 0.08643269538879395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.09432598541522, "num_env_steps_trained_throughput_per_sec": 179.09432598541522, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 22003.785, "sample_time_ms": 11489.493, "load_time_ms": 17.313, "load_throughput": 231045.302, "learn_time_ms": 10490.674, "learn_throughput": 381.291, "synch_weights_time_ms": 5.328}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 480, "training_iteration": 38, "trial_id": "default", "date": "2024-08-30_11-58-16", "timestamp": 1724990296, "time_this_iter_s": 22.341727256774902, "time_total_s": 832.7427639961243, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 832.7427639961243, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 9.710344827586209, "ram_util_percent": 9.931034482758623, "gpu_util_percent0": 0.12793103448275864, "vram_util_percent0": 0.17994567169540232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.110722725493934, "policy_loss": -0.010767302796324735, "vf_loss": 8.116191907723744, "vf_explained_var": 0.00012536516753576136, "kl": 0.01177357510434901, "entropy": 4.6070862754698725, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -185.4196985121979, "episode_len_mean": 345.26, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925], "episode_lengths": [379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095882837323315, "mean_inference_ms": 0.8637324883053009, "mean_action_processing_ms": 0.1452079861891674, "mean_env_wait_ms": 1.5249733005883968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017607450485229492, "StateBufferConnector_ms": 0.0044841766357421875, "ViewRequirementAgentConnector_ms": 0.08635306358337402}}, "episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -185.4196985121979, "episode_len_mean": 345.26, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-246.43728685772288, -190.02860574652772, -177.2570958483318, -261.4566650941004, -173.2374747931342, -246.05113566577586, -206.8746865895269, -218.9059037367424, -258.63831719035767, -218.0004080892204, -150.25027781137425, -189.9839707594087, -186.97274393705632, -170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925], "episode_lengths": [379, 399, 399, 226, 399, 399, 100, 399, 333, 399, 399, 399, 376, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095882837323315, "mean_inference_ms": 0.8637324883053009, "mean_action_processing_ms": 0.1452079861891674, "mean_env_wait_ms": 1.5249733005883968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017607450485229492, "StateBufferConnector_ms": 0.0044841766357421875, "ViewRequirementAgentConnector_ms": 0.08635306358337402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.2533277995025, "num_env_steps_trained_throughput_per_sec": 182.2533277995025, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 21967.048, "sample_time_ms": 11441.167, "load_time_ms": 13.186, "load_throughput": 303362.421, "learn_time_ms": 10506.412, "learn_throughput": 380.72, "synch_weights_time_ms": 5.309}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 493, "training_iteration": 39, "trial_id": "default", "date": "2024-08-30_11-58-38", "timestamp": 1724990318, "time_this_iter_s": 21.9545681476593, "time_total_s": 854.6973321437836, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 854.6973321437836, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 9.982758620689655, "ram_util_percent": 10.044827586206896, "gpu_util_percent0": 0.17758620689655172, "vram_util_percent0": 0.18153118265086204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.022745685423574, "policy_loss": -0.010427536726278323, "vf_loss": 9.028736965630644, "vf_explained_var": 9.361454235610141e-05, "kl": 0.0098584054183768, "entropy": 4.535339329063252, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -181.2501587806558, "episode_len_mean": 339.8, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24097513896913247, "mean_inference_ms": 0.8645712047160592, "mean_action_processing_ms": 0.145276008347697, "mean_env_wait_ms": 1.5251539011185549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017429113388061523, "StateBufferConnector_ms": 0.0044596195220947266, "ViewRequirementAgentConnector_ms": 0.08629870414733887}}, "episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -181.2501587806558, "episode_len_mean": 339.8, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-170.82771427142006, -129.95369364383532, -137.80288278322797, -247.6851569299246, -238.49938245518834, -141.14027428538725, -167.7638328911045, -146.59884293947636, -145.7388734117347, -219.71563905705784, -166.22204601355304, -122.96616557699807, -219.9712542154459, -140.6205322850296, -263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 185, 399, 296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24097513896913247, "mean_inference_ms": 0.8645712047160592, "mean_action_processing_ms": 0.145276008347697, "mean_env_wait_ms": 1.5251539011185549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017429113388061523, "StateBufferConnector_ms": 0.0044596195220947266, "ViewRequirementAgentConnector_ms": 0.08629870414733887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.8582061459909, "num_env_steps_trained_throughput_per_sec": 180.8582061459909, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 21941.553, "sample_time_ms": 11440.9, "load_time_ms": 13.155, "load_throughput": 304067.276, "learn_time_ms": 10481.223, "learn_throughput": 381.635, "synch_weights_time_ms": 5.302}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 506, "training_iteration": 40, "trial_id": "default", "date": "2024-08-30_11-59-01", "timestamp": 1724990341, "time_this_iter_s": 22.123347997665405, "time_total_s": 876.820680141449, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 876.820680141449, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 11.814285714285713, "ram_util_percent": 9.674999999999999, "gpu_util_percent0": 0.15214285714285716, "vram_util_percent0": 0.17866734095982142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.292102853104632, "policy_loss": -0.00888475926232434, "vf_loss": 8.294338303580078, "vf_explained_var": -3.32458685803157e-05, "kl": 0.014776236987832422, "entropy": 4.42982924010164, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -181.7709742072854, "episode_len_mean": 325.08, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833], "episode_lengths": [296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096294677634375, "mean_inference_ms": 0.8652803316040598, "mean_action_processing_ms": 0.1453097102950149, "mean_env_wait_ms": 1.5250536424491485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017477035522460938, "StateBufferConnector_ms": 0.0044591426849365234, "ViewRequirementAgentConnector_ms": 0.08581423759460449}}, "episode_reward_max": -20.55639869842201, "episode_reward_min": -272.47366627295105, "episode_reward_mean": -181.7709742072854, "episode_len_mean": 325.08, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-263.483113724739, -188.8940837437149, -166.52867510174528, -228.02293241430135, -138.63782484317773, -190.91514239057727, -120.33054199655429, -171.3515432181976, -115.11863039617913, -272.47366627295105, -145.09809543992682, -202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833], "episode_lengths": [296, 62, 399, 399, 399, 63, 399, 357, 399, 270, 399, 77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096294677634375, "mean_inference_ms": 0.8652803316040598, "mean_action_processing_ms": 0.1453097102950149, "mean_env_wait_ms": 1.5250536424491485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017477035522460938, "StateBufferConnector_ms": 0.0044591426849365234, "ViewRequirementAgentConnector_ms": 0.08581423759460449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.55471753584646, "num_env_steps_trained_throughput_per_sec": 181.55471753584646, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 22041.149, "sample_time_ms": 11435.465, "load_time_ms": 13.262, "load_throughput": 301604.739, "learn_time_ms": 10586.091, "learn_throughput": 377.854, "synch_weights_time_ms": 5.348}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 520, "training_iteration": 41, "trial_id": "default", "date": "2024-08-30_11-59-23", "timestamp": 1724990363, "time_this_iter_s": 22.039461374282837, "time_total_s": 898.8601415157318, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 898.8601415157318, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.379310344827587, "ram_util_percent": 9.562068965517241, "gpu_util_percent0": 0.11344827586206897, "vram_util_percent0": 0.17742007902298848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.454747667716395, "policy_loss": -0.013550242705531018, "vf_loss": 8.462894604114755, "vf_explained_var": -0.0031568494535261587, "kl": 0.01200724708051642, "entropy": 4.679019238615549, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -20.55639869842201, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -180.99875663257012, "episode_len_mean": 331.4, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144], "episode_lengths": [77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24093872714959974, "mean_inference_ms": 0.8655034639242899, "mean_action_processing_ms": 0.1453293802884621, "mean_env_wait_ms": 1.5250228322356358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724100112915039, "StateBufferConnector_ms": 0.00444483757019043, "ViewRequirementAgentConnector_ms": 0.08562994003295898}}, "episode_reward_max": -20.55639869842201, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -180.99875663257012, "episode_len_mean": 331.4, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-202.54751711804784, -194.7653845580615, -172.30571609832666, -20.55639869842201, -189.66289657954798, -174.04175872983018, -188.25738976343544, -193.1930157891762, -187.25221510658244, -185.88880332541845, -74.56830007491394, -173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144], "episode_lengths": [77, 191, 399, 78, 59, 399, 399, 399, 399, 34, 272, 399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24093872714959974, "mean_inference_ms": 0.8655034639242899, "mean_action_processing_ms": 0.1453293802884621, "mean_env_wait_ms": 1.5250228322356358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724100112915039, "StateBufferConnector_ms": 0.00444483757019043, "ViewRequirementAgentConnector_ms": 0.08562994003295898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.77840124199275, "num_env_steps_trained_throughput_per_sec": 251.77840124199275, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 21418.6, "sample_time_ms": 11364.993, "load_time_ms": 13.175, "load_throughput": 303604.518, "learn_time_ms": 10034.151, "learn_throughput": 398.639, "synch_weights_time_ms": 5.317}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 531, "training_iteration": 42, "trial_id": "default", "date": "2024-08-30_11-59-39", "timestamp": 1724990379, "time_this_iter_s": 15.893983840942383, "time_total_s": 914.7541253566742, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 914.7541253566742, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 6.876190476190477, "ram_util_percent": 9.5, "gpu_util_percent0": 0.14952380952380953, "vram_util_percent0": 0.17880006820436506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.455976021161643, "policy_loss": -0.013755918031818764, "vf_loss": 9.464516648938579, "vf_explained_var": 0.0015122424530726608, "kl": 0.01158951580850336, "entropy": 4.129025777180989, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -27.72887458904139, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -179.97615693927165, "episode_len_mean": 343.47, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438], "episode_lengths": [399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095223711200064, "mean_inference_ms": 0.8659288179320666, "mean_action_processing_ms": 0.1453680620684112, "mean_env_wait_ms": 1.5251851974893509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01740407943725586, "StateBufferConnector_ms": 0.0045125484466552734, "ViewRequirementAgentConnector_ms": 0.08652830123901367}}, "episode_reward_max": -27.72887458904139, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -179.97615693927165, "episode_len_mean": 343.47, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-173.46334778752666, -192.63962544553743, -213.99399510519572, -144.57899466140708, -240.0125711984822, -186.67446406360602, -240.97917385053347, -115.50803878759358, -266.03683325916734, -214.12023867758268, -195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438], "episode_lengths": [399, 64, 204, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095223711200064, "mean_inference_ms": 0.8659288179320666, "mean_action_processing_ms": 0.1453680620684112, "mean_env_wait_ms": 1.5251851974893509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01740407943725586, "StateBufferConnector_ms": 0.0045125484466552734, "ViewRequirementAgentConnector_ms": 0.08652830123901367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.59876916512204, "num_env_steps_trained_throughput_per_sec": 178.59876916512204, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 21421.903, "sample_time_ms": 11402.198, "load_time_ms": 13.172, "load_throughput": 303670.461, "learn_time_ms": 10000.284, "learn_throughput": 399.989, "synch_weights_time_ms": 5.285}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 542, "training_iteration": 43, "trial_id": "default", "date": "2024-08-30_12-00-01", "timestamp": 1724990401, "time_this_iter_s": 22.403486013412476, "time_total_s": 937.1576113700867, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 937.1576113700867, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 13.306896551724138, "ram_util_percent": 9.527586206896553, "gpu_util_percent0": 0.16655172413793104, "vram_util_percent0": 0.1792932269216954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.532136114694739, "policy_loss": -0.01339670808244777, "vf_loss": 9.541090343844505, "vf_explained_var": -0.0016102238367962582, "kl": 0.009872218268821441, "entropy": 4.162875648724135, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -27.72887458904139, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -177.7593084378451, "episode_len_mean": 347.04, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782], "episode_lengths": [399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096931843745445, "mean_inference_ms": 0.8663353560132123, "mean_action_processing_ms": 0.1453899785453171, "mean_env_wait_ms": 1.5253273583016544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017472028732299805, "StateBufferConnector_ms": 0.004525184631347656, "ViewRequirementAgentConnector_ms": 0.0867776870727539}}, "episode_reward_max": -27.72887458904139, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -177.7593084378451, "episode_len_mean": 347.04, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-195.4456210007387, -242.97575666628254, -119.07495213278891, -144.3613455056813, -232.22314975174152, -116.52803570636885, -201.3165481946002, -221.18520912442676, -205.5337607123917, -186.49502391761746, -239.85032428199403, -203.6945291690143, -208.41261036127543, -164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782], "episode_lengths": [399, 399, 399, 331, 399, 399, 399, 399, 399, 399, 399, 399, 89, 399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096931843745445, "mean_inference_ms": 0.8663353560132123, "mean_action_processing_ms": 0.1453899785453171, "mean_env_wait_ms": 1.5253273583016544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017472028732299805, "StateBufferConnector_ms": 0.004525184631347656, "ViewRequirementAgentConnector_ms": 0.0867776870727539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.94702796048728, "num_env_steps_trained_throughput_per_sec": 176.94702796048728, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 21444.693, "sample_time_ms": 11402.794, "load_time_ms": 17.79, "load_throughput": 224847.131, "learn_time_ms": 10017.85, "learn_throughput": 399.287, "synch_weights_time_ms": 5.291}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 552, "training_iteration": 44, "trial_id": "default", "date": "2024-08-30_12-00-24", "timestamp": 1724990424, "time_this_iter_s": 22.61282753944397, "time_total_s": 959.7704389095306, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 959.7704389095306, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 9.10689655172414, "ram_util_percent": 9.6, "gpu_util_percent0": 0.1327586206896552, "vram_util_percent0": 0.178534146012931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.26818150961271, "policy_loss": -0.00805746556049393, "vf_loss": 9.2712532357503, "vf_explained_var": -4.20407582354802e-05, "kl": 0.011079420994528098, "entropy": 4.013141583114542, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -11.461185578727555, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -172.45684005580608, "episode_len_mean": 342.08, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406], "episode_lengths": [399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096775918849694, "mean_inference_ms": 0.8665091415907152, "mean_action_processing_ms": 0.1453817766822482, "mean_env_wait_ms": 1.5252739440909249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017607688903808594, "StateBufferConnector_ms": 0.004506587982177734, "ViewRequirementAgentConnector_ms": 0.08656597137451172}}, "episode_reward_max": -11.461185578727555, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -172.45684005580608, "episode_len_mean": 342.08, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-164.13824985893345, -202.90680770094107, -136.71578895192206, -207.2829716885363, -196.80038565844626, -198.89754571353356, -146.49080222727505, -160.61515803565834, -118.46347213930814, -180.7132347232538, -146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406], "episode_lengths": [399, 399, 399, 399, 330, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096775918849694, "mean_inference_ms": 0.8665091415907152, "mean_action_processing_ms": 0.1453817766822482, "mean_env_wait_ms": 1.5252739440909249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017607688903808594, "StateBufferConnector_ms": 0.004506587982177734, "ViewRequirementAgentConnector_ms": 0.08656597137451172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.87779515854888, "num_env_steps_trained_throughput_per_sec": 187.87779515854888, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 21452.286, "sample_time_ms": 11374.692, "load_time_ms": 13.926, "load_throughput": 287232.896, "learn_time_ms": 10060.635, "learn_throughput": 397.589, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 565, "training_iteration": 45, "trial_id": "default", "date": "2024-08-30_12-00-45", "timestamp": 1724990445, "time_this_iter_s": 21.295193433761597, "time_total_s": 981.0656323432922, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 981.0656323432922, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 7.92962962962963, "ram_util_percent": 9.511111111111111, "gpu_util_percent0": 0.10962962962962963, "vram_util_percent0": 0.1779619381751543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.339645005041554, "policy_loss": -0.014827427900927042, "vf_loss": 8.348974703845158, "vf_explained_var": 0.0010673886986188991, "kl": 0.012217186037914187, "entropy": 4.204823906703662, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -11.461185578727555, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -173.3518372498143, "episode_len_mean": 341.03, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096523095371494, "mean_inference_ms": 0.8665393569630191, "mean_action_processing_ms": 0.14538010740645077, "mean_env_wait_ms": 1.5253189288186961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01760101318359375, "StateBufferConnector_ms": 0.004503726959228516, "ViewRequirementAgentConnector_ms": 0.0866231918334961}}, "episode_reward_max": -11.461185578727555, "episode_reward_min": -268.5399336724719, "episode_reward_mean": -173.3518372498143, "episode_len_mean": 341.03, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-146.2358353694397, -177.04120132472326, -240.6610074623199, -128.16236232341618, -268.5399336724719, -225.25679106778932, -172.56515072130605, -205.47623748769058, -165.20434477964196, -185.14416123131926, -188.5921194895195, -143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376], "episode_lengths": [399, 399, 399, 399, 399, 399, 399, 114, 399, 399, 53, 399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096523095371494, "mean_inference_ms": 0.8665393569630191, "mean_action_processing_ms": 0.14538010740645077, "mean_env_wait_ms": 1.5253189288186961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01760101318359375, "StateBufferConnector_ms": 0.004503726959228516, "ViewRequirementAgentConnector_ms": 0.0866231918334961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.08721146412378, "num_env_steps_trained_throughput_per_sec": 211.08721146412378, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 21199.504, "sample_time_ms": 11374.43, "load_time_ms": 14.801, "load_throughput": 270259.383, "learn_time_ms": 9807.233, "learn_throughput": 407.862, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 575, "training_iteration": 46, "trial_id": "default", "date": "2024-08-30_12-01-04", "timestamp": 1724990464, "time_this_iter_s": 18.956918001174927, "time_total_s": 1000.0225503444672, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1000.0225503444672, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 8.904, "ram_util_percent": 9.576, "gpu_util_percent0": 0.1628, "vram_util_percent0": 0.1708349609375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.285239320032058, "policy_loss": -0.01653579988326597, "vf_loss": 9.294795613135062, "vf_explained_var": 4.29993034690939e-06, "kl": 0.015510011089943775, "entropy": 3.8946646931350872, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -11.461185578727555, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -172.00013446551282, "episode_len_mean": 344.05, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212], "episode_lengths": [399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095811503012016, "mean_inference_ms": 0.8666293804460795, "mean_action_processing_ms": 0.14538041352943082, "mean_env_wait_ms": 1.525381361544865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01756739616394043, "StateBufferConnector_ms": 0.004508495330810547, "ViewRequirementAgentConnector_ms": 0.08637404441833496}}, "episode_reward_max": -11.461185578727555, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -172.00013446551282, "episode_len_mean": 344.05, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-143.530011498719, -185.83202257464382, -253.55933451234517, -232.42506628664418, -180.39053915766033, -204.7763260091702, -116.95433192911925, -159.1530784891822, -113.58087875000331, -182.187289977041, -219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212], "episode_lengths": [399, 399, 399, 399, 58, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24095811503012016, "mean_inference_ms": 0.8666293804460795, "mean_action_processing_ms": 0.14538041352943082, "mean_env_wait_ms": 1.525381361544865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01756739616394043, "StateBufferConnector_ms": 0.004508495330810547, "ViewRequirementAgentConnector_ms": 0.08637404441833496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.51863008236646, "num_env_steps_trained_throughput_per_sec": 196.51863008236646, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 20991.38, "sample_time_ms": 11384.27, "load_time_ms": 14.749, "load_throughput": 271208.29, "learn_time_ms": 9589.292, "learn_throughput": 417.132, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 586, "training_iteration": 47, "trial_id": "default", "date": "2024-08-30_12-01-24", "timestamp": 1724990484, "time_this_iter_s": 20.36170268058777, "time_total_s": 1020.3842530250549, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1020.3842530250549, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.765384615384615, "ram_util_percent": 9.599999999999998, "gpu_util_percent0": 0.12692307692307692, "vram_util_percent0": 0.1304336939102564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.976547533209606, "policy_loss": -0.019917477487075713, "vf_loss": 8.989915139700777, "vf_explained_var": -0.006053194307511852, "kl": 0.01455528046216176, "entropy": 3.607314798908849, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -11.461185578727555, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -169.09506082655142, "episode_len_mean": 347.46, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695], "episode_lengths": [399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2409284204280511, "mean_inference_ms": 0.866649032413949, "mean_action_processing_ms": 0.145370142493272, "mean_env_wait_ms": 1.5253389321891462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017562389373779297, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.0864877700805664}}, "episode_reward_max": -11.461185578727555, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -169.09506082655142, "episode_len_mean": 347.46, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-219.7773162621524, -227.3389176135488, -142.334444018905, -192.7082208690018, -168.07118672864073, -218.70552908385113, -194.95961223423836, -185.92241434900683, -98.02366027321555, -204.37805031628423, -131.41071653125218, -175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695], "episode_lengths": [399, 399, 399, 66, 399, 399, 63, 61, 279, 399, 399, 399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2409284204280511, "mean_inference_ms": 0.866649032413949, "mean_action_processing_ms": 0.145370142493272, "mean_env_wait_ms": 1.5253389321891462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017562389373779297, "StateBufferConnector_ms": 0.0045108795166015625, "ViewRequirementAgentConnector_ms": 0.0864877700805664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.5761810499391, "num_env_steps_trained_throughput_per_sec": 189.5761810499391, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 20867.89, "sample_time_ms": 11303.509, "load_time_ms": 14.515, "load_throughput": 275578.449, "learn_time_ms": 9546.817, "learn_throughput": 418.988, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 596, "training_iteration": 48, "trial_id": "default", "date": "2024-08-30_12-01-46", "timestamp": 1724990506, "time_this_iter_s": 21.107032775878906, "time_total_s": 1041.4912858009338, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1041.4912858009338, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 9.789285714285713, "ram_util_percent": 9.560714285714285, "gpu_util_percent0": 0.10785714285714287, "vram_util_percent0": 0.06887526739211311}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.745423013068015, "policy_loss": -0.016873861801239752, "vf_loss": 8.756666234424037, "vf_explained_var": -0.051876423243553405, "kl": 0.012512576942563589, "entropy": 3.979346337882421, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -10.170065545527251, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -166.580139547441, "episode_len_mean": 355.14, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695, -183.25128302450233, -152.5490286334549, -231.47846188147736, -231.51299744161906, -230.98960481286593, -147.1951885698481, -140.99872600529267, -134.82629174989884, -146.93140976308737, -122.23488294148221, -10.170065545527251], "episode_lengths": [399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408860016317403, "mean_inference_ms": 0.8666147850451688, "mean_action_processing_ms": 0.14535156904033486, "mean_env_wait_ms": 1.5252656407952523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017459869384765625, "StateBufferConnector_ms": 0.004494905471801758, "ViewRequirementAgentConnector_ms": 0.08625531196594238}}, "episode_reward_max": -10.170065545527251, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -166.580139547441, "episode_len_mean": 355.14, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-175.31643857459014, -121.5486722396087, -182.18112190424955, -158.0029487903716, -139.2531457319424, -187.81193120784667, -204.30849413860366, -191.30116526362787, -196.46419296378863, -176.49600575000622, -179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695, -183.25128302450233, -152.5490286334549, -231.47846188147736, -231.51299744161906, -230.98960481286593, -147.1951885698481, -140.99872600529267, -134.82629174989884, -146.93140976308737, -122.23488294148221, -10.170065545527251], "episode_lengths": [399, 399, 36, 399, 399, 51, 399, 399, 72, 81, 99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408860016317403, "mean_inference_ms": 0.8666147850451688, "mean_action_processing_ms": 0.14535156904033486, "mean_env_wait_ms": 1.5252656407952523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017459869384765625, "StateBufferConnector_ms": 0.004494905471801758, "ViewRequirementAgentConnector_ms": 0.08625531196594238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.80490031206605, "num_env_steps_trained_throughput_per_sec": 181.80490031206605, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 20873.304, "sample_time_ms": 11309.865, "load_time_ms": 14.55, "load_throughput": 274909.689, "learn_time_ms": 9545.808, "learn_throughput": 419.032, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 607, "training_iteration": 49, "trial_id": "default", "date": "2024-08-30_12-02-08", "timestamp": 1724990528, "time_this_iter_s": 22.008952379226685, "time_total_s": 1063.5002381801605, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1063.5002381801605, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 8.682142857142859, "ram_util_percent": 9.64642857142857, "gpu_util_percent0": 0.08714285714285715, "vram_util_percent0": 0.06891450427827382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.097906237776561, "policy_loss": -0.01410134488776807, "vf_loss": 8.105925637932234, "vf_explained_var": -0.0031840075728713827, "kl": 0.013515401809160046, "entropy": 3.6968666143314812, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -10.170065545527251, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -167.2018904510725, "episode_len_mean": 368.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695, -183.25128302450233, -152.5490286334549, -231.47846188147736, -231.51299744161906, -230.98960481286593, -147.1951885698481, -140.99872600529267, -134.82629174989884, -146.93140976308737, -122.23488294148221, -10.170065545527251, -243.07393711637272, -152.8834393893555, -187.25620245004583, -138.6516685508056, -165.1535988470703, -136.14654854167642, -226.15508839225348, -161.52584336667215, -225.12871683735244, -158.88416343618127], "episode_lengths": [99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 40, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083584191429167, "mean_inference_ms": 0.866544982333844, "mean_action_processing_ms": 0.14533090245794245, "mean_env_wait_ms": 1.5251912358865853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01735401153564453, "StateBufferConnector_ms": 0.004490852355957031, "ViewRequirementAgentConnector_ms": 0.08628511428833008}}, "episode_reward_max": -10.170065545527251, "episode_reward_min": -262.9730866484986, "episode_reward_mean": -167.2018904510725, "episode_len_mean": 368.7, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.69999309519554, -193.0311342962149, -210.76187293503833, -95.78972860799482, -192.37915353344883, -135.53293546885047, -214.5353476560337, -195.5310077202848, -229.94544554445284, -178.01209888280022, -112.9157484498675, -237.58951109903632, -136.15276932627572, -195.24874578149144, -132.4017099868561, -202.8823683888225, -27.72887458904139, -220.7157103009675, -165.57773424302528, -171.2724870772069, -103.05489448606848, -177.69518856090608, -161.0974116794066, -173.13638500077587, -145.21666219884438, -206.5524059100696, -250.22049774139523, -170.25546204384236, -246.9722144395734, -148.94111768895917, -155.54180050611149, -131.20409441330847, -147.26995600099616, -105.40241354233758, -203.9624704073782, -209.31791401503855, -157.08041200220623, -134.71500815032638, -11.461185578727555, -132.332951230625, -187.4034331264085, -17.972052655748104, -199.45598786315207, -165.80273537189402, -256.0451292817066, -146.12171595031148, -197.65803041440017, -171.48347268048406, -123.7909168382647, -224.74827940805173, -77.59037872601637, -228.6225517307042, -198.9140339414728, -122.13841479615603, -252.30673889954696, -188.69670114553134, -199.19700490514333, -186.5191157077376, -134.97773523617394, -262.9730866484986, -165.8914063998782, -145.00576687659915, -181.6506580681623, -225.21871045705132, -145.06752850459526, -174.50030718309623, -173.51434538716677, -187.14220423217353, -171.76711750609212, -133.4067308835255, -142.76296459632687, -128.23267631794803, -201.98095067038292, -162.93120051821046, -134.75326102356775, -137.79308852248678, -146.79043863379718, -118.86429999074726, -174.36590413139695, -183.25128302450233, -152.5490286334549, -231.47846188147736, -231.51299744161906, -230.98960481286593, -147.1951885698481, -140.99872600529267, -134.82629174989884, -146.93140976308737, -122.23488294148221, -10.170065545527251, -243.07393711637272, -152.8834393893555, -187.25620245004583, -138.6516685508056, -165.1535988470703, -136.14654854167642, -226.15508839225348, -161.52584336667215, -225.12871683735244, -158.88416343618127], "episode_lengths": [99, 399, 369, 360, 399, 399, 123, 399, 399, 399, 399, 399, 399, 399, 399, 399, 132, 283, 306, 399, 399, 399, 399, 399, 399, 399, 226, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 66, 399, 399, 84, 173, 399, 399, 399, 399, 399, 399, 399, 225, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 70, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 40, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083584191429167, "mean_inference_ms": 0.866544982333844, "mean_action_processing_ms": 0.14533090245794245, "mean_env_wait_ms": 1.5251912358865853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01735401153564453, "StateBufferConnector_ms": 0.004490852355957031, "ViewRequirementAgentConnector_ms": 0.08628511428833008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.982735954683, "num_env_steps_trained_throughput_per_sec": 179.982735954683, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 20884.062, "sample_time_ms": 11263.11, "load_time_ms": 14.544, "load_throughput": 275023.253, "learn_time_ms": 9603.311, "learn_throughput": 416.523, "synch_weights_time_ms": 2.192}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 617, "training_iteration": 50, "trial_id": "default", "date": "2024-08-30_12-02-30", "timestamp": 1724990550, "time_this_iter_s": 22.23135733604431, "time_total_s": 1085.7315955162048, "pid": 16315, "hostname": "ucav", "node_ip": "192.168.42.148", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlyCraft-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f63a52973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1085.7315955162048, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 11.303448275862067, "ram_util_percent": 9.748275862068965, "gpu_util_percent0": 0.13793103448275862, "vram_util_percent0": 0.09517976607399427}}
