{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.719238401228381, "policy_loss": -0.0036677538547464595, "vf_loss": 8.721335524897421, "vf_explained_var": 0.009939584744873867, "kl": 0.007853254866444203, "entropy": 1.0907141508594635, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.06293953262553, "num_env_steps_trained_throughput_per_sec": 371.06293953262553, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10779.79, "sample_time_ms": 640.264, "load_time_ms": 1.311, "load_throughput": 3050402.909, "learn_time_ms": 10025.51, "learn_throughput": 398.982, "synch_weights_time_ms": 111.627}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "default", "date": "2024-08-30_16-35-39", "timestamp": 1725006939, "time_this_iter_s": 11.32429552078247, "time_total_s": 11.32429552078247, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 11.32429552078247, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 7.16, "ram_util_percent": 14.420000000000003, "gpu_util_percent0": 0.17666666666666667, "vram_util_percent0": 0.11491970486111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.518338315204907, "policy_loss": -0.0025031628067134527, "vf_loss": 8.520114148047663, "vf_explained_var": 0.00769123960566777, "kl": 0.00363643466992872, "entropy": 1.0872151620926396, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.80647789620485, "num_env_steps_trained_throughput_per_sec": 394.80647789620485, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10455.638, "sample_time_ms": 444.22, "load_time_ms": 1.292, "load_throughput": 3096284.211, "learn_time_ms": 9897.514, "learn_throughput": 404.142, "synch_weights_time_ms": 111.665}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "default", "date": "2024-08-30_16-35-50", "timestamp": 1725006950, "time_this_iter_s": 10.681857824325562, "time_total_s": 22.006153345108032, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 22.006153345108032, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.921428571428573, "ram_util_percent": 14.421428571428573, "gpu_util_percent0": 0.2278571428571429, "vram_util_percent0": 0.11506870814732144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.45634369491249, "policy_loss": -0.005823429625841879, "vf_loss": 8.461220981228736, "vf_explained_var": 0.028927804641826177, "kl": 0.009461462696063174, "entropy": 1.0826096264264917, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.76055749819517, "num_env_steps_trained_throughput_per_sec": 391.76055749819517, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10373.85, "sample_time_ms": 371.927, "load_time_ms": 1.506, "load_throughput": 2656163.808, "learn_time_ms": 9892.809, "learn_throughput": 404.334, "synch_weights_time_ms": 106.747}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "default", "date": "2024-08-30_16-36-00", "timestamp": 1725006960, "time_this_iter_s": 10.760748147964478, "time_total_s": 32.76690149307251, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 32.76690149307251, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.692857142857145, "ram_util_percent": 14.464285714285714, "gpu_util_percent0": 0.25428571428571434, "vram_util_percent0": 0.11502220517113095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.239529108744795, "policy_loss": -0.0034354756355926557, "vf_loss": 8.241971171286798, "vf_explained_var": -0.019328587350024972, "kl": 0.00993398858928397, "entropy": 1.0717732670486615, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.8375626130145, "num_env_steps_trained_throughput_per_sec": 425.8375626130145, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10128.687, "sample_time_ms": 335.556, "load_time_ms": 1.454, "load_throughput": 2751603.756, "learn_time_ms": 9689.025, "learn_throughput": 412.838, "synch_weights_time_ms": 101.812}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "default", "date": "2024-08-30_16-36-10", "timestamp": 1725006970, "time_this_iter_s": 9.96886920928955, "time_total_s": 42.73577070236206, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 42.73577070236206, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.576923076923075, "ram_util_percent": 14.499999999999998, "gpu_util_percent0": 0.2130769230769231, "vram_util_percent0": 0.12845239883814102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.31086918564253, "policy_loss": -0.008412575561513183, "vf_loss": 8.318072155470489, "vf_explained_var": -0.032853871968484695, "kl": 0.012096535436660727, "entropy": 1.0590145672521283, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.1350063213289, "num_env_steps_trained_throughput_per_sec": 390.1350063213289, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10153.512, "sample_time_ms": 316.217, "load_time_ms": 1.433, "load_throughput": 2792200.513, "learn_time_ms": 9732.107, "learn_throughput": 411.011, "synch_weights_time_ms": 102.933}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "default", "date": "2024-08-30_16-36-21", "timestamp": 1725006981, "time_this_iter_s": 10.812757015228271, "time_total_s": 53.54852771759033, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 53.54852771759033, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 7.014285714285714, "ram_util_percent": 14.5, "gpu_util_percent0": 0.14714285714285716, "vram_util_percent0": 0.13992745535714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.363792670670376, "policy_loss": -0.0096092627493925, "vf_loss": 8.372158325872114, "vf_explained_var": -0.05870826141808622, "kl": 0.012436346058709977, "entropy": 1.0688282712813346, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.5667071842907, "num_env_steps_trained_throughput_per_sec": 384.5667071842907, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10194.775, "sample_time_ms": 299.75, "load_time_ms": 1.413, "load_throughput": 2831597.637, "learn_time_ms": 9781.038, "learn_throughput": 408.955, "synch_weights_time_ms": 111.654}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "default", "date": "2024-08-30_16-36-32", "timestamp": 1725006992, "time_this_iter_s": 10.902631044387817, "time_total_s": 64.45115876197815, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 64.45115876197815, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.971428571428572, "ram_util_percent": 14.5, "gpu_util_percent0": 0.21500000000000005, "vram_util_percent0": 0.14488583519345238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.18426480549638, "policy_loss": -0.005584712959425424, "vf_loss": 8.188658405119373, "vf_explained_var": 0.05020945341356339, "kl": 0.011911244908415322, "entropy": 1.0441555896112995, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.21079817907713, "num_env_steps_trained_throughput_per_sec": 388.21079817907713, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10210.321, "sample_time_ms": 293.92, "load_time_ms": 1.435, "load_throughput": 2788368.678, "learn_time_ms": 9798.319, "learn_throughput": 408.233, "synch_weights_time_ms": 115.699}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "default", "date": "2024-08-30_16-36-43", "timestamp": 1725007003, "time_this_iter_s": 10.818682432174683, "time_total_s": 75.26984119415283, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 75.26984119415283, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.257142857142856, "ram_util_percent": 14.5, "gpu_util_percent0": 0.24000000000000002, "vram_util_percent0": 0.14710925874255953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.382110891547255, "policy_loss": -0.01043182500107314, "vf_loss": 8.391656061398086, "vf_explained_var": 0.14725915661422156, "kl": 0.008866799509926368, "entropy": 1.018779695098118, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.8048825259111, "num_env_steps_trained_throughput_per_sec": 382.8048825259111, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10240.171, "sample_time_ms": 288.738, "load_time_ms": 1.453, "load_throughput": 2752619.524, "learn_time_ms": 9828.917, "learn_throughput": 406.962, "synch_weights_time_ms": 120.129}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "default", "date": "2024-08-30_16-36-54", "timestamp": 1725007014, "time_this_iter_s": 10.980787992477417, "time_total_s": 86.25062918663025, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 86.25062918663025, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 8.042857142857143, "ram_util_percent": 14.5, "gpu_util_percent0": 0.20785714285714288, "vram_util_percent0": 0.14646984281994047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.084831022959884, "policy_loss": -0.007379034277732654, "vf_loss": 8.091141400285947, "vf_explained_var": 0.11807504059166037, "kl": 0.010686209551258994, "entropy": 0.9724384425788797, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.30527329957584, "num_env_steps_trained_throughput_per_sec": 386.30527329957584, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10252.866, "sample_time_ms": 281.852, "load_time_ms": 1.469, "load_throughput": 2723426.654, "learn_time_ms": 9850.571, "learn_throughput": 406.068, "synch_weights_time_ms": 118.044}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "default", "date": "2024-08-30_16-37-05", "timestamp": 1725007025, "time_this_iter_s": 10.96048092842102, "time_total_s": 97.21111011505127, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 97.21111011505127, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.22, "ram_util_percent": 14.5, "gpu_util_percent0": 0.20933333333333332, "vram_util_percent0": 0.14502766927083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.482138198421847, "policy_loss": -0.007765977351014973, "vf_loss": 8.489207716398342, "vf_explained_var": -0.14618869853276079, "kl": 0.006964432422894113, "entropy": 0.9619887243035019, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.62006183847427, "num_env_steps_trained_throughput_per_sec": 383.62006183847427, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10270.27, "sample_time_ms": 275.636, "load_time_ms": 1.457, "load_throughput": 2745771.988, "learn_time_ms": 9874.171, "learn_throughput": 405.097, "synch_weights_time_ms": 118.078}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "default", "date": "2024-08-30_16-37-16", "timestamp": 1725007036, "time_this_iter_s": 10.967408180236816, "time_total_s": 108.17851829528809, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 108.17851829528809, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 9.900000000000002, "ram_util_percent": 14.5, "gpu_util_percent0": 0.2821428571428572, "vram_util_percent0": 0.145751953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.744903563427668, "policy_loss": -0.010901178061080876, "vf_loss": 8.754126549792547, "vf_explained_var": -0.2671364759886137, "kl": 0.016781457089765812, "entropy": 0.8926369921494556, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -323.0, "episode_reward_min": -349.0, "episode_reward_mean": -333.3333333333333, "episode_len_mean": 334.3333333333333, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0], "episode_lengths": [350, 338, 324, 333, 330, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6589129855066401, "mean_inference_ms": 2.4382244223444096, "mean_action_processing_ms": 0.2640775977794686, "mean_env_wait_ms": 0.3890259487388305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012580553690592447, "StateBufferConnector_ms": 0.009322166442871094, "ViewRequirementAgentConnector_ms": 0.22139549255371094}}, "episode_reward_max": -323.0, "episode_reward_min": -349.0, "episode_reward_mean": -333.3333333333333, "episode_len_mean": 334.3333333333333, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0], "episode_lengths": [350, 338, 324, 333, 330, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6589129855066401, "mean_inference_ms": 2.4382244223444096, "mean_action_processing_ms": 0.2640775977794686, "mean_env_wait_ms": 0.3890259487388305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012580553690592447, "StateBufferConnector_ms": 0.009322166442871094, "ViewRequirementAgentConnector_ms": 0.22139549255371094}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.9061959635828, "num_env_steps_trained_throughput_per_sec": 389.9061959635828, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10218.172, "sample_time_ms": 234.359, "load_time_ms": 1.545, "load_throughput": 2589356.258, "learn_time_ms": 9863.938, "learn_throughput": 405.518, "synch_weights_time_ms": 117.426}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 6, "training_iteration": 11, "trial_id": "default", "date": "2024-08-30_16-37-27", "timestamp": 1725007047, "time_this_iter_s": 10.823023557662964, "time_total_s": 119.00154185295105, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 119.00154185295105, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 7.721428571428571, "ram_util_percent": 14.5, "gpu_util_percent0": 0.19499999999999998, "vram_util_percent0": 0.14418247767857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.008053597583565, "policy_loss": -0.012402158278611398, "vf_loss": 9.018970352603544, "vf_explained_var": -0.4897744990805144, "kl": 0.014854242473024554, "entropy": 0.8291839326581647, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -323.0, "episode_reward_min": -381.0, "episode_reward_mean": -353.8695652173913, "episode_len_mean": 354.8695652173913, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6524353987402076, "mean_inference_ms": 2.4469594292396373, "mean_action_processing_ms": 0.2662181430261546, "mean_env_wait_ms": 0.3950419921397361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013536992280379585, "StateBufferConnector_ms": 0.012637221294900646, "ViewRequirementAgentConnector_ms": 0.2411489901335343}}, "episode_reward_max": -323.0, "episode_reward_min": -381.0, "episode_reward_mean": -353.8695652173913, "episode_len_mean": 354.8695652173913, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6524353987402076, "mean_inference_ms": 2.4469594292396373, "mean_action_processing_ms": 0.2662181430261546, "mean_env_wait_ms": 0.3950419921397361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013536992280379585, "StateBufferConnector_ms": 0.012637221294900646, "ViewRequirementAgentConnector_ms": 0.2411489901335343}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.5589348274973, "num_env_steps_trained_throughput_per_sec": 423.5589348274973, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10149.396, "sample_time_ms": 232.179, "load_time_ms": 1.551, "load_throughput": 2579443.437, "learn_time_ms": 9799.002, "learn_throughput": 408.205, "synch_weights_time_ms": 115.763}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 23, "training_iteration": 12, "trial_id": "default", "date": "2024-08-30_16-37-37", "timestamp": 1725007057, "time_this_iter_s": 10.010435104370117, "time_total_s": 129.01197695732117, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 129.01197695732117, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.769230769230769, "ram_util_percent": 14.5, "gpu_util_percent0": 0.21769230769230774, "vram_util_percent0": 0.14311648637820512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.496588465475266, "policy_loss": -0.011472731855727973, "vf_loss": 8.506993834177653, "vf_explained_var": -0.4420914848004618, "kl": 0.010673644521395095, "entropy": 0.8373648251897545, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -323.0, "episode_reward_min": -415.0, "episode_reward_mean": -377.04761904761904, "episode_len_mean": 378.04761904761904, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6553437553309034, "mean_inference_ms": 2.428927753338342, "mean_action_processing_ms": 0.26454370307372344, "mean_env_wait_ms": 0.3914991075366638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015770821344284786, "StateBufferConnector_ms": 0.012039759802439856, "ViewRequirementAgentConnector_ms": 0.26038563440716456}}, "episode_reward_max": -323.0, "episode_reward_min": -415.0, "episode_reward_mean": -377.04761904761904, "episode_len_mean": 378.04761904761904, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6553437553309034, "mean_inference_ms": 2.428927753338342, "mean_action_processing_ms": 0.26454370307372344, "mean_env_wait_ms": 0.3914991075366638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015770821344284786, "StateBufferConnector_ms": 0.012039759802439856, "ViewRequirementAgentConnector_ms": 0.26038563440716456}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.4568415078277, "num_env_steps_trained_throughput_per_sec": 387.4568415078277, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10160.733, "sample_time_ms": 232.465, "load_time_ms": 1.493, "load_throughput": 2679210.476, "learn_time_ms": 9807.729, "learn_throughput": 407.842, "synch_weights_time_ms": 118.124}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 63, "training_iteration": 13, "trial_id": "default", "date": "2024-08-30_16-37-48", "timestamp": 1725007068, "time_this_iter_s": 10.874903917312622, "time_total_s": 139.8868808746338, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 139.8868808746338, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 7.885714285714286, "ram_util_percent": 14.5, "gpu_util_percent0": 0.21214285714285716, "vram_util_percent0": 0.14276994977678573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.182555827274117, "policy_loss": -0.028532370548414926, "vf_loss": 8.209961506628222, "vf_explained_var": -0.028466010606417094, "kl": 0.011267111531267273, "entropy": 0.8174208358410866, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -323.0, "episode_reward_min": -447.0, "episode_reward_mean": -389.989010989011, "episode_len_mean": 390.989010989011, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6565752826025919, "mean_inference_ms": 2.430075905906877, "mean_action_processing_ms": 0.26454511028504135, "mean_env_wait_ms": 0.3912521381533353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016750084174858345, "StateBufferConnector_ms": 0.011783379774827223, "ViewRequirementAgentConnector_ms": 0.26300294058663504}}, "episode_reward_max": -323.0, "episode_reward_min": -447.0, "episode_reward_mean": -389.989010989011, "episode_len_mean": 390.989010989011, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-349.0, -337.0, -323.0, -332.0, -329.0, -330.0, -381.0, -367.0, -367.0, -369.0, -359.0, -368.0, -354.0, -352.0, -362.0, -369.0, -357.0, -370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0], "episode_lengths": [350, 338, 324, 333, 330, 331, 382, 368, 368, 370, 360, 369, 355, 353, 363, 370, 358, 371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6565752826025919, "mean_inference_ms": 2.430075905906877, "mean_action_processing_ms": 0.26454511028504135, "mean_env_wait_ms": 0.3912521381533353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016750084174858345, "StateBufferConnector_ms": 0.011783379774827223, "ViewRequirementAgentConnector_ms": 0.26300294058663504}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.4215640042277, "num_env_steps_trained_throughput_per_sec": 392.4215640042277, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10240.72, "sample_time_ms": 232.46, "load_time_ms": 1.49, "load_throughput": 2683839.263, "learn_time_ms": 9887.226, "learn_throughput": 404.562, "synch_weights_time_ms": 118.626}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 91, "training_iteration": 14, "trial_id": "default", "date": "2024-08-30_16-37-59", "timestamp": 1725007079, "time_this_iter_s": 10.789062023162842, "time_total_s": 150.67594289779663, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 150.67594289779663, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 6.528571428571428, "ram_util_percent": 14.5, "gpu_util_percent0": 0.1285714285714286, "vram_util_percent0": 0.1427060081845238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.900929382795929, "policy_loss": 0.00512284155614594, "vf_loss": 7.894979111866284, "vf_explained_var": 0.0750959127180038, "kl": 0.008274310474973724, "entropy": 0.7689849531778725, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -84.0, "episode_reward_min": -475.0, "episode_reward_mean": -402.43, "episode_len_mean": 403.43, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0], "episode_lengths": [371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6543887645448301, "mean_inference_ms": 2.4151340989744092, "mean_action_processing_ms": 0.2621853745371105, "mean_env_wait_ms": 0.3874094488979076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016754150390625, "StateBufferConnector_ms": 0.011354923248291016, "ViewRequirementAgentConnector_ms": 0.26583147048950195}}, "episode_reward_max": -84.0, "episode_reward_min": -475.0, "episode_reward_mean": -402.43, "episode_len_mean": 403.43, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-370.0, -349.0, -364.0, -352.0, -357.0, -342.0, -396.0, -393.0, -399.0, -391.0, -404.0, -403.0, -415.0, -408.0, -394.0, -376.0, -379.0, -377.0, -400.0, -384.0, -381.0, -400.0, -388.0, -384.0, -392.0, -390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0], "episode_lengths": [371, 350, 365, 353, 358, 343, 397, 394, 400, 392, 405, 404, 416, 409, 395, 377, 380, 378, 401, 385, 382, 401, 389, 385, 393, 391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6543887645448301, "mean_inference_ms": 2.4151340989744092, "mean_action_processing_ms": 0.2621853745371105, "mean_env_wait_ms": 0.3874094488979076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016754150390625, "StateBufferConnector_ms": 0.011354923248291016, "ViewRequirementAgentConnector_ms": 0.26583147048950195}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.22278091590715, "num_env_steps_trained_throughput_per_sec": 390.22278091590715, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10240.488, "sample_time_ms": 230.929, "load_time_ms": 1.511, "load_throughput": 2648128.167, "learn_time_ms": 9887.904, "learn_throughput": 404.535, "synch_weights_time_ms": 119.221}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 117, "training_iteration": 15, "trial_id": "default", "date": "2024-08-30_16-38-10", "timestamp": 1725007090, "time_this_iter_s": 10.813512325286865, "time_total_s": 161.4894552230835, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 161.4894552230835, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.1499999999999995, "ram_util_percent": 14.5, "gpu_util_percent0": 0.11857142857142856, "vram_util_percent0": 0.14267113095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.990063237631193, "policy_loss": -0.007853672116674404, "vf_loss": 7.99703556388937, "vf_explained_var": -0.13377973033535864, "kl": 0.008813461797719982, "entropy": 0.7595398467715069, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -84.0, "episode_reward_min": -500.0, "episode_reward_mean": -369.17, "episode_len_mean": 370.16, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0], "episode_lengths": [391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586565494698323, "mean_inference_ms": 2.442769558154763, "mean_action_processing_ms": 0.2650510554679699, "mean_env_wait_ms": 0.3929015785996876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016240596771240234, "StateBufferConnector_ms": 0.011457443237304688, "ViewRequirementAgentConnector_ms": 0.267423152923584}}, "episode_reward_max": -84.0, "episode_reward_min": -500.0, "episode_reward_mean": -369.17, "episode_len_mean": 370.16, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-390.0, -398.0, -375.0, -397.0, -387.0, -386.0, -385.0, -384.0, -394.0, -377.0, -398.0, -387.0, -382.0, -397.0, -388.0, -396.0, -392.0, -394.0, -380.0, -374.0, -390.0, -430.0, -436.0, -432.0, -447.0, -427.0, -425.0, -426.0, -410.0, -408.0, -423.0, -421.0, -414.0, -407.0, -403.0, -426.0, -406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0], "episode_lengths": [391, 399, 376, 398, 388, 387, 386, 385, 395, 378, 399, 388, 383, 398, 389, 397, 393, 395, 381, 375, 391, 431, 437, 433, 448, 428, 426, 427, 411, 409, 424, 422, 415, 408, 404, 427, 407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586565494698323, "mean_inference_ms": 2.442769558154763, "mean_action_processing_ms": 0.2650510554679699, "mean_env_wait_ms": 0.3929015785996876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016240596771240234, "StateBufferConnector_ms": 0.011457443237304688, "ViewRequirementAgentConnector_ms": 0.267423152923584}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.24369529624573, "num_env_steps_trained_throughput_per_sec": 392.24369529624573, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10220.15, "sample_time_ms": 231.705, "load_time_ms": 1.518, "load_throughput": 2635772.01, "learn_time_ms": 9872.839, "learn_throughput": 405.152, "synch_weights_time_ms": 113.237}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 142, "training_iteration": 16, "trial_id": "default", "date": "2024-08-30_16-38-20", "timestamp": 1725007100, "time_this_iter_s": 10.770448446273804, "time_total_s": 172.2599036693573, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 172.2599036693573, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.307142857142857, "ram_util_percent": 14.5, "gpu_util_percent0": 0.2, "vram_util_percent0": 0.14270310174851192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.600217374165853, "policy_loss": -0.009293677077017804, "vf_loss": 7.608280561303579, "vf_explained_var": 0.15721126999906315, "kl": 0.01230482448479824, "entropy": 0.7522318972054348, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -84.0, "episode_reward_min": -500.0, "episode_reward_mean": -288.42, "episode_len_mean": 289.36, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0], "episode_lengths": [407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6576704299861541, "mean_inference_ms": 2.435172949117957, "mean_action_processing_ms": 0.2640530666941892, "mean_env_wait_ms": 0.39230949249628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0184628963470459, "StateBufferConnector_ms": 0.011631011962890625, "ViewRequirementAgentConnector_ms": 0.26502084732055664}}, "episode_reward_max": -84.0, "episode_reward_min": -500.0, "episode_reward_mean": -288.42, "episode_len_mean": 289.36, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-406.0, -410.0, -431.0, -408.0, -404.0, -406.0, -424.0, -427.0, -430.0, -406.0, -424.0, -421.0, -403.0, -458.0, -84.0, -474.0, -453.0, -460.0, -473.0, -464.0, -459.0, -137.0, -475.0, -455.0, -451.0, -441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0], "episode_lengths": [407, 411, 432, 409, 405, 407, 425, 428, 431, 407, 425, 422, 404, 459, 85, 475, 454, 461, 474, 465, 460, 138, 476, 456, 452, 442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6576704299861541, "mean_inference_ms": 2.435172949117957, "mean_action_processing_ms": 0.2640530666941892, "mean_env_wait_ms": 0.39230949249628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0184628963470459, "StateBufferConnector_ms": 0.011631011962890625, "ViewRequirementAgentConnector_ms": 0.26502084732055664}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.2730787713393, "num_env_steps_trained_throughput_per_sec": 390.2730787713393, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10214.709, "sample_time_ms": 228.28, "load_time_ms": 1.502, "load_throughput": 2662838.822, "learn_time_ms": 9873.312, "learn_throughput": 405.133, "synch_weights_time_ms": 110.796}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 178, "training_iteration": 17, "trial_id": "default", "date": "2024-08-30_16-38-31", "timestamp": 1725007111, "time_this_iter_s": 10.803783178329468, "time_total_s": 183.06368684768677, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 183.06368684768677, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 7.064285714285714, "ram_util_percent": 14.5, "gpu_util_percent0": 0.1857142857142857, "vram_util_percent0": 0.14247058686755953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.603007593975272, "policy_loss": -0.010863307384794118, "vf_loss": 7.613201965311522, "vf_explained_var": 0.032114745147766605, "kl": 0.006689195858842883, "entropy": 0.7135671685459793, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -500.0, "episode_reward_mean": -220.66, "episode_len_mean": 221.6, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0], "episode_lengths": [442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6571027205342429, "mean_inference_ms": 2.4354227616694115, "mean_action_processing_ms": 0.2639634173071536, "mean_env_wait_ms": 0.39364445008904314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01794290542602539, "StateBufferConnector_ms": 0.011649847030639648, "ViewRequirementAgentConnector_ms": 0.2651021480560303}}, "episode_reward_max": -80.0, "episode_reward_min": -500.0, "episode_reward_mean": -220.66, "episode_len_mean": 221.6, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-441.0, -434.0, -458.0, -434.0, -437.0, -459.0, -438.0, -131.0, -455.0, -437.0, -446.0, -452.0, -449.0, -445.0, -500.0, -128.0, -102.0, -170.0, -131.0, -491.0, -111.0, -121.0, -468.0, -125.0, -112.0, -119.0, -106.0, -465.0, -121.0, -103.0, -467.0, -473.0, -147.0, -160.0, -474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0], "episode_lengths": [442, 435, 459, 435, 438, 460, 439, 132, 456, 438, 447, 453, 450, 446, 500, 129, 103, 171, 132, 492, 112, 122, 469, 126, 113, 120, 107, 466, 122, 104, 468, 474, 148, 161, 475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6571027205342429, "mean_inference_ms": 2.4354227616694115, "mean_action_processing_ms": 0.2639634173071536, "mean_env_wait_ms": 0.39364445008904314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01794290542602539, "StateBufferConnector_ms": 0.011649847030639648, "ViewRequirementAgentConnector_ms": 0.2651021480560303}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.0288821415109, "num_env_steps_trained_throughput_per_sec": 389.0288821415109, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10197.99, "sample_time_ms": 226.307, "load_time_ms": 1.481, "load_throughput": 2700340.576, "learn_time_ms": 9861.347, "learn_throughput": 405.624, "synch_weights_time_ms": 108.033}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 203, "training_iteration": 18, "trial_id": "default", "date": "2024-08-30_16-38-42", "timestamp": 1725007122, "time_this_iter_s": 10.830741167068481, "time_total_s": 193.89442801475525, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 193.89442801475525, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 7.321428571428571, "ram_util_percent": 14.5, "gpu_util_percent0": 0.2278571428571428, "vram_util_percent0": 0.14278157552083334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.457646591945361, "policy_loss": -0.014776203989161438, "vf_loss": 7.471771426354685, "vf_explained_var": -0.1398693650640467, "kl": 0.006513561243635743, "entropy": 0.7214115515831978, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -500.0, "episode_reward_mean": -163.83, "episode_len_mean": 164.78, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0, -140.0, -141.0, -114.0, -138.0, -131.0, -180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0], "episode_lengths": [475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144, 141, 142, 115, 139, 132, 181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520169467524624, "mean_inference_ms": 2.4019009887828005, "mean_action_processing_ms": 0.26040407147433803, "mean_env_wait_ms": 0.3863730624502136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018760204315185547, "StateBufferConnector_ms": 0.011975288391113281, "ViewRequirementAgentConnector_ms": 0.270310640335083}}, "episode_reward_max": -80.0, "episode_reward_min": -500.0, "episode_reward_mean": -163.83, "episode_len_mean": 164.78, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-474.0, -130.0, -465.0, -112.0, -471.0, -132.0, -132.0, -120.0, -162.0, -125.0, -91.0, -500.0, -105.0, -500.0, -130.0, -124.0, -132.0, -125.0, -122.0, -128.0, -126.0, -136.0, -157.0, -108.0, -147.0, -120.0, -128.0, -102.0, -138.0, -131.0, -111.0, -118.0, -118.0, -500.0, -500.0, -116.0, -128.0, -145.0, -153.0, -500.0, -101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0, -140.0, -141.0, -114.0, -138.0, -131.0, -180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0], "episode_lengths": [475, 131, 466, 113, 472, 133, 133, 121, 163, 126, 92, 500, 106, 500, 131, 125, 133, 126, 123, 129, 127, 137, 158, 109, 148, 121, 129, 103, 139, 132, 112, 119, 119, 500, 500, 117, 129, 146, 154, 500, 102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144, 141, 142, 115, 139, 132, 181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520169467524624, "mean_inference_ms": 2.4019009887828005, "mean_action_processing_ms": 0.26040407147433803, "mean_env_wait_ms": 0.3863730624502136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018760204315185547, "StateBufferConnector_ms": 0.011975288391113281, "ViewRequirementAgentConnector_ms": 0.270310640335083}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.1530837126002, "num_env_steps_trained_throughput_per_sec": 389.1530837126002, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10190.415, "sample_time_ms": 226.455, "load_time_ms": 1.585, "load_throughput": 2524370.082, "learn_time_ms": 9851.442, "learn_throughput": 406.032, "synch_weights_time_ms": 110.121}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 237, "training_iteration": 19, "trial_id": "default", "date": "2024-08-30_16-38-53", "timestamp": 1725007133, "time_this_iter_s": 10.846388816833496, "time_total_s": 204.74081683158875, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 204.74081683158875, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 7.814285714285715, "ram_util_percent": 14.5, "gpu_util_percent0": 0.2185714285714286, "vram_util_percent0": 0.14247349330357142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.06286776732373, "policy_loss": -0.008927038640424769, "vf_loss": 7.071236098709927, "vf_explained_var": 0.08621408875270556, "kl": 0.0055870077223790825, "entropy": 0.7382577865354476, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -204.0, "episode_reward_mean": -134.48, "episode_len_mean": 135.48, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0, -140.0, -141.0, -114.0, -138.0, -131.0, -180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0], "episode_lengths": [102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144, 141, 142, 115, 139, 132, 181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6542973303551309, "mean_inference_ms": 2.406672783894351, "mean_action_processing_ms": 0.26142325597721305, "mean_env_wait_ms": 0.3867012201409575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018067121505737305, "StateBufferConnector_ms": 0.011692047119140625, "ViewRequirementAgentConnector_ms": 0.2647523880004883}}, "episode_reward_max": -80.0, "episode_reward_min": -204.0, "episode_reward_mean": -134.48, "episode_len_mean": 135.48, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-101.0, -122.0, -142.0, -143.0, -129.0, -125.0, -134.0, -117.0, -111.0, -130.0, -120.0, -80.0, -121.0, -93.0, -160.0, -164.0, -181.0, -118.0, -162.0, -176.0, -134.0, -152.0, -139.0, -177.0, -194.0, -143.0, -140.0, -141.0, -114.0, -138.0, -131.0, -180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0], "episode_lengths": [102, 123, 143, 144, 130, 126, 135, 118, 112, 131, 121, 81, 122, 94, 161, 165, 182, 119, 163, 177, 135, 153, 140, 178, 195, 144, 141, 142, 115, 139, 132, 181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6542973303551309, "mean_inference_ms": 2.406672783894351, "mean_action_processing_ms": 0.26142325597721305, "mean_env_wait_ms": 0.3867012201409575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018067121505737305, "StateBufferConnector_ms": 0.011692047119140625, "ViewRequirementAgentConnector_ms": 0.2647523880004883}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.33742270044246, "num_env_steps_trained_throughput_per_sec": 381.33742270044246, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10196.657, "sample_time_ms": 230.098, "load_time_ms": 1.6, "load_throughput": 2500069.441, "learn_time_ms": 9854.834, "learn_throughput": 405.892, "synch_weights_time_ms": 109.32}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 277, "training_iteration": 20, "trial_id": "default", "date": "2024-08-30_16-39-04", "timestamp": 1725007144, "time_this_iter_s": 11.082769632339478, "time_total_s": 215.82358646392822, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 215.82358646392822, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 14.5, "gpu_util_percent0": 0.24533333333333335, "vram_util_percent0": 0.1439398871527778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.351230701067115, "policy_loss": -0.006429944125314554, "vf_loss": 6.356662642058506, "vf_explained_var": 0.3127381852878037, "kl": 0.009980081846910623, "entropy": 0.7226360414617805, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -85.0, "episode_reward_min": -204.0, "episode_reward_mean": -128.74, "episode_len_mean": 129.74, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0], "episode_lengths": [181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6592897876335023, "mean_inference_ms": 2.4324401246940677, "mean_action_processing_ms": 0.2638986803307266, "mean_env_wait_ms": 0.39246626700658926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01762533187866211, "StateBufferConnector_ms": 0.011893749237060547, "ViewRequirementAgentConnector_ms": 0.2743246555328369}}, "episode_reward_max": -85.0, "episode_reward_min": -204.0, "episode_reward_mean": -128.74, "episode_len_mean": 129.74, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180.0, -114.0, -102.0, -175.0, -98.0, -154.0, -172.0, -144.0, -177.0, -141.0, -169.0, -137.0, -154.0, -158.0, -127.0, -191.0, -134.0, -117.0, -104.0, -149.0, -115.0, -130.0, -152.0, -141.0, -160.0, -141.0, -144.0, -124.0, -185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0], "episode_lengths": [181, 115, 103, 176, 99, 155, 173, 145, 178, 142, 170, 138, 155, 159, 128, 192, 135, 118, 105, 150, 116, 131, 153, 142, 161, 142, 145, 125, 186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6592897876335023, "mean_inference_ms": 2.4324401246940677, "mean_action_processing_ms": 0.2638986803307266, "mean_env_wait_ms": 0.39246626700658926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01762533187866211, "StateBufferConnector_ms": 0.011893749237060547, "ViewRequirementAgentConnector_ms": 0.2743246555328369}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.5034865748763, "num_env_steps_trained_throughput_per_sec": 383.5034865748763, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10213.786, "sample_time_ms": 243.669, "load_time_ms": 1.499, "load_throughput": 2667750.481, "learn_time_ms": 9856.869, "learn_throughput": 405.808, "synch_weights_time_ms": 110.947}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 308, "training_iteration": 21, "trial_id": "default", "date": "2024-08-30_16-39-15", "timestamp": 1725007155, "time_this_iter_s": 10.955101490020752, "time_total_s": 226.77868795394897, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 226.77868795394897, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 14.5, "gpu_util_percent0": 0.24428571428571427, "vram_util_percent0": 0.1454700288318452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.20007500366498, "policy_loss": -0.005297569582058537, "vf_loss": 7.204559926576512, "vf_explained_var": 0.14636313671706824, "kl": 0.008126272070121461, "entropy": 0.6518004507146856, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -84.0, "episode_reward_min": -204.0, "episode_reward_mean": -122.71, "episode_len_mean": 123.71, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0, -102.0, -149.0, -98.0, -101.0, -126.0, -124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0], "episode_lengths": [186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101, 103, 150, 99, 102, 127, 125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6611554579080183, "mean_inference_ms": 2.431247433684031, "mean_action_processing_ms": 0.264290616702248, "mean_env_wait_ms": 0.39237989441234716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017632722854614258, "StateBufferConnector_ms": 0.011886835098266602, "ViewRequirementAgentConnector_ms": 0.2770686149597168}}, "episode_reward_max": -84.0, "episode_reward_min": -204.0, "episode_reward_mean": -122.71, "episode_len_mean": 123.71, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.0, -107.0, -143.0, -91.0, -122.0, -158.0, -144.0, -148.0, -162.0, -115.0, -157.0, -131.0, -104.0, -158.0, -96.0, -204.0, -121.0, -126.0, -85.0, -138.0, -90.0, -122.0, -182.0, -116.0, -140.0, -110.0, -105.0, -116.0, -114.0, -175.0, -130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0, -102.0, -149.0, -98.0, -101.0, -126.0, -124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0], "episode_lengths": [186, 108, 144, 92, 123, 159, 145, 149, 163, 116, 158, 132, 105, 159, 97, 205, 122, 127, 86, 139, 91, 123, 183, 117, 141, 111, 106, 117, 115, 176, 131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101, 103, 150, 99, 102, 127, 125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6611554579080183, "mean_inference_ms": 2.431247433684031, "mean_action_processing_ms": 0.264290616702248, "mean_env_wait_ms": 0.39237989441234716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017632722854614258, "StateBufferConnector_ms": 0.011886835098266602, "ViewRequirementAgentConnector_ms": 0.2770686149597168}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.489737602805, "num_env_steps_trained_throughput_per_sec": 392.489737602805, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10288.543, "sample_time_ms": 243.619, "load_time_ms": 1.502, "load_throughput": 2663007.889, "learn_time_ms": 9930.632, "learn_throughput": 402.794, "synch_weights_time_ms": 111.991}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 336, "training_iteration": 22, "trial_id": "default", "date": "2024-08-30_16-39-26", "timestamp": 1725007166, "time_this_iter_s": 10.769859790802002, "time_total_s": 237.54854774475098, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 237.54854774475098, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 6.607142857142857, "ram_util_percent": 14.5, "gpu_util_percent0": 0.14714285714285716, "vram_util_percent0": 0.14418247767857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.243559442027923, "policy_loss": -0.009528714332288952, "vf_loss": 7.2524033418265725, "vf_explained_var": 0.040880852360879225, "kl": 0.006848129787359021, "entropy": 0.6421888759700201, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -194.0, "episode_reward_mean": -118.74, "episode_len_mean": 119.74, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0, -102.0, -149.0, -98.0, -101.0, -126.0, -124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0, -132.0, -106.0, -126.0, -111.0, -123.0, -125.0, -96.0, -122.0, -117.0, -99.0, -119.0, -84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0], "episode_lengths": [131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101, 103, 150, 99, 102, 127, 125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195, 133, 107, 127, 112, 124, 126, 97, 123, 118, 100, 120, 85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6610667539279966, "mean_inference_ms": 2.430654820626884, "mean_action_processing_ms": 0.2637848898266513, "mean_env_wait_ms": 0.3921075315571633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017459630966186523, "StateBufferConnector_ms": 0.012331962585449219, "ViewRequirementAgentConnector_ms": 0.2850043773651123}}, "episode_reward_max": -80.0, "episode_reward_min": -194.0, "episode_reward_mean": -118.74, "episode_len_mean": 119.74, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-130.0, -114.0, -124.0, -109.0, -104.0, -86.0, -133.0, -129.0, -99.0, -128.0, -91.0, -94.0, -117.0, -105.0, -142.0, -100.0, -130.0, -91.0, -123.0, -92.0, -137.0, -126.0, -119.0, -150.0, -121.0, -131.0, -119.0, -110.0, -174.0, -129.0, -116.0, -112.0, -116.0, -118.0, -98.0, -114.0, -93.0, -120.0, -121.0, -117.0, -123.0, -100.0, -102.0, -149.0, -98.0, -101.0, -126.0, -124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0, -132.0, -106.0, -126.0, -111.0, -123.0, -125.0, -96.0, -122.0, -117.0, -99.0, -119.0, -84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0], "episode_lengths": [131, 115, 125, 110, 105, 87, 134, 130, 100, 129, 92, 95, 118, 106, 143, 101, 131, 92, 124, 93, 138, 127, 120, 151, 122, 132, 120, 111, 175, 130, 117, 113, 117, 119, 99, 115, 94, 121, 122, 118, 124, 101, 103, 150, 99, 102, 127, 125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195, 133, 107, 127, 112, 124, 126, 97, 123, 118, 100, 120, 85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6610667539279966, "mean_inference_ms": 2.430654820626884, "mean_action_processing_ms": 0.2637848898266513, "mean_env_wait_ms": 0.3921075315571633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017459630966186523, "StateBufferConnector_ms": 0.012331962585449219, "ViewRequirementAgentConnector_ms": 0.2850043773651123}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.80795361469825, "num_env_steps_trained_throughput_per_sec": 388.80795361469825, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10284.957, "sample_time_ms": 243.771, "load_time_ms": 1.493, "load_throughput": 2678440.563, "learn_time_ms": 9925.191, "learn_throughput": 403.015, "synch_weights_time_ms": 113.703}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 366, "training_iteration": 23, "trial_id": "default", "date": "2024-08-30_16-39-37", "timestamp": 1725007177, "time_this_iter_s": 10.833571910858154, "time_total_s": 248.38211965560913, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 248.38211965560913, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 6.714285714285715, "ram_util_percent": 14.5, "gpu_util_percent0": 0.1492857142857143, "vram_util_percent0": 0.1439964657738095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.669765432932044, "policy_loss": -0.01808589990100553, "vf_loss": 6.6868718493369315, "vf_explained_var": 0.23796185735733277, "kl": 0.00979481543109878, "entropy": 0.6250233484852699, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -232.0, "episode_reward_mean": -119.8, "episode_len_mean": 120.8, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0, -132.0, -106.0, -126.0, -111.0, -123.0, -125.0, -96.0, -122.0, -117.0, -99.0, -119.0, -84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0, -108.0, -97.0, -112.0, -232.0, -153.0, -110.0, -114.0, -151.0, -143.0, -142.0, -99.0, -86.0, -115.0, -126.0, -83.0, -121.0, -112.0, -131.0, -136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0], "episode_lengths": [125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195, 133, 107, 127, 112, 124, 126, 97, 123, 118, 100, 120, 85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153, 109, 98, 113, 233, 154, 111, 115, 152, 144, 143, 100, 87, 116, 127, 84, 122, 113, 132, 137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6612310020163465, "mean_inference_ms": 2.426395171590897, "mean_action_processing_ms": 0.2636277370597901, "mean_env_wait_ms": 0.3916274065904859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01624584197998047, "StateBufferConnector_ms": 0.012353658676147461, "ViewRequirementAgentConnector_ms": 0.28191709518432617}}, "episode_reward_max": -80.0, "episode_reward_min": -232.0, "episode_reward_mean": -119.8, "episode_len_mean": 120.8, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-124.0, -115.0, -113.0, -132.0, -142.0, -95.0, -170.0, -136.0, -147.0, -104.0, -108.0, -107.0, -114.0, -93.0, -137.0, -107.0, -101.0, -166.0, -130.0, -84.0, -101.0, -105.0, -194.0, -132.0, -106.0, -126.0, -111.0, -123.0, -125.0, -96.0, -122.0, -117.0, -99.0, -119.0, -84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0, -108.0, -97.0, -112.0, -232.0, -153.0, -110.0, -114.0, -151.0, -143.0, -142.0, -99.0, -86.0, -115.0, -126.0, -83.0, -121.0, -112.0, -131.0, -136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0], "episode_lengths": [125, 116, 114, 133, 143, 96, 171, 137, 148, 105, 109, 108, 115, 94, 138, 108, 102, 167, 131, 85, 102, 106, 195, 133, 107, 127, 112, 124, 126, 97, 123, 118, 100, 120, 85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153, 109, 98, 113, 233, 154, 111, 115, 152, 144, 143, 100, 87, 116, 127, 84, 122, 113, 132, 137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6612310020163465, "mean_inference_ms": 2.426395171590897, "mean_action_processing_ms": 0.2636277370597901, "mean_env_wait_ms": 0.3916274065904859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01624584197998047, "StateBufferConnector_ms": 0.012353658676147461, "ViewRequirementAgentConnector_ms": 0.28191709518432617}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.19601765550897, "num_env_steps_trained_throughput_per_sec": 393.19601765550897, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10282.947, "sample_time_ms": 244.678, "load_time_ms": 1.494, "load_throughput": 2677414.701, "learn_time_ms": 9919.396, "learn_throughput": 403.25, "synch_weights_time_ms": 116.563}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 413, "training_iteration": 24, "trial_id": "default", "date": "2024-08-30_16-39-48", "timestamp": 1725007188, "time_this_iter_s": 10.717432022094727, "time_total_s": 259.09955167770386, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 259.09955167770386, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.985714285714286, "ram_util_percent": 14.5, "gpu_util_percent0": 0.155, "vram_util_percent0": 0.14362734840029762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0196536925531205, "policy_loss": -0.021560535930417558, "vf_loss": 7.040579612280733, "vf_explained_var": 0.013406221007788053, "kl": 0.00634609132663094, "entropy": 0.5713392305117782, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -117.85, "episode_len_mean": 118.85, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0, -108.0, -97.0, -112.0, -232.0, -153.0, -110.0, -114.0, -151.0, -143.0, -142.0, -99.0, -86.0, -115.0, -126.0, -83.0, -121.0, -112.0, -131.0, -136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0, -69.0, -130.0, -123.0, -112.0, -101.0, -86.0, -120.0, -148.0, -109.0, -106.0, -136.0, -111.0, -128.0, -92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0], "episode_lengths": [85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153, 109, 98, 113, 233, 154, 111, 115, 152, 144, 143, 100, 87, 116, 127, 84, 122, 113, 132, 137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104, 70, 131, 124, 113, 102, 87, 121, 149, 110, 107, 137, 112, 129, 93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6637714961677009, "mean_inference_ms": 2.4411705445667145, "mean_action_processing_ms": 0.26488468362189055, "mean_env_wait_ms": 0.39480083039345587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016622304916381836, "StateBufferConnector_ms": 0.012941837310791016, "ViewRequirementAgentConnector_ms": 0.2899339199066162}}, "episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -117.85, "episode_len_mean": 118.85, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.0, -139.0, -134.0, -141.0, -134.0, -80.0, -110.0, -105.0, -114.0, -143.0, -114.0, -126.0, -101.0, -113.0, -126.0, -128.0, -122.0, -126.0, -152.0, -108.0, -97.0, -112.0, -232.0, -153.0, -110.0, -114.0, -151.0, -143.0, -142.0, -99.0, -86.0, -115.0, -126.0, -83.0, -121.0, -112.0, -131.0, -136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0, -69.0, -130.0, -123.0, -112.0, -101.0, -86.0, -120.0, -148.0, -109.0, -106.0, -136.0, -111.0, -128.0, -92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0], "episode_lengths": [85, 140, 135, 142, 135, 81, 111, 106, 115, 144, 115, 127, 102, 114, 127, 129, 123, 127, 153, 109, 98, 113, 233, 154, 111, 115, 152, 144, 143, 100, 87, 116, 127, 84, 122, 113, 132, 137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104, 70, 131, 124, 113, 102, 87, 121, 149, 110, 107, 137, 112, 129, 93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6637714961677009, "mean_inference_ms": 2.4411705445667145, "mean_action_processing_ms": 0.26488468362189055, "mean_env_wait_ms": 0.39480083039345587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016622304916381836, "StateBufferConnector_ms": 0.012941837310791016, "ViewRequirementAgentConnector_ms": 0.2899339199066162}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.84527902404227, "num_env_steps_trained_throughput_per_sec": 385.84527902404227, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10294.576, "sample_time_ms": 243.351, "load_time_ms": 1.477, "load_throughput": 2708011.751, "learn_time_ms": 9931.591, "learn_throughput": 402.755, "synch_weights_time_ms": 117.348}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 447, "training_iteration": 25, "trial_id": "default", "date": "2024-08-30_16-39-59", "timestamp": 1725007199, "time_this_iter_s": 10.905370950698853, "time_total_s": 270.0049226284027, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 270.0049226284027, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 9.535714285714286, "ram_util_percent": 14.485714285714286, "gpu_util_percent0": 0.2678571428571429, "vram_util_percent0": 0.14673723493303573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.885279261681341, "policy_loss": -0.009687704899378362, "vf_loss": 6.894347968409138, "vf_explained_var": 0.11884175019879495, "kl": 0.006190153515482414, "entropy": 0.5497931882578839, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -111.66, "episode_len_mean": 112.66, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0, -69.0, -130.0, -123.0, -112.0, -101.0, -86.0, -120.0, -148.0, -109.0, -106.0, -136.0, -111.0, -128.0, -92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0, -101.0, -83.0, -101.0, -88.0, -80.0, -145.0, -159.0, -123.0, -87.0, -130.0, -178.0, -96.0, -125.0, -89.0, -139.0, -109.0, -95.0, -126.0, -91.0, -76.0, -133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0], "episode_lengths": [137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104, 70, 131, 124, 113, 102, 87, 121, 149, 110, 107, 137, 112, 129, 93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81, 102, 84, 102, 89, 81, 146, 160, 124, 88, 131, 179, 97, 126, 90, 140, 110, 96, 127, 92, 77, 134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6625128555541946, "mean_inference_ms": 2.4351570446472497, "mean_action_processing_ms": 0.26422226254650555, "mean_env_wait_ms": 0.3937840381774874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018193483352661133, "StateBufferConnector_ms": 0.012482881546020508, "ViewRequirementAgentConnector_ms": 0.2831084728240967}}, "episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -111.66, "episode_len_mean": 112.66, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-136.0, -143.0, -124.0, -112.0, -100.0, -113.0, -117.0, -108.0, -107.0, -118.0, -97.0, -92.0, -114.0, -87.0, -103.0, -160.0, -140.0, -114.0, -100.0, -105.0, -104.0, -124.0, -119.0, -161.0, -92.0, -130.0, -105.0, -124.0, -103.0, -69.0, -130.0, -123.0, -112.0, -101.0, -86.0, -120.0, -148.0, -109.0, -106.0, -136.0, -111.0, -128.0, -92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0, -101.0, -83.0, -101.0, -88.0, -80.0, -145.0, -159.0, -123.0, -87.0, -130.0, -178.0, -96.0, -125.0, -89.0, -139.0, -109.0, -95.0, -126.0, -91.0, -76.0, -133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0], "episode_lengths": [137, 144, 125, 113, 101, 114, 118, 109, 108, 119, 98, 93, 115, 88, 104, 161, 141, 115, 101, 106, 105, 125, 120, 162, 93, 131, 106, 125, 104, 70, 131, 124, 113, 102, 87, 121, 149, 110, 107, 137, 112, 129, 93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81, 102, 84, 102, 89, 81, 146, 160, 124, 88, 131, 179, 97, 126, 90, 140, 110, 96, 127, 92, 77, 134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6625128555541946, "mean_inference_ms": 2.4351570446472497, "mean_action_processing_ms": 0.26422226254650555, "mean_env_wait_ms": 0.3937840381774874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018193483352661133, "StateBufferConnector_ms": 0.012482881546020508, "ViewRequirementAgentConnector_ms": 0.2831084728240967}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.38135417186453, "num_env_steps_trained_throughput_per_sec": 389.38135417186453, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10302.07, "sample_time_ms": 244.321, "load_time_ms": 1.467, "load_throughput": 2727381.734, "learn_time_ms": 9936.402, "learn_throughput": 402.56, "synch_weights_time_ms": 119.058}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 484, "training_iteration": 26, "trial_id": "default", "date": "2024-08-30_16-40-09", "timestamp": 1725007209, "time_this_iter_s": 10.822489023208618, "time_total_s": 280.8274116516113, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 280.8274116516113, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 9.514285714285714, "ram_util_percent": 14.214285714285717, "gpu_util_percent0": 0.265, "vram_util_percent0": 0.1446533203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.938018613989636, "policy_loss": -0.008281020109131131, "vf_loss": 6.94564456606424, "vf_explained_var": 0.10522652986229107, "kl": 0.006550692638323795, "entropy": 0.5719224366769996, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -107.43, "episode_len_mean": 108.43, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0, -101.0, -83.0, -101.0, -88.0, -80.0, -145.0, -159.0, -123.0, -87.0, -130.0, -178.0, -96.0, -125.0, -89.0, -139.0, -109.0, -95.0, -126.0, -91.0, -76.0, -133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0, -108.0, -123.0, -105.0, -97.0, -69.0, -108.0, -115.0, -152.0, -106.0, -101.0, -86.0, -114.0, -111.0, -92.0, -114.0, -86.0, -129.0, -100.0, -84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0], "episode_lengths": [93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81, 102, 84, 102, 89, 81, 146, 160, 124, 88, 131, 179, 97, 126, 90, 140, 110, 96, 127, 92, 77, 134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112, 109, 124, 106, 98, 70, 109, 116, 153, 107, 102, 87, 115, 112, 93, 115, 87, 130, 101, 85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6683696544927342, "mean_inference_ms": 2.446229510246043, "mean_action_processing_ms": 0.2657141704042259, "mean_env_wait_ms": 0.3952339576260689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018080711364746094, "StateBufferConnector_ms": 0.012146472930908203, "ViewRequirementAgentConnector_ms": 0.2798643112182617}}, "episode_reward_max": -66.0, "episode_reward_min": -282.0, "episode_reward_mean": -107.43, "episode_len_mean": 108.43, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-92.0, -113.0, -94.0, -95.0, -119.0, -151.0, -107.0, -120.0, -138.0, -66.0, -118.0, -126.0, -116.0, -102.0, -130.0, -90.0, -97.0, -282.0, -96.0, -95.0, -80.0, -101.0, -83.0, -101.0, -88.0, -80.0, -145.0, -159.0, -123.0, -87.0, -130.0, -178.0, -96.0, -125.0, -89.0, -139.0, -109.0, -95.0, -126.0, -91.0, -76.0, -133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0, -108.0, -123.0, -105.0, -97.0, -69.0, -108.0, -115.0, -152.0, -106.0, -101.0, -86.0, -114.0, -111.0, -92.0, -114.0, -86.0, -129.0, -100.0, -84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0], "episode_lengths": [93, 114, 95, 96, 120, 152, 108, 121, 139, 67, 119, 127, 117, 103, 131, 91, 98, 283, 97, 96, 81, 102, 84, 102, 89, 81, 146, 160, 124, 88, 131, 179, 97, 126, 90, 140, 110, 96, 127, 92, 77, 134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112, 109, 124, 106, 98, 70, 109, 116, 153, 107, 102, 87, 115, 112, 93, 115, 87, 130, 101, 85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6683696544927342, "mean_inference_ms": 2.446229510246043, "mean_action_processing_ms": 0.2657141704042259, "mean_env_wait_ms": 0.3952339576260689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018080711364746094, "StateBufferConnector_ms": 0.012146472930908203, "ViewRequirementAgentConnector_ms": 0.2798643112182617}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.0926242621974, "num_env_steps_trained_throughput_per_sec": 386.0926242621974, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10313.157, "sample_time_ms": 245.604, "load_time_ms": 1.493, "load_throughput": 2678996.567, "learn_time_ms": 9942.394, "learn_throughput": 402.318, "synch_weights_time_ms": 122.785}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 526, "training_iteration": 27, "trial_id": "default", "date": "2024-08-30_16-40-20", "timestamp": 1725007220, "time_this_iter_s": 10.877069473266602, "time_total_s": 291.70448112487793, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 291.70448112487793, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.071428571428571, "ram_util_percent": 14.0, "gpu_util_percent0": 0.2557142857142857, "vram_util_percent0": 0.14312453497023808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.166726815315985, "policy_loss": -0.011100643166210704, "vf_loss": 7.17720925628498, "vf_explained_var": 0.1317437873091749, "kl": 0.006182205387668419, "entropy": 0.5623202849459904, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -69.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.7, "episode_len_mean": 104.7, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0, -108.0, -123.0, -105.0, -97.0, -69.0, -108.0, -115.0, -152.0, -106.0, -101.0, -86.0, -114.0, -111.0, -92.0, -114.0, -86.0, -129.0, -100.0, -84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0, -94.0, -103.0, -88.0, -109.0, -85.0, -80.0, -80.0, -96.0, -118.0, -96.0, -108.0, -90.0, -89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0], "episode_lengths": [134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112, 109, 124, 106, 98, 70, 109, 116, 153, 107, 102, 87, 115, 112, 93, 115, 87, 130, 101, 85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97, 95, 104, 89, 110, 86, 81, 81, 97, 119, 97, 109, 91, 90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6663452703572382, "mean_inference_ms": 2.4390305359508027, "mean_action_processing_ms": 0.2651767688159421, "mean_env_wait_ms": 0.3938417743174466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017145156860351562, "StateBufferConnector_ms": 0.012137413024902344, "ViewRequirementAgentConnector_ms": 0.28091931343078613}}, "episode_reward_max": -69.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.7, "episode_len_mean": 104.7, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.0, -100.0, -81.0, -78.0, -171.0, -105.0, -77.0, -90.0, -114.0, -101.0, -82.0, -81.0, -87.0, -99.0, -95.0, -82.0, -111.0, -108.0, -123.0, -105.0, -97.0, -69.0, -108.0, -115.0, -152.0, -106.0, -101.0, -86.0, -114.0, -111.0, -92.0, -114.0, -86.0, -129.0, -100.0, -84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0, -94.0, -103.0, -88.0, -109.0, -85.0, -80.0, -80.0, -96.0, -118.0, -96.0, -108.0, -90.0, -89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0], "episode_lengths": [134, 101, 82, 79, 172, 106, 78, 91, 115, 102, 83, 82, 88, 100, 96, 83, 112, 109, 124, 106, 98, 70, 109, 116, 153, 107, 102, 87, 115, 112, 93, 115, 87, 130, 101, 85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97, 95, 104, 89, 110, 86, 81, 81, 97, 119, 97, 109, 91, 90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6663452703572382, "mean_inference_ms": 2.4390305359508027, "mean_action_processing_ms": 0.2651767688159421, "mean_env_wait_ms": 0.3938417743174466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017145156860351562, "StateBufferConnector_ms": 0.012137413024902344, "ViewRequirementAgentConnector_ms": 0.28091931343078613}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.2830956337726, "num_env_steps_trained_throughput_per_sec": 392.2830956337726, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 10304.629, "sample_time_ms": 245.952, "load_time_ms": 1.496, "load_throughput": 2673745.139, "learn_time_ms": 9933.047, "learn_throughput": 402.696, "synch_weights_time_ms": 123.247}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 567, "training_iteration": 28, "trial_id": "default", "date": "2024-08-30_16-40-31", "timestamp": 1725007231, "time_this_iter_s": 10.749228239059448, "time_total_s": 302.4537093639374, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 302.4537093639374, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 7.064285714285714, "ram_util_percent": 14.0, "gpu_util_percent0": 0.17785714285714288, "vram_util_percent0": 0.1427815755208333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.30217936038971, "policy_loss": -0.011371174757118506, "vf_loss": 7.312959783307968, "vf_explained_var": 0.23545953599355554, "kl": 0.005907721354034497, "entropy": 0.5173370591735327, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -73.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.85, "episode_len_mean": 104.85, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0, -94.0, -103.0, -88.0, -109.0, -85.0, -80.0, -80.0, -96.0, -118.0, -96.0, -108.0, -90.0, -89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0, -121.0, -91.0, -107.0, -128.0, -104.0, -82.0, -113.0, -111.0, -97.0, -114.0, -137.0, -109.0, -119.0, -89.0, -110.0, -82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0], "episode_lengths": [85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97, 95, 104, 89, 110, 86, 81, 81, 97, 119, 97, 109, 91, 90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118, 122, 92, 108, 129, 105, 83, 114, 112, 98, 115, 138, 110, 120, 90, 111, 83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6678597413764363, "mean_inference_ms": 2.448358477213536, "mean_action_processing_ms": 0.26551710712620485, "mean_env_wait_ms": 0.39611171462862443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016084909439086914, "StateBufferConnector_ms": 0.011913537979125977, "ViewRequirementAgentConnector_ms": 0.2768435478210449}}, "episode_reward_max": -73.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.85, "episode_len_mean": 104.85, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.0, -91.0, -140.0, -97.0, -86.0, -190.0, -120.0, -108.0, -91.0, -85.0, -77.0, -125.0, -92.0, -113.0, -121.0, -79.0, -115.0, -114.0, -95.0, -92.0, -84.0, -102.0, -95.0, -96.0, -94.0, -103.0, -88.0, -109.0, -85.0, -80.0, -80.0, -96.0, -118.0, -96.0, -108.0, -90.0, -89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0, -121.0, -91.0, -107.0, -128.0, -104.0, -82.0, -113.0, -111.0, -97.0, -114.0, -137.0, -109.0, -119.0, -89.0, -110.0, -82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0], "episode_lengths": [85, 92, 141, 98, 87, 191, 121, 109, 92, 86, 78, 126, 93, 114, 122, 80, 116, 115, 96, 93, 85, 103, 96, 97, 95, 104, 89, 110, 86, 81, 81, 97, 119, 97, 109, 91, 90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118, 122, 92, 108, 129, 105, 83, 114, 112, 98, 115, 138, 110, 120, 90, 111, 83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6678597413764363, "mean_inference_ms": 2.448358477213536, "mean_action_processing_ms": 0.26551710712620485, "mean_env_wait_ms": 0.39611171462862443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016084909439086914, "StateBufferConnector_ms": 0.011913537979125977, "ViewRequirementAgentConnector_ms": 0.2768435478210449}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.5987916965112, "num_env_steps_trained_throughput_per_sec": 383.5987916965112, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 10319.512, "sample_time_ms": 248.556, "load_time_ms": 1.381, "load_throughput": 2896868.86, "learn_time_ms": 9944.888, "learn_throughput": 402.217, "synch_weights_time_ms": 123.804}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 602, "training_iteration": 29, "trial_id": "default", "date": "2024-08-30_16-40-42", "timestamp": 1725007242, "time_this_iter_s": 11.021875143051147, "time_total_s": 313.4755845069885, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 313.4755845069885, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 7.214285714285714, "ram_util_percent": 14.0, "gpu_util_percent0": 0.2035714285714286, "vram_util_percent0": 0.14369128999255953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5365828114171185, "policy_loss": -0.013528277837140586, "vf_loss": 7.549521292409589, "vf_explained_var": 0.2395537672504302, "kl": 0.005897816253088412, "entropy": 0.5231232911027888, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -73.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.4, "episode_len_mean": 104.4, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0, -121.0, -91.0, -107.0, -128.0, -104.0, -82.0, -113.0, -111.0, -97.0, -114.0, -137.0, -109.0, -119.0, -89.0, -110.0, -82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0, -107.0, -81.0, -91.0, -80.0, -89.0, -101.0, -95.0, -83.0, -82.0, -121.0, -124.0, -100.0, -88.0, -83.0, -104.0, -149.0, -101.0, -105.0, -105.0, -83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0], "episode_lengths": [90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118, 122, 92, 108, 129, 105, 83, 114, 112, 98, 115, 138, 110, 120, 90, 111, 83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98, 108, 82, 92, 81, 90, 102, 96, 84, 83, 122, 125, 101, 89, 84, 105, 150, 102, 106, 106, 84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6688346003450664, "mean_inference_ms": 2.4514502495645134, "mean_action_processing_ms": 0.26596374381339793, "mean_env_wait_ms": 0.3971152495984029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01617574691772461, "StateBufferConnector_ms": 0.0118560791015625, "ViewRequirementAgentConnector_ms": 0.2710909843444824}}, "episode_reward_max": -73.0, "episode_reward_min": -221.0, "episode_reward_mean": -103.4, "episode_len_mean": 104.4, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.0, -73.0, -92.0, -221.0, -115.0, -99.0, -144.0, -129.0, -97.0, -84.0, -100.0, -107.0, -84.0, -125.0, -126.0, -82.0, -130.0, -90.0, -81.0, -82.0, -117.0, -87.0, -85.0, -125.0, -109.0, -117.0, -97.0, -124.0, -117.0, -121.0, -91.0, -107.0, -128.0, -104.0, -82.0, -113.0, -111.0, -97.0, -114.0, -137.0, -109.0, -119.0, -89.0, -110.0, -82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0, -107.0, -81.0, -91.0, -80.0, -89.0, -101.0, -95.0, -83.0, -82.0, -121.0, -124.0, -100.0, -88.0, -83.0, -104.0, -149.0, -101.0, -105.0, -105.0, -83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0], "episode_lengths": [90, 74, 93, 222, 116, 100, 145, 130, 98, 85, 101, 108, 85, 126, 127, 83, 131, 91, 82, 83, 118, 88, 86, 126, 110, 118, 98, 125, 118, 122, 92, 108, 129, 105, 83, 114, 112, 98, 115, 138, 110, 120, 90, 111, 83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98, 108, 82, 92, 81, 90, 102, 96, 84, 83, 122, 125, 101, 89, 84, 105, 150, 102, 106, 106, 84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6688346003450664, "mean_inference_ms": 2.4514502495645134, "mean_action_processing_ms": 0.26596374381339793, "mean_env_wait_ms": 0.3971152495984029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01617574691772461, "StateBufferConnector_ms": 0.0118560791015625, "ViewRequirementAgentConnector_ms": 0.2710909843444824}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.8948544384792, "num_env_steps_trained_throughput_per_sec": 386.8948544384792, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 10304.444, "sample_time_ms": 249.793, "load_time_ms": 1.371, "load_throughput": 2917421.531, "learn_time_ms": 9927.678, "learn_throughput": 402.914, "synch_weights_time_ms": 124.708}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 638, "training_iteration": 30, "trial_id": "default", "date": "2024-08-30_16-40-53", "timestamp": 1725007253, "time_this_iter_s": 10.90848708152771, "time_total_s": 324.38407158851624, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 324.38407158851624, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.466666666666667, "ram_util_percent": 14.053333333333331, "gpu_util_percent0": 0.27666666666666667, "vram_util_percent0": 0.1452555338541667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.125906069304354, "policy_loss": -0.012613102192840269, "vf_loss": 7.137628761670923, "vf_explained_var": 0.24482372146780773, "kl": 0.008903964911826157, "entropy": 0.511401163666479, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -72.0, "episode_reward_min": -158.0, "episode_reward_mean": -102.48, "episode_len_mean": 103.48, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0, -107.0, -81.0, -91.0, -80.0, -89.0, -101.0, -95.0, -83.0, -82.0, -121.0, -124.0, -100.0, -88.0, -83.0, -104.0, -149.0, -101.0, -105.0, -105.0, -83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0, -112.0, -92.0, -123.0, -132.0, -104.0, -82.0, -103.0, -115.0, -88.0, -104.0, -91.0, -124.0, -85.0, -117.0, -118.0, -92.0, -101.0, -108.0, -97.0, -113.0, -158.0, -72.0, -91.0, -113.0, -85.0, -106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0], "episode_lengths": [83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98, 108, 82, 92, 81, 90, 102, 96, 84, 83, 122, 125, 101, 89, 84, 105, 150, 102, 106, 106, 84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124, 113, 93, 124, 133, 105, 83, 104, 116, 89, 105, 92, 125, 86, 118, 119, 93, 102, 109, 98, 114, 159, 73, 92, 114, 86, 107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6654005526744069, "mean_inference_ms": 2.4305541790347225, "mean_action_processing_ms": 0.26386333763294906, "mean_env_wait_ms": 0.3925650053747478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015533924102783203, "StateBufferConnector_ms": 0.011379241943359375, "ViewRequirementAgentConnector_ms": 0.2593374252319336}}, "episode_reward_max": -72.0, "episode_reward_min": -158.0, "episode_reward_mean": -102.48, "episode_len_mean": 103.48, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-82.0, -94.0, -91.0, -80.0, -83.0, -100.0, -104.0, -111.0, -115.0, -98.0, -95.0, -82.0, -96.0, -126.0, -82.0, -79.0, -119.0, -100.0, -152.0, -97.0, -107.0, -81.0, -91.0, -80.0, -89.0, -101.0, -95.0, -83.0, -82.0, -121.0, -124.0, -100.0, -88.0, -83.0, -104.0, -149.0, -101.0, -105.0, -105.0, -83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0, -112.0, -92.0, -123.0, -132.0, -104.0, -82.0, -103.0, -115.0, -88.0, -104.0, -91.0, -124.0, -85.0, -117.0, -118.0, -92.0, -101.0, -108.0, -97.0, -113.0, -158.0, -72.0, -91.0, -113.0, -85.0, -106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0], "episode_lengths": [83, 95, 92, 81, 84, 101, 105, 112, 116, 99, 96, 83, 97, 127, 83, 80, 120, 101, 153, 98, 108, 82, 92, 81, 90, 102, 96, 84, 83, 122, 125, 101, 89, 84, 105, 150, 102, 106, 106, 84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124, 113, 93, 124, 133, 105, 83, 104, 116, 89, 105, 92, 125, 86, 118, 119, 93, 102, 109, 98, 114, 159, 73, 92, 114, 86, 107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6654005526744069, "mean_inference_ms": 2.4305541790347225, "mean_action_processing_ms": 0.26386333763294906, "mean_env_wait_ms": 0.3925650053747478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015533924102783203, "StateBufferConnector_ms": 0.011379241943359375, "ViewRequirementAgentConnector_ms": 0.2593374252319336}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.98993242758456, "num_env_steps_trained_throughput_per_sec": 382.98993242758456, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 10305.839, "sample_time_ms": 236.841, "load_time_ms": 1.394, "load_throughput": 2870451.684, "learn_time_ms": 9942.535, "learn_throughput": 402.312, "synch_weights_time_ms": 124.161}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 682, "training_iteration": 31, "trial_id": "default", "date": "2024-08-30_16-41-04", "timestamp": 1725007264, "time_this_iter_s": 11.004687786102295, "time_total_s": 335.38875937461853, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 335.38875937461853, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.057142857142859, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.2557142857142857, "vram_util_percent0": 0.14614432198660715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.087265856804386, "policy_loss": -0.023805634443077348, "vf_loss": 7.11039296888536, "vf_explained_var": 0.31582285531105536, "kl": 0.006785408960344265, "entropy": 0.4740623058811311, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -72.0, "episode_reward_min": -167.0, "episode_reward_mean": -105.53, "episode_len_mean": 106.53, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0, -112.0, -92.0, -123.0, -132.0, -104.0, -82.0, -103.0, -115.0, -88.0, -104.0, -91.0, -124.0, -85.0, -117.0, -118.0, -92.0, -101.0, -108.0, -97.0, -113.0, -158.0, -72.0, -91.0, -113.0, -85.0, -106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0, -88.0, -105.0, -114.0, -103.0, -92.0, -93.0, -100.0, -91.0, -114.0, -139.0, -89.0, -120.0, -100.0, -150.0, -115.0, -84.0, -104.0, -104.0, -93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0], "episode_lengths": [84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124, 113, 93, 124, 133, 105, 83, 104, 116, 89, 105, 92, 125, 86, 118, 119, 93, 102, 109, 98, 114, 159, 73, 92, 114, 86, 107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111, 89, 106, 115, 104, 93, 94, 101, 92, 115, 140, 90, 121, 101, 151, 116, 85, 105, 105, 94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6653976592442775, "mean_inference_ms": 2.436928104200363, "mean_action_processing_ms": 0.2648751093720901, "mean_env_wait_ms": 0.39351592307120137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.010888814926147461, "ViewRequirementAgentConnector_ms": 0.25235605239868164}}, "episode_reward_max": -72.0, "episode_reward_min": -167.0, "episode_reward_mean": -105.53, "episode_len_mean": 106.53, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83.0, -90.0, -102.0, -108.0, -108.0, -84.0, -85.0, -111.0, -128.0, -94.0, -101.0, -108.0, -104.0, -92.0, -90.0, -94.0, -123.0, -112.0, -92.0, -123.0, -132.0, -104.0, -82.0, -103.0, -115.0, -88.0, -104.0, -91.0, -124.0, -85.0, -117.0, -118.0, -92.0, -101.0, -108.0, -97.0, -113.0, -158.0, -72.0, -91.0, -113.0, -85.0, -106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0, -88.0, -105.0, -114.0, -103.0, -92.0, -93.0, -100.0, -91.0, -114.0, -139.0, -89.0, -120.0, -100.0, -150.0, -115.0, -84.0, -104.0, -104.0, -93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0], "episode_lengths": [84, 91, 103, 109, 109, 85, 86, 112, 129, 95, 102, 109, 105, 93, 91, 95, 124, 113, 93, 124, 133, 105, 83, 104, 116, 89, 105, 92, 125, 86, 118, 119, 93, 102, 109, 98, 114, 159, 73, 92, 114, 86, 107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111, 89, 106, 115, 104, 93, 94, 101, 92, 115, 140, 90, 121, 101, 151, 116, 85, 105, 105, 94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6653976592442775, "mean_inference_ms": 2.436928104200363, "mean_action_processing_ms": 0.2648751093720901, "mean_env_wait_ms": 0.39351592307120137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.010888814926147461, "ViewRequirementAgentConnector_ms": 0.25235605239868164}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.68676164533963, "num_env_steps_trained_throughput_per_sec": 385.68676164533963, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 10323.813, "sample_time_ms": 236.411, "load_time_ms": 1.384, "load_throughput": 2890829.141, "learn_time_ms": 9960.513, "learn_throughput": 401.586, "synch_weights_time_ms": 124.586}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 721, "training_iteration": 32, "trial_id": "default", "date": "2024-08-30_16-41-15", "timestamp": 1725007275, "time_this_iter_s": 10.927813053131104, "time_total_s": 346.31657242774963, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 346.31657242774963, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 9.457142857142856, "ram_util_percent": 14.128571428571425, "gpu_util_percent0": 0.2778571428571429, "vram_util_percent0": 0.14718773251488096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.64406899534246, "policy_loss": -0.008506837845729883, "vf_loss": 6.651980044252129, "vf_explained_var": 0.360096509674544, "kl": 0.005957725524856341, "entropy": 0.4746855409875993, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -65.0, "episode_reward_min": -167.0, "episode_reward_mean": -102.91, "episode_len_mean": 103.91, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0, -88.0, -105.0, -114.0, -103.0, -92.0, -93.0, -100.0, -91.0, -114.0, -139.0, -89.0, -120.0, -100.0, -150.0, -115.0, -84.0, -104.0, -104.0, -93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0, -115.0, -86.0, -100.0, -113.0, -104.0, -85.0, -65.0, -81.0, -102.0, -94.0, -82.0, -83.0, -114.0, -114.0, -84.0, -120.0, -124.0, -107.0, -110.0, -93.0, -94.0, -111.0, -111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0], "episode_lengths": [107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111, 89, 106, 115, 104, 93, 94, 101, 92, 115, 140, 90, 121, 101, 151, 116, 85, 105, 105, 94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125, 116, 87, 101, 114, 105, 86, 66, 82, 103, 95, 83, 84, 115, 115, 85, 121, 125, 108, 111, 94, 95, 112, 112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.665172569137635, "mean_inference_ms": 2.435155756825368, "mean_action_processing_ms": 0.2645035071431285, "mean_env_wait_ms": 0.393597724082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017147541046142578, "StateBufferConnector_ms": 0.011043548583984375, "ViewRequirementAgentConnector_ms": 0.25578927993774414}}, "episode_reward_max": -65.0, "episode_reward_min": -167.0, "episode_reward_mean": -102.91, "episode_len_mean": 103.91, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.0, -134.0, -97.0, -107.0, -118.0, -152.0, -104.0, -86.0, -85.0, -111.0, -128.0, -105.0, -81.0, -91.0, -131.0, -97.0, -110.0, -95.0, -110.0, -88.0, -105.0, -114.0, -103.0, -92.0, -93.0, -100.0, -91.0, -114.0, -139.0, -89.0, -120.0, -100.0, -150.0, -115.0, -84.0, -104.0, -104.0, -93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0, -115.0, -86.0, -100.0, -113.0, -104.0, -85.0, -65.0, -81.0, -102.0, -94.0, -82.0, -83.0, -114.0, -114.0, -84.0, -120.0, -124.0, -107.0, -110.0, -93.0, -94.0, -111.0, -111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0], "episode_lengths": [107, 135, 98, 108, 119, 153, 105, 87, 86, 112, 129, 106, 82, 92, 132, 98, 111, 96, 111, 89, 106, 115, 104, 93, 94, 101, 92, 115, 140, 90, 121, 101, 151, 116, 85, 105, 105, 94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125, 116, 87, 101, 114, 105, 86, 66, 82, 103, 95, 83, 84, 115, 115, 85, 121, 125, 108, 111, 94, 95, 112, 112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.665172569137635, "mean_inference_ms": 2.435155756825368, "mean_action_processing_ms": 0.2645035071431285, "mean_env_wait_ms": 0.393597724082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017147541046142578, "StateBufferConnector_ms": 0.011043548583984375, "ViewRequirementAgentConnector_ms": 0.25578927993774414}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.7170484911288, "num_env_steps_trained_throughput_per_sec": 383.7170484911288, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10337.459, "sample_time_ms": 236.154, "load_time_ms": 1.445, "load_throughput": 2768380.443, "learn_time_ms": 9972.184, "learn_throughput": 401.116, "synch_weights_time_ms": 126.747}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 763, "training_iteration": 33, "trial_id": "default", "date": "2024-08-30_16-41-26", "timestamp": 1725007286, "time_this_iter_s": 10.941090106964111, "time_total_s": 357.25766253471375, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 357.25766253471375, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 7.807142857142858, "ram_util_percent": 14.107142857142856, "gpu_util_percent0": 0.2364285714285714, "vram_util_percent0": 0.14697846912202378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.925997885901441, "policy_loss": -0.014558850340945746, "vf_loss": 5.939797589471263, "vf_explained_var": 0.22378702753333635, "kl": 0.007591384367043902, "entropy": 0.44437233212814536, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -65.0, "episode_reward_min": -167.0, "episode_reward_mean": -98.09, "episode_len_mean": 99.09, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0, -115.0, -86.0, -100.0, -113.0, -104.0, -85.0, -65.0, -81.0, -102.0, -94.0, -82.0, -83.0, -114.0, -114.0, -84.0, -120.0, -124.0, -107.0, -110.0, -93.0, -94.0, -111.0, -111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0, -86.0, -77.0, -146.0, -103.0, -84.0, -82.0, -84.0, -94.0, -86.0, -90.0, -82.0, -112.0, -81.0, -86.0, -76.0, -125.0, -83.0, -75.0, -100.0, -91.0, -108.0, -115.0, -94.0, -77.0, -147.0, -100.0, -83.0, -84.0, -72.0, -98.0, -93.0, -69.0, -83.0, -109.0, -114.0, -80.0, -102.0], "episode_lengths": [94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125, 116, 87, 101, 114, 105, 86, 66, 82, 103, 95, 83, 84, 115, 115, 85, 121, 125, 108, 111, 94, 95, 112, 112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96, 87, 78, 147, 104, 85, 83, 85, 95, 87, 91, 83, 113, 82, 87, 77, 126, 84, 76, 101, 92, 109, 116, 95, 78, 148, 101, 84, 85, 73, 99, 94, 70, 84, 110, 115, 81, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6639453766617439, "mean_inference_ms": 2.421210500785149, "mean_action_processing_ms": 0.26315143241500666, "mean_env_wait_ms": 0.39074347320737457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017008543014526367, "StateBufferConnector_ms": 0.011353492736816406, "ViewRequirementAgentConnector_ms": 0.2643163204193115}}, "episode_reward_max": -65.0, "episode_reward_min": -167.0, "episode_reward_mean": -98.09, "episode_len_mean": 99.09, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.0, -167.0, -118.0, -107.0, -111.0, -117.0, -122.0, -120.0, -108.0, -114.0, -80.0, -105.0, -100.0, -90.0, -113.0, -89.0, -87.0, -107.0, -103.0, -100.0, -124.0, -115.0, -86.0, -100.0, -113.0, -104.0, -85.0, -65.0, -81.0, -102.0, -94.0, -82.0, -83.0, -114.0, -114.0, -84.0, -120.0, -124.0, -107.0, -110.0, -93.0, -94.0, -111.0, -111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0, -86.0, -77.0, -146.0, -103.0, -84.0, -82.0, -84.0, -94.0, -86.0, -90.0, -82.0, -112.0, -81.0, -86.0, -76.0, -125.0, -83.0, -75.0, -100.0, -91.0, -108.0, -115.0, -94.0, -77.0, -147.0, -100.0, -83.0, -84.0, -72.0, -98.0, -93.0, -69.0, -83.0, -109.0, -114.0, -80.0, -102.0], "episode_lengths": [94, 168, 119, 108, 112, 118, 123, 121, 109, 115, 81, 106, 101, 91, 114, 90, 88, 108, 104, 101, 125, 116, 87, 101, 114, 105, 86, 66, 82, 103, 95, 83, 84, 115, 115, 85, 121, 125, 108, 111, 94, 95, 112, 112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96, 87, 78, 147, 104, 85, 83, 85, 95, 87, 91, 83, 113, 82, 87, 77, 126, 84, 76, 101, 92, 109, 116, 95, 78, 148, 101, 84, 85, 73, 99, 94, 70, 84, 110, 115, 81, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6639453766617439, "mean_inference_ms": 2.421210500785149, "mean_action_processing_ms": 0.26315143241500666, "mean_env_wait_ms": 0.39074347320737457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017008543014526367, "StateBufferConnector_ms": 0.011353492736816406, "ViewRequirementAgentConnector_ms": 0.2643163204193115}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.84216464414993, "num_env_steps_trained_throughput_per_sec": 392.84216464414993, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 10338.364, "sample_time_ms": 234.954, "load_time_ms": 1.454, "load_throughput": 2751897.123, "learn_time_ms": 9969.731, "learn_throughput": 401.214, "synch_weights_time_ms": 131.265}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 800, "training_iteration": 34, "trial_id": "default", "date": "2024-08-30_16-41-37", "timestamp": 1725007297, "time_this_iter_s": 10.701990842819214, "time_total_s": 367.95965337753296, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 367.95965337753296, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 7.971428571428571, "ram_util_percent": 14.107142857142856, "gpu_util_percent0": 0.21428571428571427, "vram_util_percent0": 0.14861769903273808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.698123458636704, "policy_loss": -0.021198252856891642, "vf_loss": 5.718573106745238, "vf_explained_var": 0.27349273556022236, "kl": 0.007486080069374825, "entropy": 0.4372082454222505, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -157.0, "episode_reward_mean": -95.03, "episode_len_mean": 96.03, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0, -86.0, -77.0, -146.0, -103.0, -84.0, -82.0, -84.0, -94.0, -86.0, -90.0, -82.0, -112.0, -81.0, -86.0, -76.0, -125.0, -83.0, -75.0, -100.0, -91.0, -108.0, -115.0, -94.0, -77.0, -147.0, -100.0, -83.0, -84.0, -72.0, -98.0, -93.0, -69.0, -83.0, -109.0, -114.0, -80.0, -102.0, -80.0, -92.0, -85.0, -102.0, -98.0, -102.0, -85.0, -86.0, -99.0, -157.0, -104.0, -102.0, -74.0, -106.0, -103.0, -109.0, -105.0, -127.0, -91.0, -75.0, -104.0, -110.0, -84.0, -112.0, -98.0, -83.0, -101.0, -62.0, -92.0, -125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0], "episode_lengths": [112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96, 87, 78, 147, 104, 85, 83, 85, 95, 87, 91, 83, 113, 82, 87, 77, 126, 84, 76, 101, 92, 109, 116, 95, 78, 148, 101, 84, 85, 73, 99, 94, 70, 84, 110, 115, 81, 103, 81, 93, 86, 103, 99, 103, 86, 87, 100, 158, 105, 103, 75, 107, 104, 110, 106, 128, 92, 76, 105, 111, 85, 113, 99, 84, 102, 63, 93, 126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6688506392471147, "mean_inference_ms": 2.4443480708214484, "mean_action_processing_ms": 0.26526292238593546, "mean_env_wait_ms": 0.39565303675555435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017790555953979492, "StateBufferConnector_ms": 0.011764049530029297, "ViewRequirementAgentConnector_ms": 0.27158641815185547}}, "episode_reward_max": -62.0, "episode_reward_min": -157.0, "episode_reward_mean": -95.03, "episode_len_mean": 96.03, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.0, -131.0, -91.0, -83.0, -92.0, -88.0, -81.0, -80.0, -126.0, -92.0, -107.0, -79.0, -85.0, -78.0, -84.0, -93.0, -91.0, -100.0, -95.0, -95.0, -86.0, -77.0, -146.0, -103.0, -84.0, -82.0, -84.0, -94.0, -86.0, -90.0, -82.0, -112.0, -81.0, -86.0, -76.0, -125.0, -83.0, -75.0, -100.0, -91.0, -108.0, -115.0, -94.0, -77.0, -147.0, -100.0, -83.0, -84.0, -72.0, -98.0, -93.0, -69.0, -83.0, -109.0, -114.0, -80.0, -102.0, -80.0, -92.0, -85.0, -102.0, -98.0, -102.0, -85.0, -86.0, -99.0, -157.0, -104.0, -102.0, -74.0, -106.0, -103.0, -109.0, -105.0, -127.0, -91.0, -75.0, -104.0, -110.0, -84.0, -112.0, -98.0, -83.0, -101.0, -62.0, -92.0, -125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0], "episode_lengths": [112, 132, 92, 84, 93, 89, 82, 81, 127, 93, 108, 80, 86, 79, 85, 94, 92, 101, 96, 96, 87, 78, 147, 104, 85, 83, 85, 95, 87, 91, 83, 113, 82, 87, 77, 126, 84, 76, 101, 92, 109, 116, 95, 78, 148, 101, 84, 85, 73, 99, 94, 70, 84, 110, 115, 81, 103, 81, 93, 86, 103, 99, 103, 86, 87, 100, 158, 105, 103, 75, 107, 104, 110, 106, 128, 92, 76, 105, 111, 85, 113, 99, 84, 102, 63, 93, 126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6688506392471147, "mean_inference_ms": 2.4443480708214484, "mean_action_processing_ms": 0.26526292238593546, "mean_env_wait_ms": 0.39565303675555435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017790555953979492, "StateBufferConnector_ms": 0.011764049530029297, "ViewRequirementAgentConnector_ms": 0.27158641815185547}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.4400179839898, "num_env_steps_trained_throughput_per_sec": 393.4400179839898, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 10318.346, "sample_time_ms": 236.667, "load_time_ms": 1.467, "load_throughput": 2726583.891, "learn_time_ms": 9949.493, "learn_throughput": 402.031, "synch_weights_time_ms": 129.7}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 843, "training_iteration": 35, "trial_id": "default", "date": "2024-08-30_16-41-48", "timestamp": 1725007308, "time_this_iter_s": 10.72715425491333, "time_total_s": 378.6868076324463, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 378.6868076324463, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.328571428571427, "ram_util_percent": 14.107142857142856, "gpu_util_percent0": 0.20928571428571427, "vram_util_percent0": 0.14798700241815474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.073988925897947, "policy_loss": -0.014741908352301325, "vf_loss": 5.088048648577865, "vf_explained_var": 0.23890006189705223, "kl": 0.0068216554720160645, "entropy": 0.41247033592193355, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -157.0, "episode_reward_mean": -94.06, "episode_len_mean": 95.06, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.0, -109.0, -114.0, -80.0, -102.0, -80.0, -92.0, -85.0, -102.0, -98.0, -102.0, -85.0, -86.0, -99.0, -157.0, -104.0, -102.0, -74.0, -106.0, -103.0, -109.0, -105.0, -127.0, -91.0, -75.0, -104.0, -110.0, -84.0, -112.0, -98.0, -83.0, -101.0, -62.0, -92.0, -125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0, -79.0, -78.0, -89.0, -76.0, -76.0, -82.0, -75.0, -82.0, -98.0, -109.0, -88.0, -115.0, -81.0, -93.0, -125.0, -79.0, -124.0, -113.0, -87.0, -102.0, -115.0, -98.0, -74.0, -83.0, -95.0, -102.0, -84.0, -101.0, -121.0, -83.0, -96.0, -80.0, -63.0, -116.0, -80.0, -79.0, -111.0, -70.0, -104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0], "episode_lengths": [84, 110, 115, 81, 103, 81, 93, 86, 103, 99, 103, 86, 87, 100, 158, 105, 103, 75, 107, 104, 110, 106, 128, 92, 76, 105, 111, 85, 113, 99, 84, 102, 63, 93, 126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119, 80, 79, 90, 77, 77, 83, 76, 83, 99, 110, 89, 116, 82, 94, 126, 80, 125, 114, 88, 103, 116, 99, 75, 84, 96, 103, 85, 102, 122, 84, 97, 81, 64, 117, 81, 80, 112, 71, 105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6679784080988191, "mean_inference_ms": 2.434193486426707, "mean_action_processing_ms": 0.2640884375260928, "mean_env_wait_ms": 0.39317598394932046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01804327964782715, "StateBufferConnector_ms": 0.01148843765258789, "ViewRequirementAgentConnector_ms": 0.2653827667236328}}, "episode_reward_max": -62.0, "episode_reward_min": -157.0, "episode_reward_mean": -94.06, "episode_len_mean": 95.06, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83.0, -109.0, -114.0, -80.0, -102.0, -80.0, -92.0, -85.0, -102.0, -98.0, -102.0, -85.0, -86.0, -99.0, -157.0, -104.0, -102.0, -74.0, -106.0, -103.0, -109.0, -105.0, -127.0, -91.0, -75.0, -104.0, -110.0, -84.0, -112.0, -98.0, -83.0, -101.0, -62.0, -92.0, -125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0, -79.0, -78.0, -89.0, -76.0, -76.0, -82.0, -75.0, -82.0, -98.0, -109.0, -88.0, -115.0, -81.0, -93.0, -125.0, -79.0, -124.0, -113.0, -87.0, -102.0, -115.0, -98.0, -74.0, -83.0, -95.0, -102.0, -84.0, -101.0, -121.0, -83.0, -96.0, -80.0, -63.0, -116.0, -80.0, -79.0, -111.0, -70.0, -104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0], "episode_lengths": [84, 110, 115, 81, 103, 81, 93, 86, 103, 99, 103, 86, 87, 100, 158, 105, 103, 75, 107, 104, 110, 106, 128, 92, 76, 105, 111, 85, 113, 99, 84, 102, 63, 93, 126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119, 80, 79, 90, 77, 77, 83, 76, 83, 99, 110, 89, 116, 82, 94, 126, 80, 125, 114, 88, 103, 116, 99, 75, 84, 96, 103, 85, 102, 122, 84, 97, 81, 64, 117, 81, 80, 112, 71, 105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6679784080988191, "mean_inference_ms": 2.434193486426707, "mean_action_processing_ms": 0.2640884375260928, "mean_env_wait_ms": 0.39317598394932046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01804327964782715, "StateBufferConnector_ms": 0.01148843765258789, "ViewRequirementAgentConnector_ms": 0.2653827667236328}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.9695779736851, "num_env_steps_trained_throughput_per_sec": 385.9695779736851, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10327.423, "sample_time_ms": 238.77, "load_time_ms": 1.527, "load_throughput": 2620211.776, "learn_time_ms": 9952.784, "learn_throughput": 401.898, "synch_weights_time_ms": 133.284}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 895, "training_iteration": 36, "trial_id": "default", "date": "2024-08-30_16-41-59", "timestamp": 1725007319, "time_this_iter_s": 10.88071870803833, "time_total_s": 389.5675263404846, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 389.5675263404846, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.935714285714285, "ram_util_percent": 14.171428571428567, "gpu_util_percent0": 0.2307142857142857, "vram_util_percent0": 0.15170724051339285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0909926291435, "policy_loss": -0.011056468886153031, "vf_loss": 5.101565047874246, "vf_explained_var": 0.4333742836470245, "kl": 0.004840416093073693, "entropy": 0.3736445007465219, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -179.0, "episode_reward_mean": -92.94, "episode_len_mean": 93.94, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0, -79.0, -78.0, -89.0, -76.0, -76.0, -82.0, -75.0, -82.0, -98.0, -109.0, -88.0, -115.0, -81.0, -93.0, -125.0, -79.0, -124.0, -113.0, -87.0, -102.0, -115.0, -98.0, -74.0, -83.0, -95.0, -102.0, -84.0, -101.0, -121.0, -83.0, -96.0, -80.0, -63.0, -116.0, -80.0, -79.0, -111.0, -70.0, -104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0, -83.0, -81.0, -87.0, -128.0, -99.0, -99.0, -179.0, -94.0, -63.0, -107.0, -102.0, -79.0, -91.0, -65.0, -101.0, -103.0, -84.0, -83.0, -100.0, -99.0, -101.0, -82.0, -97.0, -81.0, -78.0, -90.0, -92.0, -86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0], "episode_lengths": [126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119, 80, 79, 90, 77, 77, 83, 76, 83, 99, 110, 89, 116, 82, 94, 126, 80, 125, 114, 88, 103, 116, 99, 75, 84, 96, 103, 85, 102, 122, 84, 97, 81, 64, 117, 81, 80, 112, 71, 105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97, 84, 82, 88, 129, 100, 100, 180, 95, 64, 108, 103, 80, 92, 66, 102, 104, 85, 84, 101, 100, 102, 83, 98, 82, 79, 91, 93, 87, 111, 94, 107, 83, 94, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6632261579684847, "mean_inference_ms": 2.410767755499964, "mean_action_processing_ms": 0.26180375519212556, "mean_env_wait_ms": 0.38819553208108504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01723933219909668, "StateBufferConnector_ms": 0.01162576675415039, "ViewRequirementAgentConnector_ms": 0.26615357398986816}}, "episode_reward_max": -63.0, "episode_reward_min": -179.0, "episode_reward_mean": -92.94, "episode_len_mean": 93.94, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-125.0, -84.0, -81.0, -106.0, -94.0, -86.0, -92.0, -122.0, -67.0, -94.0, -84.0, -102.0, -67.0, -118.0, -79.0, -78.0, -89.0, -76.0, -76.0, -82.0, -75.0, -82.0, -98.0, -109.0, -88.0, -115.0, -81.0, -93.0, -125.0, -79.0, -124.0, -113.0, -87.0, -102.0, -115.0, -98.0, -74.0, -83.0, -95.0, -102.0, -84.0, -101.0, -121.0, -83.0, -96.0, -80.0, -63.0, -116.0, -80.0, -79.0, -111.0, -70.0, -104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0, -83.0, -81.0, -87.0, -128.0, -99.0, -99.0, -179.0, -94.0, -63.0, -107.0, -102.0, -79.0, -91.0, -65.0, -101.0, -103.0, -84.0, -83.0, -100.0, -99.0, -101.0, -82.0, -97.0, -81.0, -78.0, -90.0, -92.0, -86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0], "episode_lengths": [126, 85, 82, 107, 95, 87, 93, 123, 68, 95, 85, 103, 68, 119, 80, 79, 90, 77, 77, 83, 76, 83, 99, 110, 89, 116, 82, 94, 126, 80, 125, 114, 88, 103, 116, 99, 75, 84, 96, 103, 85, 102, 122, 84, 97, 81, 64, 117, 81, 80, 112, 71, 105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97, 84, 82, 88, 129, 100, 100, 180, 95, 64, 108, 103, 80, 92, 66, 102, 104, 85, 84, 101, 100, 102, 83, 98, 82, 79, 91, 93, 87, 111, 94, 107, 83, 94, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6632261579684847, "mean_inference_ms": 2.410767755499964, "mean_action_processing_ms": 0.26180375519212556, "mean_env_wait_ms": 0.38819553208108504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01723933219909668, "StateBufferConnector_ms": 0.01162576675415039, "ViewRequirementAgentConnector_ms": 0.26615357398986816}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.6583189450929, "num_env_steps_trained_throughput_per_sec": 383.6583189450929, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10334.007, "sample_time_ms": 235.393, "load_time_ms": 1.486, "load_throughput": 2692323.839, "learn_time_ms": 9964.748, "learn_throughput": 401.415, "synch_weights_time_ms": 131.365}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 929, "training_iteration": 37, "trial_id": "default", "date": "2024-08-30_16-42-10", "timestamp": 1725007330, "time_this_iter_s": 10.986319541931152, "time_total_s": 400.55384588241577, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 400.55384588241577, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.114285714285716, "ram_util_percent": 14.049999999999999, "gpu_util_percent0": 0.3057142857142857, "vram_util_percent0": 0.16042364211309526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.15053417387829, "policy_loss": -0.01435486638558007, "vf_loss": 5.1646719405728, "vf_explained_var": 0.34871380194540946, "kl": 0.004341779655626079, "entropy": 0.3821538595743077, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -179.0, "episode_reward_mean": -92.02, "episode_len_mean": 93.02, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0, -83.0, -81.0, -87.0, -128.0, -99.0, -99.0, -179.0, -94.0, -63.0, -107.0, -102.0, -79.0, -91.0, -65.0, -101.0, -103.0, -84.0, -83.0, -100.0, -99.0, -101.0, -82.0, -97.0, -81.0, -78.0, -90.0, -92.0, -86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0, -72.0, -105.0, -79.0, -83.0, -96.0, -101.0, -83.0, -85.0, -92.0, -96.0, -74.0, -79.0, -64.0, -79.0, -98.0, -82.0, -75.0, -104.0, -80.0, -91.0, -91.0, -77.0, -161.0, -103.0, -99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0], "episode_lengths": [105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97, 84, 82, 88, 129, 100, 100, 180, 95, 64, 108, 103, 80, 92, 66, 102, 104, 85, 84, 101, 100, 102, 83, 98, 82, 79, 91, 93, 87, 111, 94, 107, 83, 94, 87, 73, 106, 80, 84, 97, 102, 84, 86, 93, 97, 75, 80, 65, 80, 99, 83, 76, 105, 81, 92, 92, 78, 162, 104, 100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6678664109282285, "mean_inference_ms": 2.440693673409844, "mean_action_processing_ms": 0.2643365336149833, "mean_env_wait_ms": 0.3947701565967821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724076271057129, "StateBufferConnector_ms": 0.012069225311279297, "ViewRequirementAgentConnector_ms": 0.2732508182525635}}, "episode_reward_max": -63.0, "episode_reward_min": -179.0, "episode_reward_mean": -92.02, "episode_len_mean": 93.02, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.0, -83.0, -87.0, -86.0, -82.0, -77.0, -104.0, -82.0, -81.0, -85.0, -86.0, -111.0, -102.0, -96.0, -83.0, -81.0, -87.0, -128.0, -99.0, -99.0, -179.0, -94.0, -63.0, -107.0, -102.0, -79.0, -91.0, -65.0, -101.0, -103.0, -84.0, -83.0, -100.0, -99.0, -101.0, -82.0, -97.0, -81.0, -78.0, -90.0, -92.0, -86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0, -72.0, -105.0, -79.0, -83.0, -96.0, -101.0, -83.0, -85.0, -92.0, -96.0, -74.0, -79.0, -64.0, -79.0, -98.0, -82.0, -75.0, -104.0, -80.0, -91.0, -91.0, -77.0, -161.0, -103.0, -99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0], "episode_lengths": [105, 84, 88, 87, 83, 78, 105, 83, 82, 86, 87, 112, 103, 97, 84, 82, 88, 129, 100, 100, 180, 95, 64, 108, 103, 80, 92, 66, 102, 104, 85, 84, 101, 100, 102, 83, 98, 82, 79, 91, 93, 87, 111, 94, 107, 83, 94, 87, 73, 106, 80, 84, 97, 102, 84, 86, 93, 97, 75, 80, 65, 80, 99, 83, 76, 105, 81, 92, 92, 78, 162, 104, 100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6678664109282285, "mean_inference_ms": 2.440693673409844, "mean_action_processing_ms": 0.2643365336149833, "mean_env_wait_ms": 0.3947701565967821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724076271057129, "StateBufferConnector_ms": 0.012069225311279297, "ViewRequirementAgentConnector_ms": 0.2732508182525635}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.508607328763, "num_env_steps_trained_throughput_per_sec": 384.508607328763, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 10354.626, "sample_time_ms": 232.972, "load_time_ms": 1.48, "load_throughput": 2703168.614, "learn_time_ms": 9989.342, "learn_throughput": 400.427, "synch_weights_time_ms": 129.826}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 981, "training_iteration": 38, "trial_id": "default", "date": "2024-08-30_16-42-21", "timestamp": 1725007341, "time_this_iter_s": 10.962726593017578, "time_total_s": 411.51657247543335, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 411.51657247543335, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 12.140000000000002, "ram_util_percent": 14.066666666666665, "gpu_util_percent0": 0.2906666666666667, "vram_util_percent0": 0.1637668185763889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3592261155446375, "policy_loss": -0.013506302377709778, "vf_loss": 4.372530198417684, "vf_explained_var": 0.5409424865758548, "kl": 0.008088737669498197, "entropy": 0.35350923685617347, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -170.0, "episode_reward_mean": -89.92, "episode_len_mean": 90.92, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0, -72.0, -105.0, -79.0, -83.0, -96.0, -101.0, -83.0, -85.0, -92.0, -96.0, -74.0, -79.0, -64.0, -79.0, -98.0, -82.0, -75.0, -104.0, -80.0, -91.0, -91.0, -77.0, -161.0, -103.0, -99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0, -106.0, -93.0, -83.0, -78.0, -97.0, -88.0, -99.0, -88.0, -85.0, -76.0, -96.0, -75.0, -93.0, -102.0, -88.0, -93.0, -73.0, -100.0, -63.0, -76.0, -62.0, -78.0, -92.0, -85.0, -92.0, -118.0, -92.0, -98.0, -74.0, -79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0], "episode_lengths": [87, 111, 94, 107, 83, 94, 87, 73, 106, 80, 84, 97, 102, 84, 86, 93, 97, 75, 80, 65, 80, 99, 83, 76, 105, 81, 92, 92, 78, 162, 104, 100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80, 107, 94, 84, 79, 98, 89, 100, 89, 86, 77, 97, 76, 94, 103, 89, 94, 74, 101, 64, 77, 63, 79, 93, 86, 93, 119, 93, 99, 75, 80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.665745854900546, "mean_inference_ms": 2.422250005589816, "mean_action_processing_ms": 0.2628987878837994, "mean_env_wait_ms": 0.3913085452719678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01775979995727539, "StateBufferConnector_ms": 0.01230621337890625, "ViewRequirementAgentConnector_ms": 0.27586817741394043}}, "episode_reward_max": -62.0, "episode_reward_min": -170.0, "episode_reward_mean": -89.92, "episode_len_mean": 90.92, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.0, -110.0, -93.0, -106.0, -82.0, -93.0, -86.0, -72.0, -105.0, -79.0, -83.0, -96.0, -101.0, -83.0, -85.0, -92.0, -96.0, -74.0, -79.0, -64.0, -79.0, -98.0, -82.0, -75.0, -104.0, -80.0, -91.0, -91.0, -77.0, -161.0, -103.0, -99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0, -106.0, -93.0, -83.0, -78.0, -97.0, -88.0, -99.0, -88.0, -85.0, -76.0, -96.0, -75.0, -93.0, -102.0, -88.0, -93.0, -73.0, -100.0, -63.0, -76.0, -62.0, -78.0, -92.0, -85.0, -92.0, -118.0, -92.0, -98.0, -74.0, -79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0], "episode_lengths": [87, 111, 94, 107, 83, 94, 87, 73, 106, 80, 84, 97, 102, 84, 86, 93, 97, 75, 80, 65, 80, 99, 83, 76, 105, 81, 92, 92, 78, 162, 104, 100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80, 107, 94, 84, 79, 98, 89, 100, 89, 86, 77, 97, 76, 94, 103, 89, 94, 74, 101, 64, 77, 63, 79, 93, 86, 93, 119, 93, 99, 75, 80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.665745854900546, "mean_inference_ms": 2.422250005589816, "mean_action_processing_ms": 0.2628987878837994, "mean_env_wait_ms": 0.3913085452719678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01775979995727539, "StateBufferConnector_ms": 0.01230621337890625, "ViewRequirementAgentConnector_ms": 0.27586817741394043}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.23027646954824, "num_env_steps_trained_throughput_per_sec": 383.23027646954824, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10355.628, "sample_time_ms": 229.741, "load_time_ms": 1.471, "load_throughput": 2719909.213, "learn_time_ms": 9995.071, "learn_throughput": 400.197, "synch_weights_time_ms": 128.333}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1022, "training_iteration": 39, "trial_id": "default", "date": "2024-08-30_16-42-32", "timestamp": 1725007352, "time_this_iter_s": 10.985298156738281, "time_total_s": 422.50187063217163, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 422.50187063217163, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 9.057142857142857, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.2714285714285714, "vram_util_percent0": 0.16340273902529762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.888416159152984, "policy_loss": -0.00023064422871797315, "vf_loss": 4.888491431102958, "vf_explained_var": 0.3393810196589398, "kl": 0.006214992350711542, "entropy": 0.34886500726463976, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -170.0, "episode_reward_mean": -91.21, "episode_len_mean": 92.21, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0, -106.0, -93.0, -83.0, -78.0, -97.0, -88.0, -99.0, -88.0, -85.0, -76.0, -96.0, -75.0, -93.0, -102.0, -88.0, -93.0, -73.0, -100.0, -63.0, -76.0, -62.0, -78.0, -92.0, -85.0, -92.0, -118.0, -92.0, -98.0, -74.0, -79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0, -106.0, -78.0, -131.0, -88.0, -95.0, -134.0, -76.0, -97.0, -103.0, -82.0, -92.0, -90.0, -74.0, -78.0, -100.0, -84.0, -150.0, -69.0, -105.0, -119.0, -95.0, -82.0, -91.0, -73.0, -87.0, -75.0, -81.0, -107.0, -126.0, -83.0, -84.0], "episode_lengths": [100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80, 107, 94, 84, 79, 98, 89, 100, 89, 86, 77, 97, 76, 94, 103, 89, 94, 74, 101, 64, 77, 63, 79, 93, 86, 93, 119, 93, 99, 75, 80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94, 107, 79, 132, 89, 96, 135, 77, 98, 104, 83, 93, 91, 75, 79, 101, 85, 151, 70, 106, 120, 96, 83, 92, 74, 88, 76, 82, 108, 127, 84, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.668167050737483, "mean_inference_ms": 2.4328859274094348, "mean_action_processing_ms": 0.2639136008733774, "mean_env_wait_ms": 0.393150832102335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728987693786621, "StateBufferConnector_ms": 0.012509346008300781, "ViewRequirementAgentConnector_ms": 0.282228946685791}}, "episode_reward_max": -62.0, "episode_reward_min": -170.0, "episode_reward_mean": -91.21, "episode_len_mean": 92.21, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.0, -72.0, -82.0, -106.0, -100.0, -129.0, -87.0, -79.0, -86.0, -81.0, -99.0, -120.0, -94.0, -75.0, -91.0, -80.0, -79.0, -85.0, -75.0, -95.0, -115.0, -170.0, -87.0, -73.0, -79.0, -77.0, -88.0, -79.0, -106.0, -93.0, -83.0, -78.0, -97.0, -88.0, -99.0, -88.0, -85.0, -76.0, -96.0, -75.0, -93.0, -102.0, -88.0, -93.0, -73.0, -100.0, -63.0, -76.0, -62.0, -78.0, -92.0, -85.0, -92.0, -118.0, -92.0, -98.0, -74.0, -79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0, -106.0, -78.0, -131.0, -88.0, -95.0, -134.0, -76.0, -97.0, -103.0, -82.0, -92.0, -90.0, -74.0, -78.0, -100.0, -84.0, -150.0, -69.0, -105.0, -119.0, -95.0, -82.0, -91.0, -73.0, -87.0, -75.0, -81.0, -107.0, -126.0, -83.0, -84.0], "episode_lengths": [100, 73, 83, 107, 101, 130, 88, 80, 87, 82, 100, 121, 95, 76, 92, 81, 80, 86, 76, 96, 116, 171, 88, 74, 80, 78, 89, 80, 107, 94, 84, 79, 98, 89, 100, 89, 86, 77, 97, 76, 94, 103, 89, 94, 74, 101, 64, 77, 63, 79, 93, 86, 93, 119, 93, 99, 75, 80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94, 107, 79, 132, 89, 96, 135, 77, 98, 104, 83, 93, 91, 75, 79, 101, 85, 151, 70, 106, 120, 96, 83, 92, 74, 88, 76, 82, 108, 127, 84, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.668167050737483, "mean_inference_ms": 2.4328859274094348, "mean_action_processing_ms": 0.2639136008733774, "mean_env_wait_ms": 0.393150832102335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728987693786621, "StateBufferConnector_ms": 0.012509346008300781, "ViewRequirementAgentConnector_ms": 0.282228946685791}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.0917487325071, "num_env_steps_trained_throughput_per_sec": 388.0917487325071, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10352.441, "sample_time_ms": 226.448, "load_time_ms": 1.465, "load_throughput": 2729866.901, "learn_time_ms": 9996.835, "learn_throughput": 400.127, "synch_weights_time_ms": 126.688}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1053, "training_iteration": 40, "trial_id": "default", "date": "2024-08-30_16-42-43", "timestamp": 1725007363, "time_this_iter_s": 10.85985016822815, "time_total_s": 433.3617208003998, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 433.3617208003998, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.042857142857143, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.26999999999999996, "vram_util_percent0": 0.16463216145833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.157611104237136, "policy_loss": -0.015040651071936853, "vf_loss": 5.172495058595493, "vf_explained_var": 0.34756764147871283, "kl": 0.006268073282873017, "entropy": 0.35215519955081326, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -150.0, "episode_reward_mean": -91.36, "episode_len_mean": 92.36, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0, -106.0, -78.0, -131.0, -88.0, -95.0, -134.0, -76.0, -97.0, -103.0, -82.0, -92.0, -90.0, -74.0, -78.0, -100.0, -84.0, -150.0, -69.0, -105.0, -119.0, -95.0, -82.0, -91.0, -73.0, -87.0, -75.0, -81.0, -107.0, -126.0, -83.0, -84.0, -78.0, -89.0, -79.0, -113.0, -119.0, -62.0, -82.0, -127.0, -97.0, -100.0, -78.0, -78.0, -98.0, -75.0, -78.0, -84.0, -100.0, -104.0, -82.0, -105.0, -91.0, -84.0, -86.0, -102.0, -94.0, -102.0, -82.0, -80.0, -78.0, -96.0, -83.0, -81.0, -74.0, -74.0, -103.0, -90.0, -81.0, -75.0, -80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0], "episode_lengths": [80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94, 107, 79, 132, 89, 96, 135, 77, 98, 104, 83, 93, 91, 75, 79, 101, 85, 151, 70, 106, 120, 96, 83, 92, 74, 88, 76, 82, 108, 127, 84, 85, 79, 90, 80, 114, 120, 63, 83, 128, 98, 101, 79, 79, 99, 76, 79, 85, 101, 105, 83, 106, 92, 85, 87, 103, 95, 103, 83, 81, 79, 97, 84, 82, 75, 75, 104, 91, 82, 76, 81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6663881577259094, "mean_inference_ms": 2.426128758079642, "mean_action_processing_ms": 0.26263908192677626, "mean_env_wait_ms": 0.39238059405430137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01690673828125, "StateBufferConnector_ms": 0.011920928955078125, "ViewRequirementAgentConnector_ms": 0.2773573398590088}}, "episode_reward_max": -62.0, "episode_reward_min": -150.0, "episode_reward_mean": -91.36, "episode_len_mean": 92.36, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.0, -95.0, -96.0, -88.0, -76.0, -77.0, -80.0, -75.0, -106.0, -124.0, -72.0, -93.0, -106.0, -78.0, -131.0, -88.0, -95.0, -134.0, -76.0, -97.0, -103.0, -82.0, -92.0, -90.0, -74.0, -78.0, -100.0, -84.0, -150.0, -69.0, -105.0, -119.0, -95.0, -82.0, -91.0, -73.0, -87.0, -75.0, -81.0, -107.0, -126.0, -83.0, -84.0, -78.0, -89.0, -79.0, -113.0, -119.0, -62.0, -82.0, -127.0, -97.0, -100.0, -78.0, -78.0, -98.0, -75.0, -78.0, -84.0, -100.0, -104.0, -82.0, -105.0, -91.0, -84.0, -86.0, -102.0, -94.0, -102.0, -82.0, -80.0, -78.0, -96.0, -83.0, -81.0, -74.0, -74.0, -103.0, -90.0, -81.0, -75.0, -80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0], "episode_lengths": [80, 96, 97, 89, 77, 78, 81, 76, 107, 125, 73, 94, 107, 79, 132, 89, 96, 135, 77, 98, 104, 83, 93, 91, 75, 79, 101, 85, 151, 70, 106, 120, 96, 83, 92, 74, 88, 76, 82, 108, 127, 84, 85, 79, 90, 80, 114, 120, 63, 83, 128, 98, 101, 79, 79, 99, 76, 79, 85, 101, 105, 83, 106, 92, 85, 87, 103, 95, 103, 83, 81, 79, 97, 84, 82, 75, 75, 104, 91, 82, 76, 81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6663881577259094, "mean_inference_ms": 2.426128758079642, "mean_action_processing_ms": 0.26263908192677626, "mean_env_wait_ms": 0.39238059405430137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01690673828125, "StateBufferConnector_ms": 0.011920928955078125, "ViewRequirementAgentConnector_ms": 0.2773573398590088}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.46940117014435, "num_env_steps_trained_throughput_per_sec": 380.46940117014435, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 10359.362, "sample_time_ms": 225.149, "load_time_ms": 1.457, "load_throughput": 2745187.924, "learn_time_ms": 10001.803, "learn_throughput": 399.928, "synch_weights_time_ms": 129.952}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1110, "training_iteration": 41, "trial_id": "default", "date": "2024-08-30_16-42-54", "timestamp": 1725007374, "time_this_iter_s": 11.032268762588501, "time_total_s": 444.3939895629883, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 444.3939895629883, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.37857142857143, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.25357142857142856, "vram_util_percent0": 0.16349865141369044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3184944966787935, "policy_loss": -0.014969675843754122, "vf_loss": 4.333294117002077, "vf_explained_var": 0.4515677074591319, "kl": 0.006802359046360512, "entropy": 0.3026663629117832, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -148.0, "episode_reward_mean": -90.6, "episode_len_mean": 91.6, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.0, -113.0, -119.0, -62.0, -82.0, -127.0, -97.0, -100.0, -78.0, -78.0, -98.0, -75.0, -78.0, -84.0, -100.0, -104.0, -82.0, -105.0, -91.0, -84.0, -86.0, -102.0, -94.0, -102.0, -82.0, -80.0, -78.0, -96.0, -83.0, -81.0, -74.0, -74.0, -103.0, -90.0, -81.0, -75.0, -80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0, -101.0, -87.0, -84.0, -89.0, -90.0, -76.0, -101.0, -97.0, -90.0, -89.0, -64.0, -103.0, -80.0, -82.0, -94.0, -76.0, -114.0, -148.0, -94.0, -93.0, -75.0, -85.0, -89.0, -98.0, -78.0, -97.0, -78.0, -112.0, -82.0, -101.0, -95.0, -84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0], "episode_lengths": [80, 114, 120, 63, 83, 128, 98, 101, 79, 79, 99, 76, 79, 85, 101, 105, 83, 106, 92, 85, 87, 103, 95, 103, 83, 81, 79, 97, 84, 82, 75, 75, 104, 91, 82, 76, 81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77, 102, 88, 85, 90, 91, 77, 102, 98, 91, 90, 65, 104, 81, 83, 95, 77, 115, 149, 95, 94, 76, 86, 90, 99, 79, 98, 79, 113, 83, 102, 96, 85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6749534906725497, "mean_inference_ms": 2.4591243386045623, "mean_action_processing_ms": 0.266392874844587, "mean_env_wait_ms": 0.3986188750799663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01686239242553711, "StateBufferConnector_ms": 0.01138448715209961, "ViewRequirementAgentConnector_ms": 0.26515793800354004}}, "episode_reward_max": -62.0, "episode_reward_min": -148.0, "episode_reward_mean": -90.6, "episode_len_mean": 91.6, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.0, -113.0, -119.0, -62.0, -82.0, -127.0, -97.0, -100.0, -78.0, -78.0, -98.0, -75.0, -78.0, -84.0, -100.0, -104.0, -82.0, -105.0, -91.0, -84.0, -86.0, -102.0, -94.0, -102.0, -82.0, -80.0, -78.0, -96.0, -83.0, -81.0, -74.0, -74.0, -103.0, -90.0, -81.0, -75.0, -80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0, -101.0, -87.0, -84.0, -89.0, -90.0, -76.0, -101.0, -97.0, -90.0, -89.0, -64.0, -103.0, -80.0, -82.0, -94.0, -76.0, -114.0, -148.0, -94.0, -93.0, -75.0, -85.0, -89.0, -98.0, -78.0, -97.0, -78.0, -112.0, -82.0, -101.0, -95.0, -84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0], "episode_lengths": [80, 114, 120, 63, 83, 128, 98, 101, 79, 79, 99, 76, 79, 85, 101, 105, 83, 106, 92, 85, 87, 103, 95, 103, 83, 81, 79, 97, 84, 82, 75, 75, 104, 91, 82, 76, 81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77, 102, 88, 85, 90, 91, 77, 102, 98, 91, 90, 65, 104, 81, 83, 95, 77, 115, 149, 95, 94, 76, 86, 90, 99, 79, 98, 79, 113, 83, 102, 96, 85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6749534906725497, "mean_inference_ms": 2.4591243386045623, "mean_action_processing_ms": 0.266392874844587, "mean_env_wait_ms": 0.3986188750799663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01686239242553711, "StateBufferConnector_ms": 0.01138448715209961, "ViewRequirementAgentConnector_ms": 0.26515793800354004}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.1128026580804, "num_env_steps_trained_throughput_per_sec": 384.1128026580804, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 10363.613, "sample_time_ms": 224.365, "load_time_ms": 1.47, "load_throughput": 2720173.809, "learn_time_ms": 10006.97, "learn_throughput": 399.721, "synch_weights_time_ms": 129.814}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 1155, "training_iteration": 42, "trial_id": "default", "date": "2024-08-30_16-43-05", "timestamp": 1725007385, "time_this_iter_s": 11.024972915649414, "time_total_s": 455.4189624786377, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 455.4189624786377, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.173333333333334, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.21266666666666667, "vram_util_percent0": 0.1637532552083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.811400370956749, "policy_loss": -0.01583048303721733, "vf_loss": 4.827100337705304, "vf_explained_var": 0.33594516893868803, "kl": 0.00522051442696798, "entropy": 0.32351652696248023, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -225.0, "episode_reward_mean": -90.39, "episode_len_mean": 91.39, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0, -101.0, -87.0, -84.0, -89.0, -90.0, -76.0, -101.0, -97.0, -90.0, -89.0, -64.0, -103.0, -80.0, -82.0, -94.0, -76.0, -114.0, -148.0, -94.0, -93.0, -75.0, -85.0, -89.0, -98.0, -78.0, -97.0, -78.0, -112.0, -82.0, -101.0, -95.0, -84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0, -122.0, -72.0, -64.0, -82.0, -99.0, -93.0, -76.0, -112.0, -61.0, -225.0, -75.0, -87.0, -79.0, -96.0, -76.0, -76.0, -62.0, -85.0, -89.0, -82.0, -82.0, -85.0, -85.0, -79.0, -62.0, -75.0, -143.0, -103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0], "episode_lengths": [81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77, 102, 88, 85, 90, 91, 77, 102, 98, 91, 90, 65, 104, 81, 83, 95, 77, 115, 149, 95, 94, 76, 86, 90, 99, 79, 98, 79, 113, 83, 102, 96, 85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118, 123, 73, 65, 83, 100, 94, 77, 113, 62, 226, 76, 88, 80, 97, 77, 77, 63, 86, 90, 83, 83, 86, 86, 80, 63, 76, 144, 104, 78, 80, 84, 84, 115, 64, 100, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6634011693492964, "mean_inference_ms": 2.407411830154354, "mean_action_processing_ms": 0.26131217432994003, "mean_env_wait_ms": 0.3884146027759503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015776872634887695, "StateBufferConnector_ms": 0.01115727424621582, "ViewRequirementAgentConnector_ms": 0.2580373287200928}}, "episode_reward_max": -61.0, "episode_reward_min": -225.0, "episode_reward_mean": -90.39, "episode_len_mean": 91.39, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.0, -107.0, -71.0, -108.0, -78.0, -110.0, -104.0, -95.0, -93.0, -83.0, -84.0, -77.0, -117.0, -101.0, -107.0, -126.0, -63.0, -76.0, -76.0, -101.0, -87.0, -84.0, -89.0, -90.0, -76.0, -101.0, -97.0, -90.0, -89.0, -64.0, -103.0, -80.0, -82.0, -94.0, -76.0, -114.0, -148.0, -94.0, -93.0, -75.0, -85.0, -89.0, -98.0, -78.0, -97.0, -78.0, -112.0, -82.0, -101.0, -95.0, -84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0, -122.0, -72.0, -64.0, -82.0, -99.0, -93.0, -76.0, -112.0, -61.0, -225.0, -75.0, -87.0, -79.0, -96.0, -76.0, -76.0, -62.0, -85.0, -89.0, -82.0, -82.0, -85.0, -85.0, -79.0, -62.0, -75.0, -143.0, -103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0], "episode_lengths": [81, 108, 72, 109, 79, 111, 105, 96, 94, 84, 85, 78, 118, 102, 108, 127, 64, 77, 77, 102, 88, 85, 90, 91, 77, 102, 98, 91, 90, 65, 104, 81, 83, 95, 77, 115, 149, 95, 94, 76, 86, 90, 99, 79, 98, 79, 113, 83, 102, 96, 85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118, 123, 73, 65, 83, 100, 94, 77, 113, 62, 226, 76, 88, 80, 97, 77, 77, 63, 86, 90, 83, 83, 86, 86, 80, 63, 76, 144, 104, 78, 80, 84, 84, 115, 64, 100, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6634011693492964, "mean_inference_ms": 2.407411830154354, "mean_action_processing_ms": 0.26131217432994003, "mean_env_wait_ms": 0.3884146027759503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015776872634887695, "StateBufferConnector_ms": 0.01115727424621582, "ViewRequirementAgentConnector_ms": 0.2580373287200928}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.68040631688945, "num_env_steps_trained_throughput_per_sec": 386.68040631688945, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 10355.626, "sample_time_ms": 223.892, "load_time_ms": 1.45, "load_throughput": 2759319.759, "learn_time_ms": 10004.86, "learn_throughput": 399.806, "synch_weights_time_ms": 124.436}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 1191, "training_iteration": 43, "trial_id": "default", "date": "2024-08-30_16-43-16", "timestamp": 1725007396, "time_this_iter_s": 10.901898384094238, "time_total_s": 466.32086086273193, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 466.32086086273193, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.535714285714286, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.2507142857142857, "vram_util_percent0": 0.16529192243303573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.524564830269865, "policy_loss": -0.02136785215347685, "vf_loss": 4.545783999882719, "vf_explained_var": 0.4999171981888433, "kl": 0.0059470899193735435, "entropy": 0.33054084700922814, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -225.0, "episode_reward_mean": -89.85, "episode_len_mean": 90.85, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0, -122.0, -72.0, -64.0, -82.0, -99.0, -93.0, -76.0, -112.0, -61.0, -225.0, -75.0, -87.0, -79.0, -96.0, -76.0, -76.0, -62.0, -85.0, -89.0, -82.0, -82.0, -85.0, -85.0, -79.0, -62.0, -75.0, -143.0, -103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0, -79.0, -77.0, -83.0, -123.0, -81.0, -95.0, -80.0, -78.0, -72.0, -92.0, -87.0, -81.0, -87.0, -77.0, -64.0, -79.0, -83.0, -93.0, -91.0, -112.0, -88.0, -75.0, -79.0, -102.0, -79.0, -94.0, -99.0, -163.0, -200.0, -87.0, -138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0], "episode_lengths": [85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118, 123, 73, 65, 83, 100, 94, 77, 113, 62, 226, 76, 88, 80, 97, 77, 77, 63, 86, 90, 83, 83, 86, 86, 80, 63, 76, 144, 104, 78, 80, 84, 84, 115, 64, 100, 72, 80, 78, 84, 124, 82, 96, 81, 79, 73, 93, 88, 82, 88, 78, 65, 80, 84, 94, 92, 113, 89, 76, 80, 103, 80, 95, 100, 164, 201, 88, 139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6644171975135162, "mean_inference_ms": 2.4051442178534184, "mean_action_processing_ms": 0.2610666984437851, "mean_env_wait_ms": 0.3877493727178335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01567244529724121, "StateBufferConnector_ms": 0.01191568374633789, "ViewRequirementAgentConnector_ms": 0.2731630802154541}}, "episode_reward_max": -61.0, "episode_reward_min": -225.0, "episode_reward_mean": -89.85, "episode_len_mean": 90.85, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.0, -81.0, -90.0, -89.0, -101.0, -93.0, -67.0, -84.0, -85.0, -81.0, -79.0, -99.0, -95.0, -117.0, -122.0, -72.0, -64.0, -82.0, -99.0, -93.0, -76.0, -112.0, -61.0, -225.0, -75.0, -87.0, -79.0, -96.0, -76.0, -76.0, -62.0, -85.0, -89.0, -82.0, -82.0, -85.0, -85.0, -79.0, -62.0, -75.0, -143.0, -103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0, -79.0, -77.0, -83.0, -123.0, -81.0, -95.0, -80.0, -78.0, -72.0, -92.0, -87.0, -81.0, -87.0, -77.0, -64.0, -79.0, -83.0, -93.0, -91.0, -112.0, -88.0, -75.0, -79.0, -102.0, -79.0, -94.0, -99.0, -163.0, -200.0, -87.0, -138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0], "episode_lengths": [85, 82, 91, 90, 102, 94, 68, 85, 86, 82, 80, 100, 96, 118, 123, 73, 65, 83, 100, 94, 77, 113, 62, 226, 76, 88, 80, 97, 77, 77, 63, 86, 90, 83, 83, 86, 86, 80, 63, 76, 144, 104, 78, 80, 84, 84, 115, 64, 100, 72, 80, 78, 84, 124, 82, 96, 81, 79, 73, 93, 88, 82, 88, 78, 65, 80, 84, 94, 92, 113, 89, 76, 80, 103, 80, 95, 100, 164, 201, 88, 139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6644171975135162, "mean_inference_ms": 2.4051442178534184, "mean_action_processing_ms": 0.2610666984437851, "mean_env_wait_ms": 0.3877493727178335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01567244529724121, "StateBufferConnector_ms": 0.01191568374633789, "ViewRequirementAgentConnector_ms": 0.2731630802154541}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.37131662547193, "num_env_steps_trained_throughput_per_sec": 388.37131662547193, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 10367.358, "sample_time_ms": 222.644, "load_time_ms": 1.528, "load_throughput": 2617391.223, "learn_time_ms": 10023.668, "learn_throughput": 399.056, "synch_weights_time_ms": 118.559}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 1241, "training_iteration": 44, "trial_id": "default", "date": "2024-08-30_16-43-27", "timestamp": 1725007407, "time_this_iter_s": 10.851667642593384, "time_total_s": 477.1725285053253, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 477.1725285053253, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 9.100000000000001, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.2507142857142857, "vram_util_percent0": 0.16358584449404762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.168595615894564, "policy_loss": -0.010787187188222844, "vf_loss": 4.179259781491372, "vf_explained_var": 0.44964434562190886, "kl": 0.0049211268406564755, "entropy": 0.2978167821963628, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -62.0, "episode_reward_min": -200.0, "episode_reward_mean": -88.97, "episode_len_mean": 89.97, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0, -79.0, -77.0, -83.0, -123.0, -81.0, -95.0, -80.0, -78.0, -72.0, -92.0, -87.0, -81.0, -87.0, -77.0, -64.0, -79.0, -83.0, -93.0, -91.0, -112.0, -88.0, -75.0, -79.0, -102.0, -79.0, -94.0, -99.0, -163.0, -200.0, -87.0, -138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0, -83.0, -63.0, -80.0, -62.0, -105.0, -79.0, -76.0, -77.0, -104.0, -73.0, -83.0, -104.0, -93.0, -92.0, -100.0, -90.0, -74.0, -86.0, -77.0, -85.0, -71.0, -73.0, -134.0, -101.0, -81.0, -85.0, -76.0, -78.0, -104.0, -89.0, -67.0, -78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0], "episode_lengths": [104, 78, 80, 84, 84, 115, 64, 100, 72, 80, 78, 84, 124, 82, 96, 81, 79, 73, 93, 88, 82, 88, 78, 65, 80, 84, 94, 92, 113, 89, 76, 80, 103, 80, 95, 100, 164, 201, 88, 139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93, 84, 64, 81, 63, 106, 80, 77, 78, 105, 74, 84, 105, 94, 93, 101, 91, 75, 87, 78, 86, 72, 74, 135, 102, 82, 86, 77, 79, 105, 90, 68, 79, 87, 72, 84, 103, 79, 97, 108, 107, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6725486862073312, "mean_inference_ms": 2.445119592319241, "mean_action_processing_ms": 0.264581061086054, "mean_env_wait_ms": 0.39548233539523414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016036272048950195, "StateBufferConnector_ms": 0.012344837188720703, "ViewRequirementAgentConnector_ms": 0.28647518157958984}}, "episode_reward_max": -62.0, "episode_reward_min": -200.0, "episode_reward_mean": -88.97, "episode_len_mean": 89.97, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.0, -77.0, -79.0, -83.0, -83.0, -114.0, -63.0, -99.0, -71.0, -79.0, -77.0, -83.0, -123.0, -81.0, -95.0, -80.0, -78.0, -72.0, -92.0, -87.0, -81.0, -87.0, -77.0, -64.0, -79.0, -83.0, -93.0, -91.0, -112.0, -88.0, -75.0, -79.0, -102.0, -79.0, -94.0, -99.0, -163.0, -200.0, -87.0, -138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0, -83.0, -63.0, -80.0, -62.0, -105.0, -79.0, -76.0, -77.0, -104.0, -73.0, -83.0, -104.0, -93.0, -92.0, -100.0, -90.0, -74.0, -86.0, -77.0, -85.0, -71.0, -73.0, -134.0, -101.0, -81.0, -85.0, -76.0, -78.0, -104.0, -89.0, -67.0, -78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0], "episode_lengths": [104, 78, 80, 84, 84, 115, 64, 100, 72, 80, 78, 84, 124, 82, 96, 81, 79, 73, 93, 88, 82, 88, 78, 65, 80, 84, 94, 92, 113, 89, 76, 80, 103, 80, 95, 100, 164, 201, 88, 139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93, 84, 64, 81, 63, 106, 80, 77, 78, 105, 74, 84, 105, 94, 93, 101, 91, 75, 87, 78, 86, 72, 74, 135, 102, 82, 86, 77, 79, 105, 90, 68, 79, 87, 72, 84, 103, 79, 97, 108, 107, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6725486862073312, "mean_inference_ms": 2.445119592319241, "mean_action_processing_ms": 0.264581061086054, "mean_env_wait_ms": 0.39548233539523414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016036272048950195, "StateBufferConnector_ms": 0.012344837188720703, "ViewRequirementAgentConnector_ms": 0.28647518157958984}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.0385207192016, "num_env_steps_trained_throughput_per_sec": 390.0385207192016, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 10376.231, "sample_time_ms": 222.677, "load_time_ms": 1.503, "load_throughput": 2662120.529, "learn_time_ms": 10030.945, "learn_throughput": 398.766, "synch_weights_time_ms": 120.201}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 1282, "training_iteration": 45, "trial_id": "default", "date": "2024-08-30_16-43-38", "timestamp": 1725007418, "time_this_iter_s": 10.814074516296387, "time_total_s": 487.9866030216217, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 487.9866030216217, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 9.528571428571428, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.2642857142857143, "vram_util_percent0": 0.1656261625744048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.082143999940605, "policy_loss": -0.01027364669147358, "vf_loss": 5.092369990707725, "vf_explained_var": 0.508406025363553, "kl": 0.0038121083211687316, "entropy": 0.3149908825915347, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -144.0, "episode_reward_mean": -88.25, "episode_len_mean": 89.25, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0, -83.0, -63.0, -80.0, -62.0, -105.0, -79.0, -76.0, -77.0, -104.0, -73.0, -83.0, -104.0, -93.0, -92.0, -100.0, -90.0, -74.0, -86.0, -77.0, -85.0, -71.0, -73.0, -134.0, -101.0, -81.0, -85.0, -76.0, -78.0, -104.0, -89.0, -67.0, -78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0, -91.0, -77.0, -107.0, -79.0, -89.0, -78.0, -88.0, -75.0, -124.0, -78.0, -94.0, -96.0, -93.0, -94.0, -77.0, -94.0, -92.0, -107.0, -94.0, -124.0, -75.0, -76.0, -99.0, -75.0, -62.0, -144.0, -95.0, -114.0, -63.0, -78.0, -77.0, -121.0, -61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0], "episode_lengths": [139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93, 84, 64, 81, 63, 106, 80, 77, 78, 105, 74, 84, 105, 94, 93, 101, 91, 75, 87, 78, 86, 72, 74, 135, 102, 82, 86, 77, 79, 105, 90, 68, 79, 87, 72, 84, 103, 79, 97, 108, 107, 130, 92, 78, 108, 80, 90, 79, 89, 76, 125, 79, 95, 97, 94, 95, 78, 95, 93, 108, 95, 125, 76, 77, 100, 76, 63, 145, 96, 115, 64, 79, 78, 122, 62, 88, 80, 73, 93, 97, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6754120795709666, "mean_inference_ms": 2.4529764881514806, "mean_action_processing_ms": 0.2655620687468533, "mean_env_wait_ms": 0.397623347351471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016504764556884766, "StateBufferConnector_ms": 0.01256251335144043, "ViewRequirementAgentConnector_ms": 0.2887279987335205}}, "episode_reward_max": -61.0, "episode_reward_min": -144.0, "episode_reward_mean": -88.25, "episode_len_mean": 89.25, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-138.0, -83.0, -103.0, -83.0, -93.0, -81.0, -62.0, -76.0, -62.0, -80.0, -78.0, -74.0, -119.0, -86.0, -115.0, -102.0, -80.0, -75.0, -82.0, -92.0, -83.0, -63.0, -80.0, -62.0, -105.0, -79.0, -76.0, -77.0, -104.0, -73.0, -83.0, -104.0, -93.0, -92.0, -100.0, -90.0, -74.0, -86.0, -77.0, -85.0, -71.0, -73.0, -134.0, -101.0, -81.0, -85.0, -76.0, -78.0, -104.0, -89.0, -67.0, -78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0, -91.0, -77.0, -107.0, -79.0, -89.0, -78.0, -88.0, -75.0, -124.0, -78.0, -94.0, -96.0, -93.0, -94.0, -77.0, -94.0, -92.0, -107.0, -94.0, -124.0, -75.0, -76.0, -99.0, -75.0, -62.0, -144.0, -95.0, -114.0, -63.0, -78.0, -77.0, -121.0, -61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0], "episode_lengths": [139, 84, 104, 84, 94, 82, 63, 77, 63, 81, 79, 75, 120, 87, 116, 103, 81, 76, 83, 93, 84, 64, 81, 63, 106, 80, 77, 78, 105, 74, 84, 105, 94, 93, 101, 91, 75, 87, 78, 86, 72, 74, 135, 102, 82, 86, 77, 79, 105, 90, 68, 79, 87, 72, 84, 103, 79, 97, 108, 107, 130, 92, 78, 108, 80, 90, 79, 89, 76, 125, 79, 95, 97, 94, 95, 78, 95, 93, 108, 95, 125, 76, 77, 100, 76, 63, 145, 96, 115, 64, 79, 78, 122, 62, 88, 80, 73, 93, 97, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6754120795709666, "mean_inference_ms": 2.4529764881514806, "mean_action_processing_ms": 0.2655620687468533, "mean_env_wait_ms": 0.397623347351471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016504764556884766, "StateBufferConnector_ms": 0.01256251335144043, "ViewRequirementAgentConnector_ms": 0.2887279987335205}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.5796508501082, "num_env_steps_trained_throughput_per_sec": 377.5796508501082, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 10399.26, "sample_time_ms": 232.381, "load_time_ms": 1.446, "load_throughput": 2766417.571, "learn_time_ms": 10043.647, "learn_throughput": 398.262, "synch_weights_time_ms": 120.898}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 1321, "training_iteration": 46, "trial_id": "default", "date": "2024-08-30_16-43-49", "timestamp": 1725007429, "time_this_iter_s": 11.089516401290894, "time_total_s": 499.0761194229126, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 499.0761194229126, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.27785714285714286, "vram_util_percent0": 0.16517566499255953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.673878160599739, "policy_loss": -0.01287257908092391, "vf_loss": 4.686716781764902, "vf_explained_var": 0.3130774989563932, "kl": 0.005433242659488823, "entropy": 0.3012127367399072, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -203.0, "episode_reward_mean": -90.24, "episode_len_mean": 91.24, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0, -91.0, -77.0, -107.0, -79.0, -89.0, -78.0, -88.0, -75.0, -124.0, -78.0, -94.0, -96.0, -93.0, -94.0, -77.0, -94.0, -92.0, -107.0, -94.0, -124.0, -75.0, -76.0, -99.0, -75.0, -62.0, -144.0, -95.0, -114.0, -63.0, -78.0, -77.0, -121.0, -61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0, -80.0, -98.0, -82.0, -77.0, -88.0, -81.0, -79.0, -77.0, -84.0, -72.0, -72.0, -102.0, -109.0, -70.0, -101.0, -99.0, -90.0, -203.0, -74.0, -96.0, -88.0, -71.0, -91.0, -75.0, -79.0, -76.0, -94.0, -74.0, -76.0, -64.0, -80.0, -95.0, -96.0, -97.0, -80.0, -87.0, -97.0, -105.0, -74.0, -84.0, -102.0, -110.0, -83.0, -93.0, -98.0, -90.0, -122.0, -105.0, -96.0, -97.0, -95.0], "episode_lengths": [79, 87, 72, 84, 103, 79, 97, 108, 107, 130, 92, 78, 108, 80, 90, 79, 89, 76, 125, 79, 95, 97, 94, 95, 78, 95, 93, 108, 95, 125, 76, 77, 100, 76, 63, 145, 96, 115, 64, 79, 78, 122, 62, 88, 80, 73, 93, 97, 64, 81, 99, 83, 78, 89, 82, 80, 78, 85, 73, 73, 103, 110, 71, 102, 100, 91, 204, 75, 97, 89, 72, 92, 76, 80, 77, 95, 75, 77, 65, 81, 96, 97, 98, 81, 88, 98, 106, 75, 85, 103, 111, 84, 94, 99, 91, 123, 106, 97, 98, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6680675188857534, "mean_inference_ms": 2.41846132436052, "mean_action_processing_ms": 0.2617854369520503, "mean_env_wait_ms": 0.39068564087491603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016962766647338867, "StateBufferConnector_ms": 0.011854171752929688, "ViewRequirementAgentConnector_ms": 0.27297472953796387}}, "episode_reward_max": -61.0, "episode_reward_min": -203.0, "episode_reward_mean": -90.24, "episode_len_mean": 91.24, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.0, -86.0, -71.0, -83.0, -102.0, -78.0, -96.0, -107.0, -106.0, -129.0, -91.0, -77.0, -107.0, -79.0, -89.0, -78.0, -88.0, -75.0, -124.0, -78.0, -94.0, -96.0, -93.0, -94.0, -77.0, -94.0, -92.0, -107.0, -94.0, -124.0, -75.0, -76.0, -99.0, -75.0, -62.0, -144.0, -95.0, -114.0, -63.0, -78.0, -77.0, -121.0, -61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0, -80.0, -98.0, -82.0, -77.0, -88.0, -81.0, -79.0, -77.0, -84.0, -72.0, -72.0, -102.0, -109.0, -70.0, -101.0, -99.0, -90.0, -203.0, -74.0, -96.0, -88.0, -71.0, -91.0, -75.0, -79.0, -76.0, -94.0, -74.0, -76.0, -64.0, -80.0, -95.0, -96.0, -97.0, -80.0, -87.0, -97.0, -105.0, -74.0, -84.0, -102.0, -110.0, -83.0, -93.0, -98.0, -90.0, -122.0, -105.0, -96.0, -97.0, -95.0], "episode_lengths": [79, 87, 72, 84, 103, 79, 97, 108, 107, 130, 92, 78, 108, 80, 90, 79, 89, 76, 125, 79, 95, 97, 94, 95, 78, 95, 93, 108, 95, 125, 76, 77, 100, 76, 63, 145, 96, 115, 64, 79, 78, 122, 62, 88, 80, 73, 93, 97, 64, 81, 99, 83, 78, 89, 82, 80, 78, 85, 73, 73, 103, 110, 71, 102, 100, 91, 204, 75, 97, 89, 72, 92, 76, 80, 77, 95, 75, 77, 65, 81, 96, 97, 98, 81, 88, 98, 106, 75, 85, 103, 111, 84, 94, 99, 91, 123, 106, 97, 98, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6680675188857534, "mean_inference_ms": 2.41846132436052, "mean_action_processing_ms": 0.2617854369520503, "mean_env_wait_ms": 0.39068564087491603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016962766647338867, "StateBufferConnector_ms": 0.011854171752929688, "ViewRequirementAgentConnector_ms": 0.27297472953796387}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.356105482034, "num_env_steps_trained_throughput_per_sec": 386.356105482034, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 10391.977, "sample_time_ms": 234.013, "load_time_ms": 1.56, "load_throughput": 2563559.63, "learn_time_ms": 10035.083, "learn_throughput": 398.602, "synch_weights_time_ms": 120.43}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 1372, "training_iteration": 47, "trial_id": "default", "date": "2024-08-30_16-44-00", "timestamp": 1725007440, "time_this_iter_s": 10.926424980163574, "time_total_s": 510.0025444030762, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 510.0025444030762, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 9.335714285714287, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.295, "vram_util_percent0": 0.16525704520089285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.627749847724874, "policy_loss": -0.015710104771599332, "vf_loss": 4.643431765802445, "vf_explained_var": 0.5130682172954724, "kl": 0.00451149766125919, "entropy": 0.29374722540378573, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -61.0, "episode_reward_min": -208.0, "episode_reward_mean": -91.88, "episode_len_mean": 92.88, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0, -80.0, -98.0, -82.0, -77.0, -88.0, -81.0, -79.0, -77.0, -84.0, -72.0, -72.0, -102.0, -109.0, -70.0, -101.0, -99.0, -90.0, -203.0, -74.0, -96.0, -88.0, -71.0, -91.0, -75.0, -79.0, -76.0, -94.0, -74.0, -76.0, -64.0, -80.0, -95.0, -96.0, -97.0, -80.0, -87.0, -97.0, -105.0, -74.0, -84.0, -102.0, -110.0, -83.0, -93.0, -98.0, -90.0, -122.0, -105.0, -96.0, -97.0, -95.0, -116.0, -96.0, -84.0, -150.0, -77.0, -88.0, -88.0, -75.0, -77.0, -72.0, -76.0, -183.0, -112.0, -99.0, -94.0, -82.0, -90.0, -81.0, -71.0, -82.0, -72.0, -99.0, -110.0, -76.0, -75.0, -92.0, -103.0, -96.0, -96.0, -95.0, -114.0, -107.0, -99.0, -208.0, -76.0, -77.0, -74.0, -115.0, -96.0, -103.0, -77.0, -77.0], "episode_lengths": [62, 88, 80, 73, 93, 97, 64, 81, 99, 83, 78, 89, 82, 80, 78, 85, 73, 73, 103, 110, 71, 102, 100, 91, 204, 75, 97, 89, 72, 92, 76, 80, 77, 95, 75, 77, 65, 81, 96, 97, 98, 81, 88, 98, 106, 75, 85, 103, 111, 84, 94, 99, 91, 123, 106, 97, 98, 96, 117, 97, 85, 151, 78, 89, 89, 76, 78, 73, 77, 184, 113, 100, 95, 83, 91, 82, 72, 83, 73, 100, 111, 77, 76, 93, 104, 97, 97, 96, 115, 108, 100, 209, 77, 78, 75, 116, 97, 104, 78, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6689277964692464, "mean_inference_ms": 2.4232503936637633, "mean_action_processing_ms": 0.2623468992710077, "mean_env_wait_ms": 0.3913998192322465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015622138977050781, "StateBufferConnector_ms": 0.0110931396484375, "ViewRequirementAgentConnector_ms": 0.2611274719238281}}, "episode_reward_max": -61.0, "episode_reward_min": -208.0, "episode_reward_mean": -91.88, "episode_len_mean": 92.88, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -87.0, -79.0, -72.0, -92.0, -96.0, -63.0, -80.0, -98.0, -82.0, -77.0, -88.0, -81.0, -79.0, -77.0, -84.0, -72.0, -72.0, -102.0, -109.0, -70.0, -101.0, -99.0, -90.0, -203.0, -74.0, -96.0, -88.0, -71.0, -91.0, -75.0, -79.0, -76.0, -94.0, -74.0, -76.0, -64.0, -80.0, -95.0, -96.0, -97.0, -80.0, -87.0, -97.0, -105.0, -74.0, -84.0, -102.0, -110.0, -83.0, -93.0, -98.0, -90.0, -122.0, -105.0, -96.0, -97.0, -95.0, -116.0, -96.0, -84.0, -150.0, -77.0, -88.0, -88.0, -75.0, -77.0, -72.0, -76.0, -183.0, -112.0, -99.0, -94.0, -82.0, -90.0, -81.0, -71.0, -82.0, -72.0, -99.0, -110.0, -76.0, -75.0, -92.0, -103.0, -96.0, -96.0, -95.0, -114.0, -107.0, -99.0, -208.0, -76.0, -77.0, -74.0, -115.0, -96.0, -103.0, -77.0, -77.0], "episode_lengths": [62, 88, 80, 73, 93, 97, 64, 81, 99, 83, 78, 89, 82, 80, 78, 85, 73, 73, 103, 110, 71, 102, 100, 91, 204, 75, 97, 89, 72, 92, 76, 80, 77, 95, 75, 77, 65, 81, 96, 97, 98, 81, 88, 98, 106, 75, 85, 103, 111, 84, 94, 99, 91, 123, 106, 97, 98, 96, 117, 97, 85, 151, 78, 89, 89, 76, 78, 73, 77, 184, 113, 100, 95, 83, 91, 82, 72, 83, 73, 100, 111, 77, 76, 93, 104, 97, 97, 96, 115, 108, 100, 209, 77, 78, 75, 116, 97, 104, 78, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6689277964692464, "mean_inference_ms": 2.4232503936637633, "mean_action_processing_ms": 0.2623468992710077, "mean_env_wait_ms": 0.3913998192322465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015622138977050781, "StateBufferConnector_ms": 0.0110931396484375, "ViewRequirementAgentConnector_ms": 0.2611274719238281}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.8196197974825, "num_env_steps_trained_throughput_per_sec": 455.8196197974825, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 10229.228, "sample_time_ms": 239.151, "load_time_ms": 1.57, "load_throughput": 2547986.332, "learn_time_ms": 9866.876, "learn_throughput": 405.397, "synch_weights_time_ms": 120.738}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 1414, "training_iteration": 48, "trial_id": "default", "date": "2024-08-30_16-44-09", "timestamp": 1725007449, "time_this_iter_s": 9.368948698043823, "time_total_s": 519.37149310112, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 519.37149310112, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.25999999999999995, "vram_util_percent0": 0.16389660957532054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.806961550058857, "policy_loss": -0.01135902480417562, "vf_loss": 4.818305556428048, "vf_explained_var": 0.5853214756775927, "kl": 0.004807508564662903, "entropy": 0.30200333757105696, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -64.0, "episode_reward_min": -208.0, "episode_reward_mean": -91.69, "episode_len_mean": 92.69, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0, -122.0, -105.0, -96.0, -97.0, -95.0, -116.0, -96.0, -84.0, -150.0, -77.0, -88.0, -88.0, -75.0, -77.0, -72.0, -76.0, -183.0, -112.0, -99.0, -94.0, -82.0, -90.0, -81.0, -71.0, -82.0, -72.0, -99.0, -110.0, -76.0, -75.0, -92.0, -103.0, -96.0, -96.0, -95.0, -114.0, -107.0, -99.0, -208.0, -76.0, -77.0, -74.0, -115.0, -96.0, -103.0, -77.0, -77.0, -98.0, -71.0, -77.0, -97.0, -90.0, -108.0, -75.0, -75.0, -72.0, -76.0, -85.0, -71.0, -118.0, -76.0, -65.0, -109.0, -88.0, -90.0, -82.0, -72.0, -71.0, -79.0, -94.0, -97.0, -104.0, -114.0, -79.0, -97.0, -103.0, -93.0, -64.0, -132.0, -79.0, -75.0, -84.0, -88.0, -82.0, -73.0, -71.0, -70.0, -82.0, -90.0, -78.0, -99.0, -113.0, -115.0, -89.0, -83.0, -76.0, -76.0, -73.0, -116.0], "episode_lengths": [91, 123, 106, 97, 98, 96, 117, 97, 85, 151, 78, 89, 89, 76, 78, 73, 77, 184, 113, 100, 95, 83, 91, 82, 72, 83, 73, 100, 111, 77, 76, 93, 104, 97, 97, 96, 115, 108, 100, 209, 77, 78, 75, 116, 97, 104, 78, 78, 99, 72, 78, 98, 91, 109, 76, 76, 73, 77, 86, 72, 119, 77, 66, 110, 89, 91, 83, 73, 72, 80, 95, 98, 105, 115, 80, 98, 104, 94, 65, 133, 80, 76, 85, 89, 83, 74, 72, 71, 83, 91, 79, 100, 114, 116, 90, 84, 77, 77, 74, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6675076945054047, "mean_inference_ms": 2.415816053346039, "mean_action_processing_ms": 0.2617762746641631, "mean_env_wait_ms": 0.39042109403343994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017584800720214844, "StateBufferConnector_ms": 0.011413335800170898, "ViewRequirementAgentConnector_ms": 0.2615995407104492}}, "episode_reward_max": -64.0, "episode_reward_min": -208.0, "episode_reward_mean": -91.69, "episode_len_mean": 92.69, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.0, -122.0, -105.0, -96.0, -97.0, -95.0, -116.0, -96.0, -84.0, -150.0, -77.0, -88.0, -88.0, -75.0, -77.0, -72.0, -76.0, -183.0, -112.0, -99.0, -94.0, -82.0, -90.0, -81.0, -71.0, -82.0, -72.0, -99.0, -110.0, -76.0, -75.0, -92.0, -103.0, -96.0, -96.0, -95.0, -114.0, -107.0, -99.0, -208.0, -76.0, -77.0, -74.0, -115.0, -96.0, -103.0, -77.0, -77.0, -98.0, -71.0, -77.0, -97.0, -90.0, -108.0, -75.0, -75.0, -72.0, -76.0, -85.0, -71.0, -118.0, -76.0, -65.0, -109.0, -88.0, -90.0, -82.0, -72.0, -71.0, -79.0, -94.0, -97.0, -104.0, -114.0, -79.0, -97.0, -103.0, -93.0, -64.0, -132.0, -79.0, -75.0, -84.0, -88.0, -82.0, -73.0, -71.0, -70.0, -82.0, -90.0, -78.0, -99.0, -113.0, -115.0, -89.0, -83.0, -76.0, -76.0, -73.0, -116.0], "episode_lengths": [91, 123, 106, 97, 98, 96, 117, 97, 85, 151, 78, 89, 89, 76, 78, 73, 77, 184, 113, 100, 95, 83, 91, 82, 72, 83, 73, 100, 111, 77, 76, 93, 104, 97, 97, 96, 115, 108, 100, 209, 77, 78, 75, 116, 97, 104, 78, 78, 99, 72, 78, 98, 91, 109, 76, 76, 73, 77, 86, 72, 119, 77, 66, 110, 89, 91, 83, 73, 72, 80, 95, 98, 105, 115, 80, 98, 104, 94, 65, 133, 80, 76, 85, 89, 83, 74, 72, 71, 83, 91, 79, 100, 114, 116, 90, 84, 77, 77, 74, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6675076945054047, "mean_inference_ms": 2.415816053346039, "mean_action_processing_ms": 0.2617762746641631, "mean_env_wait_ms": 0.39042109403343994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017584800720214844, "StateBufferConnector_ms": 0.011413335800170898, "ViewRequirementAgentConnector_ms": 0.2615995407104492}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.0271337661313, "num_env_steps_trained_throughput_per_sec": 387.0271337661313, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 10218.988, "sample_time_ms": 238.893, "load_time_ms": 1.559, "load_throughput": 2565049.001, "learn_time_ms": 9857.063, "learn_throughput": 405.8, "synch_weights_time_ms": 120.583}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 1466, "training_iteration": 49, "trial_id": "default", "date": "2024-08-30_16-44-20", "timestamp": 1725007460, "time_this_iter_s": 10.886945486068726, "time_total_s": 530.2584385871887, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 530.2584385871887, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 7.935714285714284, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.22642857142857142, "vram_util_percent0": 0.16405668712797622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.921194729240992, "policy_loss": -0.010037438142844426, "vf_loss": 3.931221317860388, "vf_explained_var": 0.6494906187057495, "kl": 0.006951552399574035, "entropy": 0.28177191736877605, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -63.0, "episode_reward_min": -132.0, "episode_reward_mean": -87.02, "episode_len_mean": 88.02, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.0, -96.0, -103.0, -77.0, -77.0, -98.0, -71.0, -77.0, -97.0, -90.0, -108.0, -75.0, -75.0, -72.0, -76.0, -85.0, -71.0, -118.0, -76.0, -65.0, -109.0, -88.0, -90.0, -82.0, -72.0, -71.0, -79.0, -94.0, -97.0, -104.0, -114.0, -79.0, -97.0, -103.0, -93.0, -64.0, -132.0, -79.0, -75.0, -84.0, -88.0, -82.0, -73.0, -71.0, -70.0, -82.0, -90.0, -78.0, -99.0, -113.0, -115.0, -89.0, -83.0, -76.0, -76.0, -73.0, -116.0, -63.0, -78.0, -79.0, -75.0, -121.0, -124.0, -102.0, -95.0, -97.0, -80.0, -72.0, -78.0, -74.0, -91.0, -97.0, -82.0, -93.0, -71.0, -76.0, -92.0, -85.0, -87.0, -70.0, -84.0, -80.0, -85.0, -99.0, -98.0, -78.0, -103.0, -76.0, -80.0, -101.0, -74.0, -95.0, -94.0, -76.0, -78.0, -79.0, -77.0, -93.0, -76.0, -92.0], "episode_lengths": [116, 97, 104, 78, 78, 99, 72, 78, 98, 91, 109, 76, 76, 73, 77, 86, 72, 119, 77, 66, 110, 89, 91, 83, 73, 72, 80, 95, 98, 105, 115, 80, 98, 104, 94, 65, 133, 80, 76, 85, 89, 83, 74, 72, 71, 83, 91, 79, 100, 114, 116, 90, 84, 77, 77, 74, 117, 64, 79, 80, 76, 122, 125, 103, 96, 98, 81, 73, 79, 75, 92, 98, 83, 94, 72, 77, 93, 86, 88, 71, 85, 81, 86, 100, 99, 79, 104, 77, 81, 102, 75, 96, 95, 77, 79, 80, 78, 94, 77, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6727532324656462, "mean_inference_ms": 2.4432585359853514, "mean_action_processing_ms": 0.2642630119809044, "mean_env_wait_ms": 0.39561957278946364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813340187072754, "StateBufferConnector_ms": 0.012004852294921875, "ViewRequirementAgentConnector_ms": 0.2700471878051758}}, "episode_reward_max": -63.0, "episode_reward_min": -132.0, "episode_reward_mean": -87.02, "episode_len_mean": 88.02, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115.0, -96.0, -103.0, -77.0, -77.0, -98.0, -71.0, -77.0, -97.0, -90.0, -108.0, -75.0, -75.0, -72.0, -76.0, -85.0, -71.0, -118.0, -76.0, -65.0, -109.0, -88.0, -90.0, -82.0, -72.0, -71.0, -79.0, -94.0, -97.0, -104.0, -114.0, -79.0, -97.0, -103.0, -93.0, -64.0, -132.0, -79.0, -75.0, -84.0, -88.0, -82.0, -73.0, -71.0, -70.0, -82.0, -90.0, -78.0, -99.0, -113.0, -115.0, -89.0, -83.0, -76.0, -76.0, -73.0, -116.0, -63.0, -78.0, -79.0, -75.0, -121.0, -124.0, -102.0, -95.0, -97.0, -80.0, -72.0, -78.0, -74.0, -91.0, -97.0, -82.0, -93.0, -71.0, -76.0, -92.0, -85.0, -87.0, -70.0, -84.0, -80.0, -85.0, -99.0, -98.0, -78.0, -103.0, -76.0, -80.0, -101.0, -74.0, -95.0, -94.0, -76.0, -78.0, -79.0, -77.0, -93.0, -76.0, -92.0], "episode_lengths": [116, 97, 104, 78, 78, 99, 72, 78, 98, 91, 109, 76, 76, 73, 77, 86, 72, 119, 77, 66, 110, 89, 91, 83, 73, 72, 80, 95, 98, 105, 115, 80, 98, 104, 94, 65, 133, 80, 76, 85, 89, 83, 74, 72, 71, 83, 91, 79, 100, 114, 116, 90, 84, 77, 77, 74, 117, 64, 79, 80, 76, 122, 125, 103, 96, 98, 81, 73, 79, 75, 92, 98, 83, 94, 72, 77, 93, 86, 88, 71, 85, 81, 86, 100, 99, 79, 104, 77, 81, 102, 75, 96, 95, 77, 79, 80, 78, 94, 77, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6727532324656462, "mean_inference_ms": 2.4432585359853514, "mean_action_processing_ms": 0.2642630119809044, "mean_env_wait_ms": 0.39561957278946364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813340187072754, "StateBufferConnector_ms": 0.012004852294921875, "ViewRequirementAgentConnector_ms": 0.2700471878051758}, "num_healthy_workers": 128, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.1615455235181, "num_env_steps_trained_throughput_per_sec": 399.1615455235181, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 10190.405, "sample_time_ms": 238.722, "load_time_ms": 1.562, "load_throughput": 2560390.685, "learn_time_ms": 9825.95, "learn_throughput": 407.085, "synch_weights_time_ms": 123.291}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 1509, "training_iteration": 50, "trial_id": "default", "date": "2024-08-30_16-44-31", "timestamp": 1725007471, "time_this_iter_s": 10.56732726097107, "time_total_s": 540.8257658481598, "pid": 14848, "hostname": "ucav", "node_ip": "10.0.8.166", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Acrobot-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f648ca3f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 128}, "time_since_restore": 540.8257658481598, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 7.153846153846154, "ram_util_percent": 14.099999999999998, "gpu_util_percent0": 0.19307692307692306, "vram_util_percent0": 0.1644005408653846}}
